<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>深入理解Node.js 进程与线程 | 随风</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="icon" href="/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <meta name="description" content="随风随雨又随流">
    <meta name="theme-color" content="#ffffff">
    <meta name="google-site-verification" content="Ld_AEWr30siza2LmmZ12csitRGsSj9gqqEAch0UXkTc">
    
    <link rel="preload" href="/assets/css/0.styles.3be6d54c.css" as="style"><link rel="preload" href="/assets/js/app.ff5704b6.js" as="script"><link rel="preload" href="/assets/js/3.32bc1a55.js" as="script"><link rel="preload" href="/assets/js/45.914fb166.js" as="script"><link rel="prefetch" href="/assets/js/10.9a16f06d.js"><link rel="prefetch" href="/assets/js/100.8dae6464.js"><link rel="prefetch" href="/assets/js/101.0ee63e30.js"><link rel="prefetch" href="/assets/js/102.a5cb0d15.js"><link rel="prefetch" href="/assets/js/103.5aa338f8.js"><link rel="prefetch" href="/assets/js/104.bdf8a758.js"><link rel="prefetch" href="/assets/js/105.1bc156bf.js"><link rel="prefetch" href="/assets/js/106.c27baf7c.js"><link rel="prefetch" href="/assets/js/107.1129e372.js"><link rel="prefetch" href="/assets/js/108.419e776c.js"><link rel="prefetch" href="/assets/js/109.a86f3f13.js"><link rel="prefetch" href="/assets/js/11.c92d8b8b.js"><link rel="prefetch" href="/assets/js/110.adb411be.js"><link rel="prefetch" href="/assets/js/111.deb38d73.js"><link rel="prefetch" href="/assets/js/112.0642ddce.js"><link rel="prefetch" href="/assets/js/113.0acf79f5.js"><link rel="prefetch" href="/assets/js/114.59d3a497.js"><link rel="prefetch" href="/assets/js/115.cfda2c63.js"><link rel="prefetch" href="/assets/js/116.00860f3c.js"><link rel="prefetch" href="/assets/js/117.31bb0135.js"><link rel="prefetch" href="/assets/js/118.3e731057.js"><link rel="prefetch" href="/assets/js/119.deeb8465.js"><link rel="prefetch" href="/assets/js/12.923d760f.js"><link rel="prefetch" href="/assets/js/120.553f579c.js"><link rel="prefetch" href="/assets/js/121.61ea13e2.js"><link rel="prefetch" href="/assets/js/122.e33bb2b1.js"><link rel="prefetch" href="/assets/js/123.79e24b0e.js"><link rel="prefetch" href="/assets/js/124.f49ba6e4.js"><link rel="prefetch" href="/assets/js/125.01ec88cd.js"><link rel="prefetch" href="/assets/js/126.d5dd3711.js"><link rel="prefetch" href="/assets/js/127.bd1b267c.js"><link rel="prefetch" href="/assets/js/128.7c260028.js"><link rel="prefetch" href="/assets/js/129.0cd9afe6.js"><link rel="prefetch" href="/assets/js/13.07ba374a.js"><link rel="prefetch" href="/assets/js/130.23fbfe9b.js"><link rel="prefetch" href="/assets/js/131.330c1df5.js"><link rel="prefetch" href="/assets/js/132.74937db1.js"><link rel="prefetch" href="/assets/js/133.496f7f59.js"><link rel="prefetch" href="/assets/js/134.5021f5a5.js"><link rel="prefetch" href="/assets/js/135.a0793e0b.js"><link rel="prefetch" href="/assets/js/136.37ed4c95.js"><link rel="prefetch" href="/assets/js/137.5614fd6e.js"><link rel="prefetch" href="/assets/js/138.219e7a9a.js"><link rel="prefetch" href="/assets/js/139.d0a8203f.js"><link rel="prefetch" href="/assets/js/14.cee0a79c.js"><link rel="prefetch" href="/assets/js/140.859f27ab.js"><link rel="prefetch" href="/assets/js/141.3b464d35.js"><link rel="prefetch" href="/assets/js/142.36c89f83.js"><link rel="prefetch" href="/assets/js/143.65876482.js"><link rel="prefetch" href="/assets/js/144.eb280322.js"><link rel="prefetch" href="/assets/js/145.80a390d4.js"><link rel="prefetch" href="/assets/js/146.d46fd68f.js"><link rel="prefetch" href="/assets/js/147.e1703fb2.js"><link rel="prefetch" href="/assets/js/148.1694f341.js"><link rel="prefetch" href="/assets/js/149.e70fc38d.js"><link rel="prefetch" href="/assets/js/15.bd6dd584.js"><link rel="prefetch" href="/assets/js/150.0b43b134.js"><link rel="prefetch" href="/assets/js/151.065b0278.js"><link rel="prefetch" href="/assets/js/152.5bda0bb1.js"><link rel="prefetch" href="/assets/js/153.f8341037.js"><link rel="prefetch" href="/assets/js/154.3cbb8933.js"><link rel="prefetch" href="/assets/js/155.eca73f7a.js"><link rel="prefetch" href="/assets/js/156.6bf44638.js"><link rel="prefetch" href="/assets/js/157.1f0d68cb.js"><link rel="prefetch" href="/assets/js/158.3935c3f1.js"><link rel="prefetch" href="/assets/js/159.2b6f9849.js"><link rel="prefetch" href="/assets/js/16.bef7fd8d.js"><link rel="prefetch" href="/assets/js/160.ea70546e.js"><link rel="prefetch" href="/assets/js/161.c021a004.js"><link rel="prefetch" href="/assets/js/162.cda27944.js"><link rel="prefetch" href="/assets/js/163.541fbc77.js"><link rel="prefetch" href="/assets/js/164.2fa1f4f2.js"><link rel="prefetch" href="/assets/js/165.155fd797.js"><link rel="prefetch" href="/assets/js/166.1d17bfbd.js"><link rel="prefetch" href="/assets/js/167.2e7b9b6c.js"><link rel="prefetch" href="/assets/js/168.c7fd3e2e.js"><link rel="prefetch" href="/assets/js/169.278a4564.js"><link rel="prefetch" href="/assets/js/17.6fb6044c.js"><link rel="prefetch" href="/assets/js/170.1699c89d.js"><link rel="prefetch" href="/assets/js/171.b09d0982.js"><link rel="prefetch" href="/assets/js/172.9ec0d737.js"><link rel="prefetch" href="/assets/js/173.dec62707.js"><link rel="prefetch" href="/assets/js/174.6a369c0d.js"><link rel="prefetch" href="/assets/js/175.8acd00f8.js"><link rel="prefetch" href="/assets/js/176.da309638.js"><link rel="prefetch" href="/assets/js/177.b17adcb7.js"><link rel="prefetch" href="/assets/js/178.245cd9fe.js"><link rel="prefetch" href="/assets/js/179.21d6efa6.js"><link rel="prefetch" href="/assets/js/18.2c626aee.js"><link rel="prefetch" href="/assets/js/180.e61696c0.js"><link rel="prefetch" href="/assets/js/181.07e757a1.js"><link rel="prefetch" href="/assets/js/182.8f5250c3.js"><link rel="prefetch" href="/assets/js/183.fdd6c228.js"><link rel="prefetch" href="/assets/js/184.06917930.js"><link rel="prefetch" href="/assets/js/185.f951ac1b.js"><link rel="prefetch" href="/assets/js/186.77228eff.js"><link rel="prefetch" href="/assets/js/187.0ce0382a.js"><link rel="prefetch" href="/assets/js/188.67074cfd.js"><link rel="prefetch" href="/assets/js/189.dc5a66d3.js"><link rel="prefetch" href="/assets/js/19.c79579c3.js"><link rel="prefetch" href="/assets/js/190.a43bad1f.js"><link rel="prefetch" href="/assets/js/191.b89a95b7.js"><link rel="prefetch" href="/assets/js/192.d902d2b5.js"><link rel="prefetch" href="/assets/js/193.6e21c360.js"><link rel="prefetch" href="/assets/js/194.9052cade.js"><link rel="prefetch" href="/assets/js/195.0b021c51.js"><link rel="prefetch" href="/assets/js/196.2de52006.js"><link rel="prefetch" href="/assets/js/197.1b78c992.js"><link rel="prefetch" href="/assets/js/198.85925b53.js"><link rel="prefetch" href="/assets/js/199.dc67e536.js"><link rel="prefetch" href="/assets/js/2.ff4b99f4.js"><link rel="prefetch" href="/assets/js/20.a545f188.js"><link rel="prefetch" href="/assets/js/200.8e44d8eb.js"><link rel="prefetch" href="/assets/js/201.93167736.js"><link rel="prefetch" href="/assets/js/202.1dc9b630.js"><link rel="prefetch" href="/assets/js/203.9d39e273.js"><link rel="prefetch" href="/assets/js/204.baad1c21.js"><link rel="prefetch" href="/assets/js/205.0da6ae35.js"><link rel="prefetch" href="/assets/js/206.c264711e.js"><link rel="prefetch" href="/assets/js/207.a0ad3a18.js"><link rel="prefetch" href="/assets/js/208.dba1756e.js"><link rel="prefetch" href="/assets/js/209.e84102bd.js"><link rel="prefetch" href="/assets/js/21.ff17fd3c.js"><link rel="prefetch" href="/assets/js/210.d3d78992.js"><link rel="prefetch" href="/assets/js/211.70341df3.js"><link rel="prefetch" href="/assets/js/212.4daebdb8.js"><link rel="prefetch" href="/assets/js/213.142ff1d8.js"><link rel="prefetch" href="/assets/js/214.b578e008.js"><link rel="prefetch" href="/assets/js/215.c410ca78.js"><link rel="prefetch" href="/assets/js/216.dbe966db.js"><link rel="prefetch" href="/assets/js/217.280fc56b.js"><link rel="prefetch" href="/assets/js/218.5ce96820.js"><link rel="prefetch" href="/assets/js/219.cb1e014d.js"><link rel="prefetch" href="/assets/js/22.e12822f2.js"><link rel="prefetch" href="/assets/js/220.764a390b.js"><link rel="prefetch" href="/assets/js/221.38dcc881.js"><link rel="prefetch" href="/assets/js/222.5c917ff3.js"><link rel="prefetch" href="/assets/js/223.f30e4a73.js"><link rel="prefetch" href="/assets/js/224.d343501e.js"><link rel="prefetch" href="/assets/js/225.71ddb707.js"><link rel="prefetch" href="/assets/js/226.fadb3c5b.js"><link rel="prefetch" href="/assets/js/227.74c37342.js"><link rel="prefetch" href="/assets/js/228.e5a4f024.js"><link rel="prefetch" href="/assets/js/229.99847b61.js"><link rel="prefetch" href="/assets/js/23.b2b0dc67.js"><link rel="prefetch" href="/assets/js/230.7053c381.js"><link rel="prefetch" href="/assets/js/231.17ca5124.js"><link rel="prefetch" href="/assets/js/232.757e0d93.js"><link rel="prefetch" href="/assets/js/233.0aa5714c.js"><link rel="prefetch" href="/assets/js/234.b57d559d.js"><link rel="prefetch" href="/assets/js/235.7e3bfa79.js"><link rel="prefetch" href="/assets/js/236.6419c0a2.js"><link rel="prefetch" href="/assets/js/237.767e3b49.js"><link rel="prefetch" href="/assets/js/238.ad6e6458.js"><link rel="prefetch" href="/assets/js/239.c24600ae.js"><link rel="prefetch" href="/assets/js/24.0bc9388b.js"><link rel="prefetch" href="/assets/js/240.0b82beb9.js"><link rel="prefetch" href="/assets/js/241.b0b77745.js"><link rel="prefetch" href="/assets/js/242.b1c257ea.js"><link rel="prefetch" href="/assets/js/243.9f6c7364.js"><link rel="prefetch" href="/assets/js/244.e811943a.js"><link rel="prefetch" href="/assets/js/245.f4b1ed14.js"><link rel="prefetch" href="/assets/js/246.f99e09a2.js"><link rel="prefetch" href="/assets/js/247.20c8d4b5.js"><link rel="prefetch" href="/assets/js/248.c16bc498.js"><link rel="prefetch" href="/assets/js/249.36276028.js"><link rel="prefetch" href="/assets/js/25.6e18367d.js"><link rel="prefetch" href="/assets/js/250.1d010fff.js"><link rel="prefetch" href="/assets/js/251.ff18c743.js"><link rel="prefetch" href="/assets/js/252.9d9fadba.js"><link rel="prefetch" href="/assets/js/253.d18592c3.js"><link rel="prefetch" href="/assets/js/254.474cfe33.js"><link rel="prefetch" href="/assets/js/255.f7cad93e.js"><link rel="prefetch" href="/assets/js/256.0572a13b.js"><link rel="prefetch" href="/assets/js/257.b26351c6.js"><link rel="prefetch" href="/assets/js/258.5559f1af.js"><link rel="prefetch" href="/assets/js/259.82bb27ad.js"><link rel="prefetch" href="/assets/js/26.2b1c4602.js"><link rel="prefetch" href="/assets/js/260.a6e74eb6.js"><link rel="prefetch" href="/assets/js/261.9abdf632.js"><link rel="prefetch" href="/assets/js/262.d10a13a9.js"><link rel="prefetch" href="/assets/js/263.6f7a03a5.js"><link rel="prefetch" href="/assets/js/264.064439c7.js"><link rel="prefetch" href="/assets/js/265.2e6032c2.js"><link rel="prefetch" href="/assets/js/266.b4896289.js"><link rel="prefetch" href="/assets/js/267.5d57e4d4.js"><link rel="prefetch" href="/assets/js/268.7a289535.js"><link rel="prefetch" href="/assets/js/269.2eb82dd4.js"><link rel="prefetch" href="/assets/js/27.3f668953.js"><link rel="prefetch" href="/assets/js/270.4786408c.js"><link rel="prefetch" href="/assets/js/271.65488b27.js"><link rel="prefetch" href="/assets/js/272.2e22be89.js"><link rel="prefetch" href="/assets/js/273.5eab00ba.js"><link rel="prefetch" href="/assets/js/274.76d7e85d.js"><link rel="prefetch" href="/assets/js/275.9c2593e6.js"><link rel="prefetch" href="/assets/js/276.590ff651.js"><link rel="prefetch" href="/assets/js/277.ea8f1a4c.js"><link rel="prefetch" href="/assets/js/278.162648dc.js"><link rel="prefetch" href="/assets/js/279.3a20dac4.js"><link rel="prefetch" href="/assets/js/28.268a84d8.js"><link rel="prefetch" href="/assets/js/280.7aff0c90.js"><link rel="prefetch" href="/assets/js/281.c4077013.js"><link rel="prefetch" href="/assets/js/282.62aa3377.js"><link rel="prefetch" href="/assets/js/283.5a9c20f4.js"><link rel="prefetch" href="/assets/js/284.b96dd41e.js"><link rel="prefetch" href="/assets/js/285.05e8798b.js"><link rel="prefetch" href="/assets/js/286.384bc776.js"><link rel="prefetch" href="/assets/js/287.988e42cf.js"><link rel="prefetch" href="/assets/js/288.e982f3b8.js"><link rel="prefetch" href="/assets/js/289.a1cdaf15.js"><link rel="prefetch" href="/assets/js/29.5ebae196.js"><link rel="prefetch" href="/assets/js/290.3bdd194a.js"><link rel="prefetch" href="/assets/js/291.ce4a6e8e.js"><link rel="prefetch" href="/assets/js/292.c572ba35.js"><link rel="prefetch" href="/assets/js/293.3a0a75e9.js"><link rel="prefetch" href="/assets/js/294.89855f28.js"><link rel="prefetch" href="/assets/js/295.432d4b6f.js"><link rel="prefetch" href="/assets/js/296.8caa722e.js"><link rel="prefetch" href="/assets/js/297.ea665063.js"><link rel="prefetch" href="/assets/js/298.7342b9ac.js"><link rel="prefetch" href="/assets/js/299.96f266a8.js"><link rel="prefetch" href="/assets/js/30.04499e5f.js"><link rel="prefetch" href="/assets/js/300.4fb17682.js"><link rel="prefetch" href="/assets/js/301.68dd904a.js"><link rel="prefetch" href="/assets/js/302.949e8678.js"><link rel="prefetch" href="/assets/js/303.8d164540.js"><link rel="prefetch" href="/assets/js/304.d13a59d0.js"><link rel="prefetch" href="/assets/js/305.df4ce6c2.js"><link rel="prefetch" href="/assets/js/306.22811eba.js"><link rel="prefetch" href="/assets/js/307.19fca2db.js"><link rel="prefetch" href="/assets/js/308.5862fa2d.js"><link rel="prefetch" href="/assets/js/309.246c6f1b.js"><link rel="prefetch" href="/assets/js/31.8f6472b2.js"><link rel="prefetch" href="/assets/js/310.579f6d83.js"><link rel="prefetch" href="/assets/js/311.6960705c.js"><link rel="prefetch" href="/assets/js/312.fce13b44.js"><link rel="prefetch" href="/assets/js/313.824e0f39.js"><link rel="prefetch" href="/assets/js/314.46fe2716.js"><link rel="prefetch" href="/assets/js/315.8f5ea1d6.js"><link rel="prefetch" href="/assets/js/316.4fb9e207.js"><link rel="prefetch" href="/assets/js/317.05ecbba7.js"><link rel="prefetch" href="/assets/js/318.5a63c924.js"><link rel="prefetch" href="/assets/js/319.7a84b7fb.js"><link rel="prefetch" href="/assets/js/32.e644fc2f.js"><link rel="prefetch" href="/assets/js/320.6f07d860.js"><link rel="prefetch" href="/assets/js/321.1424a2f3.js"><link rel="prefetch" href="/assets/js/322.8186e341.js"><link rel="prefetch" href="/assets/js/323.c365752f.js"><link rel="prefetch" href="/assets/js/324.0d0cad4d.js"><link rel="prefetch" href="/assets/js/325.6f18413d.js"><link rel="prefetch" href="/assets/js/326.922e42d6.js"><link rel="prefetch" href="/assets/js/327.9d118497.js"><link rel="prefetch" href="/assets/js/328.847a8140.js"><link rel="prefetch" href="/assets/js/329.35ac005d.js"><link rel="prefetch" href="/assets/js/33.4d924d17.js"><link rel="prefetch" href="/assets/js/330.ce14daeb.js"><link rel="prefetch" href="/assets/js/331.c954fb98.js"><link rel="prefetch" href="/assets/js/332.63354d06.js"><link rel="prefetch" href="/assets/js/333.17fe6c9d.js"><link rel="prefetch" href="/assets/js/334.05a87e8f.js"><link rel="prefetch" href="/assets/js/335.98271250.js"><link rel="prefetch" href="/assets/js/336.a2659c1b.js"><link rel="prefetch" href="/assets/js/337.b421d04f.js"><link rel="prefetch" href="/assets/js/338.521727be.js"><link rel="prefetch" href="/assets/js/339.0641a1ce.js"><link rel="prefetch" href="/assets/js/34.ec2252ab.js"><link rel="prefetch" href="/assets/js/340.e2a76919.js"><link rel="prefetch" href="/assets/js/341.22842212.js"><link rel="prefetch" href="/assets/js/342.f2391224.js"><link rel="prefetch" href="/assets/js/343.9ef8b768.js"><link rel="prefetch" href="/assets/js/344.aaebdd43.js"><link rel="prefetch" href="/assets/js/345.1aa0f979.js"><link rel="prefetch" href="/assets/js/346.dbd0ef4a.js"><link rel="prefetch" href="/assets/js/347.cb5e25bc.js"><link rel="prefetch" href="/assets/js/348.1e8c4b8a.js"><link rel="prefetch" href="/assets/js/349.94e50052.js"><link rel="prefetch" href="/assets/js/35.deadf157.js"><link rel="prefetch" href="/assets/js/350.28de7649.js"><link rel="prefetch" href="/assets/js/351.a5b1e1bb.js"><link rel="prefetch" href="/assets/js/352.daf1985e.js"><link rel="prefetch" href="/assets/js/353.c91426dd.js"><link rel="prefetch" href="/assets/js/354.2a7e28a4.js"><link rel="prefetch" href="/assets/js/355.62d6d9dc.js"><link rel="prefetch" href="/assets/js/356.f85570c0.js"><link rel="prefetch" href="/assets/js/357.da2c7602.js"><link rel="prefetch" href="/assets/js/358.38c14e29.js"><link rel="prefetch" href="/assets/js/359.50d6368b.js"><link rel="prefetch" href="/assets/js/36.2f992cb4.js"><link rel="prefetch" href="/assets/js/360.596daa7b.js"><link rel="prefetch" href="/assets/js/361.bb5aed49.js"><link rel="prefetch" href="/assets/js/362.f5f35103.js"><link rel="prefetch" href="/assets/js/363.f50065f5.js"><link rel="prefetch" href="/assets/js/364.049a964c.js"><link rel="prefetch" href="/assets/js/365.c6ce33e9.js"><link rel="prefetch" href="/assets/js/366.f76d6668.js"><link rel="prefetch" href="/assets/js/367.779a29b2.js"><link rel="prefetch" href="/assets/js/368.89f592d6.js"><link rel="prefetch" href="/assets/js/369.8c81dd4d.js"><link rel="prefetch" href="/assets/js/37.139ff2bf.js"><link rel="prefetch" href="/assets/js/370.3d7506ae.js"><link rel="prefetch" href="/assets/js/371.f7d9f883.js"><link rel="prefetch" href="/assets/js/372.c028db9b.js"><link rel="prefetch" href="/assets/js/373.e77612a2.js"><link rel="prefetch" href="/assets/js/374.d7efbd92.js"><link rel="prefetch" href="/assets/js/375.edc3192b.js"><link rel="prefetch" href="/assets/js/376.b3034ea3.js"><link rel="prefetch" href="/assets/js/377.0e20f4ad.js"><link rel="prefetch" href="/assets/js/378.54242b0f.js"><link rel="prefetch" href="/assets/js/379.e9873a9b.js"><link rel="prefetch" href="/assets/js/38.e54baa53.js"><link rel="prefetch" href="/assets/js/380.253e07df.js"><link rel="prefetch" href="/assets/js/381.20fd6e2c.js"><link rel="prefetch" href="/assets/js/382.e26669d7.js"><link rel="prefetch" href="/assets/js/383.7237a834.js"><link rel="prefetch" href="/assets/js/384.a3ca6915.js"><link rel="prefetch" href="/assets/js/385.179de6df.js"><link rel="prefetch" href="/assets/js/386.96d2dee7.js"><link rel="prefetch" href="/assets/js/387.2c7a542b.js"><link rel="prefetch" href="/assets/js/388.9f7be656.js"><link rel="prefetch" href="/assets/js/389.15bc606f.js"><link rel="prefetch" href="/assets/js/39.d9d4480d.js"><link rel="prefetch" href="/assets/js/390.58370b5c.js"><link rel="prefetch" href="/assets/js/391.0aec0437.js"><link rel="prefetch" href="/assets/js/392.be0fc3ad.js"><link rel="prefetch" href="/assets/js/393.42a0997e.js"><link rel="prefetch" href="/assets/js/394.008a90ec.js"><link rel="prefetch" href="/assets/js/395.c52347d3.js"><link rel="prefetch" href="/assets/js/396.e4ee75f3.js"><link rel="prefetch" href="/assets/js/397.58231684.js"><link rel="prefetch" href="/assets/js/398.2cf5f7b0.js"><link rel="prefetch" href="/assets/js/399.7ae92f9d.js"><link rel="prefetch" href="/assets/js/4.3024e0ea.js"><link rel="prefetch" href="/assets/js/40.f331ad72.js"><link rel="prefetch" href="/assets/js/400.e8e6d413.js"><link rel="prefetch" href="/assets/js/401.63d6974b.js"><link rel="prefetch" href="/assets/js/402.4966f1a3.js"><link rel="prefetch" href="/assets/js/403.5a3c86f0.js"><link rel="prefetch" href="/assets/js/404.e606068f.js"><link rel="prefetch" href="/assets/js/405.0bac6d3a.js"><link rel="prefetch" href="/assets/js/406.7dffd606.js"><link rel="prefetch" href="/assets/js/407.aa119d21.js"><link rel="prefetch" href="/assets/js/408.c2179b52.js"><link rel="prefetch" href="/assets/js/409.363fd0d2.js"><link rel="prefetch" href="/assets/js/41.25b0f36b.js"><link rel="prefetch" href="/assets/js/410.cea7ce15.js"><link rel="prefetch" href="/assets/js/411.be6f3f32.js"><link rel="prefetch" href="/assets/js/412.99a55c8f.js"><link rel="prefetch" href="/assets/js/413.ea472c87.js"><link rel="prefetch" href="/assets/js/414.edb6aa8a.js"><link rel="prefetch" href="/assets/js/415.d37e6366.js"><link rel="prefetch" href="/assets/js/416.16186baa.js"><link rel="prefetch" href="/assets/js/417.f899b04f.js"><link rel="prefetch" href="/assets/js/418.9ffbe043.js"><link rel="prefetch" href="/assets/js/419.3230af20.js"><link rel="prefetch" href="/assets/js/42.9c168dab.js"><link rel="prefetch" href="/assets/js/420.987c80da.js"><link rel="prefetch" href="/assets/js/421.65617e5d.js"><link rel="prefetch" href="/assets/js/422.10599020.js"><link rel="prefetch" href="/assets/js/423.b43671d3.js"><link rel="prefetch" href="/assets/js/424.48e44464.js"><link rel="prefetch" href="/assets/js/425.05854d99.js"><link rel="prefetch" href="/assets/js/426.1206d3ad.js"><link rel="prefetch" href="/assets/js/427.d11ad83b.js"><link rel="prefetch" href="/assets/js/428.7075e03a.js"><link rel="prefetch" href="/assets/js/429.4f697522.js"><link rel="prefetch" href="/assets/js/43.cb23aea6.js"><link rel="prefetch" href="/assets/js/430.cb6e7b9c.js"><link rel="prefetch" href="/assets/js/431.dae66aeb.js"><link rel="prefetch" href="/assets/js/432.1b80cb2b.js"><link rel="prefetch" href="/assets/js/433.170262b1.js"><link rel="prefetch" href="/assets/js/434.a93c834a.js"><link rel="prefetch" href="/assets/js/435.10fbf75f.js"><link rel="prefetch" href="/assets/js/436.67b676c3.js"><link rel="prefetch" href="/assets/js/437.2a6664db.js"><link rel="prefetch" href="/assets/js/438.96a06be6.js"><link rel="prefetch" href="/assets/js/439.da5efae3.js"><link rel="prefetch" href="/assets/js/44.dad6bc5f.js"><link rel="prefetch" href="/assets/js/440.bb3f47e7.js"><link rel="prefetch" href="/assets/js/441.4334f8bc.js"><link rel="prefetch" href="/assets/js/442.5ee52b3e.js"><link rel="prefetch" href="/assets/js/443.b8947524.js"><link rel="prefetch" href="/assets/js/444.ad74ea19.js"><link rel="prefetch" href="/assets/js/445.bb7ac97e.js"><link rel="prefetch" href="/assets/js/446.ce17e309.js"><link rel="prefetch" href="/assets/js/447.f59aeb30.js"><link rel="prefetch" href="/assets/js/448.92589f31.js"><link rel="prefetch" href="/assets/js/449.ed6a828e.js"><link rel="prefetch" href="/assets/js/450.a33f0b6f.js"><link rel="prefetch" href="/assets/js/451.e2953884.js"><link rel="prefetch" href="/assets/js/452.efa9df49.js"><link rel="prefetch" href="/assets/js/453.c2a4fcdc.js"><link rel="prefetch" href="/assets/js/454.3afea930.js"><link rel="prefetch" href="/assets/js/455.207d966b.js"><link rel="prefetch" href="/assets/js/456.e4482fd9.js"><link rel="prefetch" href="/assets/js/457.e92b76a5.js"><link rel="prefetch" href="/assets/js/458.4f18fa1f.js"><link rel="prefetch" href="/assets/js/459.b034862d.js"><link rel="prefetch" href="/assets/js/46.ea6227fb.js"><link rel="prefetch" href="/assets/js/460.1ef23852.js"><link rel="prefetch" href="/assets/js/461.e9a4d939.js"><link rel="prefetch" href="/assets/js/462.8612a52f.js"><link rel="prefetch" href="/assets/js/463.c866487c.js"><link rel="prefetch" href="/assets/js/464.cd0d4604.js"><link rel="prefetch" href="/assets/js/465.332dd76c.js"><link rel="prefetch" href="/assets/js/466.8e6d2a98.js"><link rel="prefetch" href="/assets/js/467.36acec6d.js"><link rel="prefetch" href="/assets/js/468.ad3a3850.js"><link rel="prefetch" href="/assets/js/469.ede3dc4f.js"><link rel="prefetch" href="/assets/js/47.9c48dce4.js"><link rel="prefetch" href="/assets/js/470.029cc67b.js"><link rel="prefetch" href="/assets/js/471.792b6e4e.js"><link rel="prefetch" href="/assets/js/472.8b5468e9.js"><link rel="prefetch" href="/assets/js/473.28911ce3.js"><link rel="prefetch" href="/assets/js/474.605311df.js"><link rel="prefetch" href="/assets/js/475.2c767294.js"><link rel="prefetch" href="/assets/js/476.cd114014.js"><link rel="prefetch" href="/assets/js/477.09a05037.js"><link rel="prefetch" href="/assets/js/478.a0fb568e.js"><link rel="prefetch" href="/assets/js/479.48866dc1.js"><link rel="prefetch" href="/assets/js/48.0fe79bd0.js"><link rel="prefetch" href="/assets/js/480.7e2e8702.js"><link rel="prefetch" href="/assets/js/481.11b589c2.js"><link rel="prefetch" href="/assets/js/482.fdfdec18.js"><link rel="prefetch" href="/assets/js/483.51fd70b9.js"><link rel="prefetch" href="/assets/js/484.7f0af724.js"><link rel="prefetch" href="/assets/js/485.c67ee119.js"><link rel="prefetch" href="/assets/js/486.71c71c7f.js"><link rel="prefetch" href="/assets/js/487.cca67f27.js"><link rel="prefetch" href="/assets/js/488.499899e2.js"><link rel="prefetch" href="/assets/js/489.0f6f3fa0.js"><link rel="prefetch" href="/assets/js/49.5bce96f8.js"><link rel="prefetch" href="/assets/js/490.1d13e54c.js"><link rel="prefetch" href="/assets/js/491.45cd721b.js"><link rel="prefetch" href="/assets/js/492.1f54c848.js"><link rel="prefetch" href="/assets/js/493.208a6593.js"><link rel="prefetch" href="/assets/js/494.4ac302d5.js"><link rel="prefetch" href="/assets/js/495.e8ec9acf.js"><link rel="prefetch" href="/assets/js/496.370ffb41.js"><link rel="prefetch" href="/assets/js/497.c7a7e029.js"><link rel="prefetch" href="/assets/js/498.625f852d.js"><link rel="prefetch" href="/assets/js/499.a0c96c3f.js"><link rel="prefetch" href="/assets/js/5.1244f18e.js"><link rel="prefetch" href="/assets/js/50.4278c91c.js"><link rel="prefetch" href="/assets/js/500.f161a842.js"><link rel="prefetch" href="/assets/js/501.0511efd0.js"><link rel="prefetch" href="/assets/js/502.404f07b0.js"><link rel="prefetch" href="/assets/js/503.200962a2.js"><link rel="prefetch" href="/assets/js/504.499269a4.js"><link rel="prefetch" href="/assets/js/505.dd8a5460.js"><link rel="prefetch" href="/assets/js/506.de58c7b3.js"><link rel="prefetch" href="/assets/js/507.f13689af.js"><link rel="prefetch" href="/assets/js/508.2fcd3058.js"><link rel="prefetch" href="/assets/js/509.13599f11.js"><link rel="prefetch" href="/assets/js/51.9297e3bb.js"><link rel="prefetch" href="/assets/js/510.ceccf928.js"><link rel="prefetch" href="/assets/js/511.f103e7d3.js"><link rel="prefetch" href="/assets/js/512.4f500f59.js"><link rel="prefetch" href="/assets/js/513.f9102ec7.js"><link rel="prefetch" href="/assets/js/514.95cd541c.js"><link rel="prefetch" href="/assets/js/515.894fae30.js"><link rel="prefetch" href="/assets/js/516.b6a05e0e.js"><link rel="prefetch" href="/assets/js/517.315c5a6d.js"><link rel="prefetch" href="/assets/js/518.e2e22827.js"><link rel="prefetch" href="/assets/js/519.bce5f0c8.js"><link rel="prefetch" href="/assets/js/52.f37880c1.js"><link rel="prefetch" href="/assets/js/520.6435b535.js"><link rel="prefetch" href="/assets/js/521.d348c1e8.js"><link rel="prefetch" href="/assets/js/522.499e796d.js"><link rel="prefetch" href="/assets/js/523.418beff6.js"><link rel="prefetch" href="/assets/js/524.0baff9a9.js"><link rel="prefetch" href="/assets/js/525.bf36235f.js"><link rel="prefetch" href="/assets/js/526.f02685e1.js"><link rel="prefetch" href="/assets/js/527.a99b970f.js"><link rel="prefetch" href="/assets/js/528.f1c7eabf.js"><link rel="prefetch" href="/assets/js/529.380f731d.js"><link rel="prefetch" href="/assets/js/53.c6c7b22b.js"><link rel="prefetch" href="/assets/js/530.8bf41a62.js"><link rel="prefetch" href="/assets/js/531.6d3f5873.js"><link rel="prefetch" href="/assets/js/532.9150f8f4.js"><link rel="prefetch" href="/assets/js/533.63232eb9.js"><link rel="prefetch" href="/assets/js/534.fa76477d.js"><link rel="prefetch" href="/assets/js/535.91a0e837.js"><link rel="prefetch" href="/assets/js/536.904ad6f4.js"><link rel="prefetch" href="/assets/js/537.a44b05b8.js"><link rel="prefetch" href="/assets/js/538.9943a5ea.js"><link rel="prefetch" href="/assets/js/539.1e5bf5d2.js"><link rel="prefetch" href="/assets/js/54.f591e0de.js"><link rel="prefetch" href="/assets/js/540.bdde5ab9.js"><link rel="prefetch" href="/assets/js/541.c1cdcc1d.js"><link rel="prefetch" href="/assets/js/542.c361e7b8.js"><link rel="prefetch" href="/assets/js/543.dba7d709.js"><link rel="prefetch" href="/assets/js/544.88fb4af0.js"><link rel="prefetch" href="/assets/js/545.989e2015.js"><link rel="prefetch" href="/assets/js/546.9eb22fa2.js"><link rel="prefetch" href="/assets/js/547.4dafbcb2.js"><link rel="prefetch" href="/assets/js/548.04ab571e.js"><link rel="prefetch" href="/assets/js/549.ddb0bee4.js"><link rel="prefetch" href="/assets/js/55.80f96495.js"><link rel="prefetch" href="/assets/js/550.4ef7808b.js"><link rel="prefetch" href="/assets/js/551.83e26e82.js"><link rel="prefetch" href="/assets/js/552.a776d6f5.js"><link rel="prefetch" href="/assets/js/553.13e9f8a2.js"><link rel="prefetch" href="/assets/js/554.e41a0614.js"><link rel="prefetch" href="/assets/js/555.69d9a13e.js"><link rel="prefetch" href="/assets/js/556.25e940a3.js"><link rel="prefetch" href="/assets/js/557.164e4fd3.js"><link rel="prefetch" href="/assets/js/558.e9ad897d.js"><link rel="prefetch" href="/assets/js/559.bd2f883c.js"><link rel="prefetch" href="/assets/js/56.c6f21e4d.js"><link rel="prefetch" href="/assets/js/560.b5ade97a.js"><link rel="prefetch" href="/assets/js/561.1e4ed91c.js"><link rel="prefetch" href="/assets/js/562.977abf54.js"><link rel="prefetch" href="/assets/js/563.8dd38420.js"><link rel="prefetch" href="/assets/js/564.e5626493.js"><link rel="prefetch" href="/assets/js/565.3c9a9bf7.js"><link rel="prefetch" href="/assets/js/566.9c48d10f.js"><link rel="prefetch" href="/assets/js/567.ac24341a.js"><link rel="prefetch" href="/assets/js/568.1aa6984c.js"><link rel="prefetch" href="/assets/js/569.c7d29cee.js"><link rel="prefetch" href="/assets/js/57.eb1d56ec.js"><link rel="prefetch" href="/assets/js/570.a6660390.js"><link rel="prefetch" href="/assets/js/571.84271957.js"><link rel="prefetch" href="/assets/js/572.fac89f9d.js"><link rel="prefetch" href="/assets/js/573.25bab672.js"><link rel="prefetch" href="/assets/js/574.3aafc701.js"><link rel="prefetch" href="/assets/js/575.e596368b.js"><link rel="prefetch" href="/assets/js/576.7679790e.js"><link rel="prefetch" href="/assets/js/577.9d7c7300.js"><link rel="prefetch" href="/assets/js/578.43862aa5.js"><link rel="prefetch" href="/assets/js/579.6501b0b3.js"><link rel="prefetch" href="/assets/js/58.5f0df764.js"><link rel="prefetch" href="/assets/js/580.93b09c06.js"><link rel="prefetch" href="/assets/js/581.ce3be8b9.js"><link rel="prefetch" href="/assets/js/582.2dc51924.js"><link rel="prefetch" href="/assets/js/583.89d653f8.js"><link rel="prefetch" href="/assets/js/584.2922b4dc.js"><link rel="prefetch" href="/assets/js/585.afc6c050.js"><link rel="prefetch" href="/assets/js/586.aff773fc.js"><link rel="prefetch" href="/assets/js/587.9bc6ad4e.js"><link rel="prefetch" href="/assets/js/588.9bb2f30f.js"><link rel="prefetch" href="/assets/js/589.ac36c015.js"><link rel="prefetch" href="/assets/js/59.326d8420.js"><link rel="prefetch" href="/assets/js/590.7abcf8c6.js"><link rel="prefetch" href="/assets/js/591.b8cc2f00.js"><link rel="prefetch" href="/assets/js/592.43245afa.js"><link rel="prefetch" href="/assets/js/593.e3bb4493.js"><link rel="prefetch" href="/assets/js/594.65819f6f.js"><link rel="prefetch" href="/assets/js/595.b39d13c0.js"><link rel="prefetch" href="/assets/js/596.970397c3.js"><link rel="prefetch" href="/assets/js/597.21293422.js"><link rel="prefetch" href="/assets/js/598.77cf5286.js"><link rel="prefetch" href="/assets/js/599.c8864d4f.js"><link rel="prefetch" href="/assets/js/6.830ac73f.js"><link rel="prefetch" href="/assets/js/60.ff7812a4.js"><link rel="prefetch" href="/assets/js/600.fffc79ed.js"><link rel="prefetch" href="/assets/js/601.d80284ef.js"><link rel="prefetch" href="/assets/js/602.f10ab4fd.js"><link rel="prefetch" href="/assets/js/603.b196967f.js"><link rel="prefetch" href="/assets/js/604.5313b517.js"><link rel="prefetch" href="/assets/js/605.1a1f68fb.js"><link rel="prefetch" href="/assets/js/606.cc28d341.js"><link rel="prefetch" href="/assets/js/607.00d95597.js"><link rel="prefetch" href="/assets/js/608.aae57856.js"><link rel="prefetch" href="/assets/js/609.3d4a5412.js"><link rel="prefetch" href="/assets/js/61.f943499d.js"><link rel="prefetch" href="/assets/js/610.24080179.js"><link rel="prefetch" href="/assets/js/611.7139d124.js"><link rel="prefetch" href="/assets/js/612.eb1864df.js"><link rel="prefetch" href="/assets/js/613.ded9d28a.js"><link rel="prefetch" href="/assets/js/614.acb0edb8.js"><link rel="prefetch" href="/assets/js/615.ef2a6c09.js"><link rel="prefetch" href="/assets/js/616.df6e4e3b.js"><link rel="prefetch" href="/assets/js/617.4f19cb62.js"><link rel="prefetch" href="/assets/js/618.8ab2e9df.js"><link rel="prefetch" href="/assets/js/619.00637cc7.js"><link rel="prefetch" href="/assets/js/62.638325e0.js"><link rel="prefetch" href="/assets/js/620.1b0b4cb6.js"><link rel="prefetch" href="/assets/js/621.8b370627.js"><link rel="prefetch" href="/assets/js/622.2615c03d.js"><link rel="prefetch" href="/assets/js/623.958acc26.js"><link rel="prefetch" href="/assets/js/624.e5603812.js"><link rel="prefetch" href="/assets/js/625.59a01c3d.js"><link rel="prefetch" href="/assets/js/626.f58048e3.js"><link rel="prefetch" href="/assets/js/627.87e87a88.js"><link rel="prefetch" href="/assets/js/628.e0f97481.js"><link rel="prefetch" href="/assets/js/629.52ed9186.js"><link rel="prefetch" href="/assets/js/63.5474bba6.js"><link rel="prefetch" href="/assets/js/630.c797b8cb.js"><link rel="prefetch" href="/assets/js/631.d35e30c7.js"><link rel="prefetch" href="/assets/js/632.731c602a.js"><link rel="prefetch" href="/assets/js/633.bd9bbcb6.js"><link rel="prefetch" href="/assets/js/634.a6e4fc91.js"><link rel="prefetch" href="/assets/js/635.f8e5aa9e.js"><link rel="prefetch" href="/assets/js/636.cb5d0aa9.js"><link rel="prefetch" href="/assets/js/637.bcfad99c.js"><link rel="prefetch" href="/assets/js/638.35ee32bb.js"><link rel="prefetch" href="/assets/js/639.01e21a8d.js"><link rel="prefetch" href="/assets/js/64.30628b19.js"><link rel="prefetch" href="/assets/js/640.7b2d2b86.js"><link rel="prefetch" href="/assets/js/641.c3d6d4d1.js"><link rel="prefetch" href="/assets/js/642.5c79f394.js"><link rel="prefetch" href="/assets/js/643.96db5b9d.js"><link rel="prefetch" href="/assets/js/644.2aa94e55.js"><link rel="prefetch" href="/assets/js/645.ff9620b7.js"><link rel="prefetch" href="/assets/js/646.c5baff7a.js"><link rel="prefetch" href="/assets/js/647.55212d7c.js"><link rel="prefetch" href="/assets/js/648.e54efbbd.js"><link rel="prefetch" href="/assets/js/649.5c3d2fb0.js"><link rel="prefetch" href="/assets/js/65.71816150.js"><link rel="prefetch" href="/assets/js/650.d8c7f774.js"><link rel="prefetch" href="/assets/js/651.27bee633.js"><link rel="prefetch" href="/assets/js/652.f8048b0b.js"><link rel="prefetch" href="/assets/js/653.709d6491.js"><link rel="prefetch" href="/assets/js/654.91db8d84.js"><link rel="prefetch" href="/assets/js/655.7048d384.js"><link rel="prefetch" href="/assets/js/656.cff77d15.js"><link rel="prefetch" href="/assets/js/657.31586ab9.js"><link rel="prefetch" href="/assets/js/658.d25f21ee.js"><link rel="prefetch" href="/assets/js/659.3b7b08e9.js"><link rel="prefetch" href="/assets/js/66.70128440.js"><link rel="prefetch" href="/assets/js/660.ea92cebe.js"><link rel="prefetch" href="/assets/js/661.525b3cc7.js"><link rel="prefetch" href="/assets/js/662.1d1e6748.js"><link rel="prefetch" href="/assets/js/663.336eff72.js"><link rel="prefetch" href="/assets/js/664.d6018682.js"><link rel="prefetch" href="/assets/js/665.778f5c84.js"><link rel="prefetch" href="/assets/js/666.657a68c7.js"><link rel="prefetch" href="/assets/js/667.95afe4ad.js"><link rel="prefetch" href="/assets/js/668.ecc000eb.js"><link rel="prefetch" href="/assets/js/669.28290568.js"><link rel="prefetch" href="/assets/js/67.17a8cd4b.js"><link rel="prefetch" href="/assets/js/670.e7cd9bb3.js"><link rel="prefetch" href="/assets/js/671.cf0e5261.js"><link rel="prefetch" href="/assets/js/672.41a00248.js"><link rel="prefetch" href="/assets/js/673.a43d5324.js"><link rel="prefetch" href="/assets/js/674.e8ce84c9.js"><link rel="prefetch" href="/assets/js/675.5b30e80c.js"><link rel="prefetch" href="/assets/js/676.d850673a.js"><link rel="prefetch" href="/assets/js/677.29732340.js"><link rel="prefetch" href="/assets/js/678.941bcc4a.js"><link rel="prefetch" href="/assets/js/679.78241996.js"><link rel="prefetch" href="/assets/js/68.659d8ed6.js"><link rel="prefetch" href="/assets/js/680.ab48a823.js"><link rel="prefetch" href="/assets/js/681.436a9245.js"><link rel="prefetch" href="/assets/js/682.2e55c96d.js"><link rel="prefetch" href="/assets/js/683.4d340990.js"><link rel="prefetch" href="/assets/js/684.24cee4d8.js"><link rel="prefetch" href="/assets/js/685.bfbe4a55.js"><link rel="prefetch" href="/assets/js/686.30c2b372.js"><link rel="prefetch" href="/assets/js/687.428bf5e6.js"><link rel="prefetch" href="/assets/js/688.932602b0.js"><link rel="prefetch" href="/assets/js/689.79ffd250.js"><link rel="prefetch" href="/assets/js/69.4b51d971.js"><link rel="prefetch" href="/assets/js/690.9ee2073d.js"><link rel="prefetch" href="/assets/js/691.28a15e04.js"><link rel="prefetch" href="/assets/js/692.d215f449.js"><link rel="prefetch" href="/assets/js/693.56137f50.js"><link rel="prefetch" href="/assets/js/694.935aa814.js"><link rel="prefetch" href="/assets/js/695.f8449085.js"><link rel="prefetch" href="/assets/js/696.979f6704.js"><link rel="prefetch" href="/assets/js/697.f821c698.js"><link rel="prefetch" href="/assets/js/698.c420c072.js"><link rel="prefetch" href="/assets/js/699.6045b82f.js"><link rel="prefetch" href="/assets/js/7.cb453354.js"><link rel="prefetch" href="/assets/js/70.008e75e5.js"><link rel="prefetch" href="/assets/js/700.aac16fe5.js"><link rel="prefetch" href="/assets/js/701.467fe66b.js"><link rel="prefetch" href="/assets/js/702.122f5b45.js"><link rel="prefetch" href="/assets/js/703.fef8eed8.js"><link rel="prefetch" href="/assets/js/704.282508b1.js"><link rel="prefetch" href="/assets/js/705.31048778.js"><link rel="prefetch" href="/assets/js/706.3a8b2d98.js"><link rel="prefetch" href="/assets/js/707.b02d8ecc.js"><link rel="prefetch" href="/assets/js/708.a32666cb.js"><link rel="prefetch" href="/assets/js/709.b0af4c50.js"><link rel="prefetch" href="/assets/js/71.3324454d.js"><link rel="prefetch" href="/assets/js/710.cb9fbc76.js"><link rel="prefetch" href="/assets/js/711.87b5ef21.js"><link rel="prefetch" href="/assets/js/712.3a1495ff.js"><link rel="prefetch" href="/assets/js/713.4291fb23.js"><link rel="prefetch" href="/assets/js/714.c4ef4bfa.js"><link rel="prefetch" href="/assets/js/715.5411c40f.js"><link rel="prefetch" href="/assets/js/716.558bcb23.js"><link rel="prefetch" href="/assets/js/717.81d931a9.js"><link rel="prefetch" href="/assets/js/718.c062bbdf.js"><link rel="prefetch" href="/assets/js/719.ce826421.js"><link rel="prefetch" href="/assets/js/72.80901173.js"><link rel="prefetch" href="/assets/js/720.d0a39b7d.js"><link rel="prefetch" href="/assets/js/721.acfebd27.js"><link rel="prefetch" href="/assets/js/722.384381d3.js"><link rel="prefetch" href="/assets/js/723.a0e8eea4.js"><link rel="prefetch" href="/assets/js/724.dc68d7a4.js"><link rel="prefetch" href="/assets/js/725.b7bad5b5.js"><link rel="prefetch" href="/assets/js/726.2522c4e5.js"><link rel="prefetch" href="/assets/js/727.9e5bc334.js"><link rel="prefetch" href="/assets/js/728.54bc121f.js"><link rel="prefetch" href="/assets/js/729.d3519eee.js"><link rel="prefetch" href="/assets/js/73.69475df0.js"><link rel="prefetch" href="/assets/js/730.a8363d2d.js"><link rel="prefetch" href="/assets/js/731.dad88242.js"><link rel="prefetch" href="/assets/js/732.0e273d9e.js"><link rel="prefetch" href="/assets/js/733.5df56316.js"><link rel="prefetch" href="/assets/js/734.65973254.js"><link rel="prefetch" href="/assets/js/735.70d2a754.js"><link rel="prefetch" href="/assets/js/736.aad25a62.js"><link rel="prefetch" href="/assets/js/737.6e2c4818.js"><link rel="prefetch" href="/assets/js/738.a240fd0c.js"><link rel="prefetch" href="/assets/js/739.5229b014.js"><link rel="prefetch" href="/assets/js/74.e1150ef8.js"><link rel="prefetch" href="/assets/js/740.370bd327.js"><link rel="prefetch" href="/assets/js/741.d51f2981.js"><link rel="prefetch" href="/assets/js/742.147e4f0c.js"><link rel="prefetch" href="/assets/js/743.3bbe4872.js"><link rel="prefetch" href="/assets/js/744.e30a8831.js"><link rel="prefetch" href="/assets/js/745.ed874713.js"><link rel="prefetch" href="/assets/js/746.b06fe6be.js"><link rel="prefetch" href="/assets/js/747.fee0a58e.js"><link rel="prefetch" href="/assets/js/748.5b6b1dd9.js"><link rel="prefetch" href="/assets/js/749.63eeddd7.js"><link rel="prefetch" href="/assets/js/75.f09edc3f.js"><link rel="prefetch" href="/assets/js/750.b9e661aa.js"><link rel="prefetch" href="/assets/js/751.9ffc6617.js"><link rel="prefetch" href="/assets/js/752.25665624.js"><link rel="prefetch" href="/assets/js/753.20a36692.js"><link rel="prefetch" href="/assets/js/754.4d91cf5f.js"><link rel="prefetch" href="/assets/js/755.63cf0164.js"><link rel="prefetch" href="/assets/js/756.f924cf85.js"><link rel="prefetch" href="/assets/js/757.880529a1.js"><link rel="prefetch" href="/assets/js/758.5c54c9ea.js"><link rel="prefetch" href="/assets/js/759.e907a11c.js"><link rel="prefetch" href="/assets/js/76.edd38760.js"><link rel="prefetch" href="/assets/js/760.25a88f22.js"><link rel="prefetch" href="/assets/js/761.b3f9a72e.js"><link rel="prefetch" href="/assets/js/762.f7e46ea3.js"><link rel="prefetch" href="/assets/js/763.be700e67.js"><link rel="prefetch" href="/assets/js/764.e02133f4.js"><link rel="prefetch" href="/assets/js/765.bc997b94.js"><link rel="prefetch" href="/assets/js/766.e0857398.js"><link rel="prefetch" href="/assets/js/767.85d8ef77.js"><link rel="prefetch" href="/assets/js/768.313971f2.js"><link rel="prefetch" href="/assets/js/769.b1d8359c.js"><link rel="prefetch" href="/assets/js/77.bad1e17d.js"><link rel="prefetch" href="/assets/js/770.c51c77a6.js"><link rel="prefetch" href="/assets/js/771.bced04e3.js"><link rel="prefetch" href="/assets/js/772.b363306d.js"><link rel="prefetch" href="/assets/js/773.1765d7c9.js"><link rel="prefetch" href="/assets/js/774.e64e812a.js"><link rel="prefetch" href="/assets/js/775.80ba2e01.js"><link rel="prefetch" href="/assets/js/776.264a89cf.js"><link rel="prefetch" href="/assets/js/777.640660f8.js"><link rel="prefetch" href="/assets/js/778.ce471428.js"><link rel="prefetch" href="/assets/js/779.fa84a589.js"><link rel="prefetch" href="/assets/js/78.871caac1.js"><link rel="prefetch" href="/assets/js/780.788b9350.js"><link rel="prefetch" href="/assets/js/781.baa1fd6f.js"><link rel="prefetch" href="/assets/js/782.e07dfca4.js"><link rel="prefetch" href="/assets/js/783.2b476376.js"><link rel="prefetch" href="/assets/js/784.6b40fe65.js"><link rel="prefetch" href="/assets/js/785.19de1934.js"><link rel="prefetch" href="/assets/js/786.b1910024.js"><link rel="prefetch" href="/assets/js/787.70e33999.js"><link rel="prefetch" href="/assets/js/788.7a676aa7.js"><link rel="prefetch" href="/assets/js/789.bec5efe7.js"><link rel="prefetch" href="/assets/js/79.8d41f9dc.js"><link rel="prefetch" href="/assets/js/790.c5dd47a4.js"><link rel="prefetch" href="/assets/js/791.a3fb9ec9.js"><link rel="prefetch" href="/assets/js/792.f6f28bf1.js"><link rel="prefetch" href="/assets/js/793.131d60fe.js"><link rel="prefetch" href="/assets/js/794.b2797539.js"><link rel="prefetch" href="/assets/js/795.f72bf6cb.js"><link rel="prefetch" href="/assets/js/796.f5318e9b.js"><link rel="prefetch" href="/assets/js/797.5ec81ca5.js"><link rel="prefetch" href="/assets/js/798.10a6d862.js"><link rel="prefetch" href="/assets/js/799.0b58983b.js"><link rel="prefetch" href="/assets/js/8.f8232281.js"><link rel="prefetch" href="/assets/js/80.29f002cb.js"><link rel="prefetch" href="/assets/js/800.bc35c5a2.js"><link rel="prefetch" href="/assets/js/801.6bedad40.js"><link rel="prefetch" href="/assets/js/802.8461a07c.js"><link rel="prefetch" href="/assets/js/803.595e6098.js"><link rel="prefetch" href="/assets/js/804.c8ff7677.js"><link rel="prefetch" href="/assets/js/805.502828e9.js"><link rel="prefetch" href="/assets/js/806.94964806.js"><link rel="prefetch" href="/assets/js/807.f0736b45.js"><link rel="prefetch" href="/assets/js/808.ca5c224c.js"><link rel="prefetch" href="/assets/js/809.ee75100a.js"><link rel="prefetch" href="/assets/js/81.5061f047.js"><link rel="prefetch" href="/assets/js/810.cb147b2c.js"><link rel="prefetch" href="/assets/js/811.7c43a374.js"><link rel="prefetch" href="/assets/js/812.f94931de.js"><link rel="prefetch" href="/assets/js/813.c315fb59.js"><link rel="prefetch" href="/assets/js/814.df98f474.js"><link rel="prefetch" href="/assets/js/815.b1545a3a.js"><link rel="prefetch" href="/assets/js/816.559f5d48.js"><link rel="prefetch" href="/assets/js/817.10fbbe90.js"><link rel="prefetch" href="/assets/js/818.15940c94.js"><link rel="prefetch" href="/assets/js/819.bd8da69e.js"><link rel="prefetch" href="/assets/js/82.6a318ad3.js"><link rel="prefetch" href="/assets/js/820.09a8aeac.js"><link rel="prefetch" href="/assets/js/821.7b47f642.js"><link rel="prefetch" href="/assets/js/822.bb268094.js"><link rel="prefetch" href="/assets/js/823.b5a869d6.js"><link rel="prefetch" href="/assets/js/824.702c7fe5.js"><link rel="prefetch" href="/assets/js/825.87185f83.js"><link rel="prefetch" href="/assets/js/826.06ffbcbf.js"><link rel="prefetch" href="/assets/js/827.ca37d712.js"><link rel="prefetch" href="/assets/js/83.ec14e26e.js"><link rel="prefetch" href="/assets/js/84.b45772f4.js"><link rel="prefetch" href="/assets/js/85.e93f7791.js"><link rel="prefetch" href="/assets/js/86.bfcc7e96.js"><link rel="prefetch" href="/assets/js/87.b1a0c17d.js"><link rel="prefetch" href="/assets/js/88.e827f4b8.js"><link rel="prefetch" href="/assets/js/89.3a23fcc3.js"><link rel="prefetch" href="/assets/js/9.49c28c7c.js"><link rel="prefetch" href="/assets/js/90.3e70c7d5.js"><link rel="prefetch" href="/assets/js/91.0c65c47f.js"><link rel="prefetch" href="/assets/js/92.ce986bb8.js"><link rel="prefetch" href="/assets/js/93.127730e7.js"><link rel="prefetch" href="/assets/js/94.4cdb42ca.js"><link rel="prefetch" href="/assets/js/95.27d08c91.js"><link rel="prefetch" href="/assets/js/96.2bfffb0d.js"><link rel="prefetch" href="/assets/js/97.8bb20cd6.js"><link rel="prefetch" href="/assets/js/98.b3ed5a1a.js"><link rel="prefetch" href="/assets/js/99.c6ca9d8c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3be6d54c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">随风</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/source-study/" class="nav-link">
  课程学习
</a></div><div class="nav-item"><a href="/source-vue/" class="nav-link">
  Vue源码
</a></div><div class="nav-item"><a href="/source-react/" class="nav-link">
  React
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Front End Menu" class="dropdown-title"><span class="title">Front End</span> <span class="arrow down"></span></button> <button type="button" aria-label="Front End Menu" class="mobile-dropdown-title"><span class="title">Front End</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-end/Html/" class="nav-link">
  HTML-DOM
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Css/" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/front-end/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Flutter/" class="nav-link">
  Flutter
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Electron/" class="nav-link">
  Electron
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Code/" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Engineering/" class="nav-link">
  工程化
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Interview/" class="nav-link">
  前端面试题
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Visual/" class="nav-link">
  可视化
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Security/" class="nav-link">
  前端安全
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Log/" class="nav-link">
  前端性能监控
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="back End Menu" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="back End Menu" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/back-end/Node/" class="nav-link router-link-active">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/back-end/Docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/back-end/Nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/back-end/Mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/back-end/Shell/" class="nav-link">
  shell
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="tools End Menu" class="dropdown-title"><span class="title">开发工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="tools End Menu" class="mobile-dropdown-title"><span class="title">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/Ai/" class="nav-link">
  Ai
</a></li><li class="dropdown-item"><!----> <a href="/tools/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/tools/VScode/" class="nav-link">
  VScode
</a></li><li class="dropdown-item"><!----> <a href="/tools/Chrome/" class="nav-link">
  Chrome
</a></li><li class="dropdown-item"><!----> <a href="/tools/Other/" class="nav-link">
  工具
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="wander End Menu" class="dropdown-title"><span class="title">随记</span> <span class="arrow down"></span></button> <button type="button" aria-label="wander End Menu" class="mobile-dropdown-title"><span class="title">随记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/wander/Work/" class="nav-link">
  工作
</a></li><li class="dropdown-item"><!----> <a href="/wander/Life/" class="nav-link">
  生活
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/source-study/" class="nav-link">
  课程学习
</a></div><div class="nav-item"><a href="/source-vue/" class="nav-link">
  Vue源码
</a></div><div class="nav-item"><a href="/source-react/" class="nav-link">
  React
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Front End Menu" class="dropdown-title"><span class="title">Front End</span> <span class="arrow down"></span></button> <button type="button" aria-label="Front End Menu" class="mobile-dropdown-title"><span class="title">Front End</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-end/Html/" class="nav-link">
  HTML-DOM
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Css/" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/front-end/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Flutter/" class="nav-link">
  Flutter
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Electron/" class="nav-link">
  Electron
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Code/" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Engineering/" class="nav-link">
  工程化
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Interview/" class="nav-link">
  前端面试题
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Visual/" class="nav-link">
  可视化
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Security/" class="nav-link">
  前端安全
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Log/" class="nav-link">
  前端性能监控
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="back End Menu" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="back End Menu" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/back-end/Node/" class="nav-link router-link-active">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/back-end/Docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/back-end/Nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/back-end/Mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/back-end/Shell/" class="nav-link">
  shell
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="tools End Menu" class="dropdown-title"><span class="title">开发工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="tools End Menu" class="mobile-dropdown-title"><span class="title">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/Ai/" class="nav-link">
  Ai
</a></li><li class="dropdown-item"><!----> <a href="/tools/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/tools/VScode/" class="nav-link">
  VScode
</a></li><li class="dropdown-item"><!----> <a href="/tools/Chrome/" class="nav-link">
  Chrome
</a></li><li class="dropdown-item"><!----> <a href="/tools/Other/" class="nav-link">
  工具
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="wander End Menu" class="dropdown-title"><span class="title">随记</span> <span class="arrow down"></span></button> <button type="button" aria-label="wander End Menu" class="mobile-dropdown-title"><span class="title">随记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/wander/Work/" class="nav-link">
  工作
</a></li><li class="dropdown-item"><!----> <a href="/wander/Life/" class="nav-link">
  生活
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>node-command</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>底层相关</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/back-end/Node/base-01.html" class="sidebar-link">Node.js底层原理</a></li><li><a href="/back-end/Node/base-02.html" aria-current="page" class="active sidebar-link">深入理解Node.js 进程与线程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/back-end/Node/base-02.html#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header"><a href="/back-end/Node/base-02.html#进程" class="sidebar-link">进程</a></li><li class="sidebar-sub-header"><a href="/back-end/Node/base-02.html#线程" class="sidebar-link">线程</a></li><li class="sidebar-sub-header"><a href="/back-end/Node/base-02.html#node-js中进程和线程" class="sidebar-link">Node.js中进程和线程</a></li><li class="sidebar-sub-header"><a href="/back-end/Node/base-02.html#node-js中的进程" class="sidebar-link">Node.js中的进程</a></li><li class="sidebar-sub-header"><a href="/back-end/Node/base-02.html#node-js进程通信原理" class="sidebar-link">Node.js进程通信原理</a></li><li class="sidebar-sub-header"><a href="/back-end/Node/base-02.html#node-js句柄传递" class="sidebar-link">Node.js句柄传递</a></li><li class="sidebar-sub-header"><a href="/back-end/Node/base-02.html#node-js多进程架构模型" class="sidebar-link">Node.js多进程架构模型</a></li><li class="sidebar-sub-header"><a href="/back-end/Node/base-02.html#node-js进程守护" class="sidebar-link">Node.js进程守护</a></li><li class="sidebar-sub-header"><a href="/back-end/Node/base-02.html#linux关闭一个进程" class="sidebar-link">linux关闭一个进程</a></li><li class="sidebar-sub-header"><a href="/back-end/Node/base-02.html#node-js线程" class="sidebar-link">Node.js线程</a></li><li class="sidebar-sub-header"><a href="/back-end/Node/base-02.html#总结" class="sidebar-link">总结</a></li><li class="sidebar-sub-header"><a href="/back-end/Node/base-02.html#资料" class="sidebar-link">资料</a></li></ul></li><li><a href="/back-end/Node/base-03.html" class="sidebar-link">深入理解NodeJS事件循环机制</a></li><li><a href="/back-end/Node/base-04.html" class="sidebar-link">套字节</a></li><li><a href="/back-end/Node/base-cluster01.html" class="sidebar-link">当我们谈论 cluster 时我们在谈论什么(上)</a></li><li><a href="/back-end/Node/base-cluster02.html" class="sidebar-link">当我们谈论 cluster 时我们在谈论什么(下)</a></li><li><a href="/back-end/Node/base-progress.html" class="sidebar-link">Nodejs进程间通信</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>框架</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>学习</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>serverless</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>node问题记录</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node开发一个博客</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Deno</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>进程和线程是一个程序员的必知概念，面试经常被问及，但是一些文章内容只是讲讲理论知识，可能一些小伙伴并没有整的理解，在实际开发中应用也比较少。本篇文章除了介绍概念，通过Node.js的角度讲解进程与线程，并且讲解一些项目中的实战的应用，让你不仅仅能迎战面试官还可以在实战中完美应用</p> <h3 id="文章导览"><a href="#文章导览" class="header-anchor">#</a> 文章导览</h3> <p><img src="/assets/img/615.f245b42f.jpg" alt="文章导览"></p> <h3 id="面试会问"><a href="#面试会问" class="header-anchor">#</a> 面试会问</h3> <ol><li>Node.js是单线程吗？</li> <li>Node.js做耗时的计算时候，如何避免阻塞</li> <li>Node.js如何实现多进程的开启和关闭</li> <li>Node.js可以创建线程吗</li> <li>开发过程中如何实现进程守护</li> <li>处了使用第三方模块，自己是否封装过一个多进程架构</li></ol> <h2 id="进程"><a href="#进程" class="header-anchor">#</a> 进程</h2> <p>进程Process是计算机程序中关于某数据集合上的一次运行活动，是系统进行资源分配的和调度的基本单位，是操作系统结构的基础，进程是线程的容器。<span style="color:red;">进程是资源分配的最小单位</span>。我们启动一个服务、运行一个实例，就是开一个服务进程，例如Java里的JVM本身就是一个进程，<strong><span style="color:blue;">Node.js里通过node app.js开启一个服务进程，多进程就是进程的复制fork，fork出来的每一个进程都拥有自己的独立空间地址、数据线，一个进程无法访问另一个进程里定义的变量、数据结构，只有建立了IPC(InterProcess Communication)通信，进程之间才可数据共享。</span></strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    process<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">'程序员成长测试进程'</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'进程id'</span><span class="token punctuation">,</span>process<span class="token punctuation">.</span>pid<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>运行上面代码后，以下为Mac系统自带的监控工具&quot;活动监视器&quot;所展示的效果，可以看到我们刚开启的Nodejs进程7663</p> <p><img src="/assets/img/616.dc162cee.jpg" alt="mac活动监视器"></p> <h2 id="线程"><a href="#线程" class="header-anchor">#</a> 线程</h2> <p><span style="color:red;">线程是操作系统能够进行运算调度的最小单位</span>，首先我们要清楚线程是隶属于进程的，被包含于进程中。<strong><span style="color:blue;">一个线程只能隶属于一个进程，但是一个进程是可以拥有多个线程的</span></strong></p> <h3 id="单线程"><a href="#单线程" class="header-anchor">#</a> 单线程</h3> <p><strong><span style="color:red;">单线程就是一个进程只开一个线程</span></strong></p> <p>Javascript就是属于单线程，程序顺序执行(这里暂且不提JS异步)，可以想象一个队列，前面一个执行完之后，后面才可以执行，当你在使用单线程语言编码时切勿有过多耗时的同步操作，否则想成会造成阻塞，导致后续响应无法处理。你如果采用Javascript进行编码时，尽可能的利用Javascript异步操作的特性</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 经典计算耗时造成线程阻塞的例子</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">longComputation</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span> <span class="token number">1e10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sum <span class="token operator">+=</span> i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>url <span class="token operator">===</span> <span class="token string">'/compute'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'计算开始'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> sum <span class="token operator">=</span> <span class="token function">longComputation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'计算结束'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sum is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sum<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//打印结果</span>

<span class="token comment">//计算开始 2019-07-28T07:08:49.849Z</span>

<span class="token comment">//计算结束 2019-07-28T07:09:04.522Z</span>

</code></pre></div><p>查看打印结果，当我们调用 127.0.0.1:3000/compute的时候，如果想要调用其他的路由地址比如127.0.0.1/大约需要15秒时间，也可以说一个用户请求完第一个 compute接口后需要等待15秒，这对于用户来说是极其不友好的。<span style="color:red;">下文我会通过创建多进程的方式 child_process.fork 和 cluster 来解决解决这个问题。</span></p> <p><strong>单线程的一些说明</strong></p> <ol><li><span style="color:blue;">Node.js虽然是单线程，但是其基于事件驱动、异步非阻塞模式，可以应用于高并发场景，避免了线程创建、线程之间上下文切换所产生的资源开销</span></li> <li><span style="color:blue;">当你的项目中需要有大量计算,CPU耗时的操作的时候，要注意考虑开启多进程来完成了</span></li> <li><span style="color:blue;">Node.js开发过程中，错误会引起整个应用退出，应用的健壮性值得考验，尤其是错误的异常抛出，以及进程守护是必须要做的</span></li> <li><span style="color:blue;">单线程无法利用多核CPU，但是后来Node.js提供的API以及一些第三方工具相应都得到了解决，文章后面会讲到</span></li></ol> <h2 id="node-js中进程和线程"><a href="#node-js中进程和线程" class="header-anchor">#</a> Node.js中进程和线程</h2> <p><strong><span style="color:orange;">Node.js是Javascript在服务端的运行环境,构建在chrome的V8引擎之上，基于事件驱动、非阻塞I/O模型，充分利用操作系统提供的异步I/O进行多任务执行，适合于I/O密集型的应用场景，因为异步，程序无需阻塞等待结果返回，而是基于回调通知的机制，原本同步模式等待的时间，则可以用来处理其他任务</span></strong></p> <div class="custom-block danger"><p class="custom-block-title">WARNING</p> <p>在web服务器方面，著名的Nginx也是采用此模式(事件驱动)，避免了多线程的线程创建、线程上下文切换开销，Nginx采用C语言进行编写，主要用来做高性能的Web服务器，不适用做业务</p></div> <p>Web业务开发中，如果你有高并发应用场景那么Node.js会是你不错的选择。</p> <p>在单核CPU系统之后我们采用单进程+单线程的模式来开发。在多核CPU系统上，可以通过child_process, fork开启多个进程(Node.js在v0.8版本之后新增了Cluster来实现多进程架构)，<strong><span style="color:red;">即多进程+单线程模式。注意：开启多进程不是为了解决高<a href="/front-end/JavaScript/network-xhr.html#fetch">并发</a>，主要是解决了单进程模式下Nodejs CPU利用率不足的情况，充分利用多核CPU的性能</span></strong></p> <h2 id="node-js中的进程"><a href="#node-js中的进程" class="header-anchor">#</a> Node.js中的进程</h2> <h3 id="process模块"><a href="#process模块" class="header-anchor">#</a> process模块</h3> <p>Node.js中的进程Process是一个全局对象，无需require直接使用，给我们提供了当前进程中的相关信息。官方文档提供了详细说明，感兴趣的可以亲自实践下Process文档。</p> <ul><li><span style="color:blue;">process.env:环境变量，例如通过process.env.NODE_ENV获取不同环境项目配置信息</span></li> <li><span style="color:blue;">process.nextTick：这个在谈及Event Loop时候经常用到</span></li> <li><span style="color:blue;">process.pid：获取当前的进程id</span></li> <li><span style="color:blue;">process.ppid：当前进程对应的父进程</span></li> <li><span style="color:blue;">process.cwd(): 获取当前进程工作目录</span></li> <li><span style="color:blue;">process.platform: 获取当前进程运行的操作系统平台</span></li> <li><span style="color:blue;">process.uptime(): 当前进程已运行时间，例如pm2守护进程的uptime值</span></li> <li><span style="color:blue;">进程事件: process.on('uncaughtException', cb),捕获异常信息、process.on('exit', cb)进程退出监听</span></li> <li><span style="color:blue;">三个标准流：process.stdout标准输出、process.stdin标准输入、process.stderr标准错误输出</span></li> <li><span style="color:blue;">process.title: 指定进程名称，有的时候需要给进程指定一个名称</span></li></ul> <p>以上仅列举了部分常用功能点，<span style="color:red;">除了Process之外Node.js还提供了child_process模块用来对子进程进行操作，在下文Node.js进程创建会继续讲述</span></p> <h3 id="node-js进程创建"><a href="#node-js进程创建" class="header-anchor">#</a> Node.js进程创建</h3> <p>进程创建有多种方式，本篇文章以child_process模块和cluster模块进行讲解</p> <h4 id="child-process模块"><a href="#child-process模块" class="header-anchor">#</a> child_process模块</h4> <p>child_process是Node.js内置模块，<a href="http://nodejs.cn/api/childprocess.html#childprocesschild_process" target="_blank" rel="noopener noreferrer">官网地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>几个常用函数：四种方式</p> <ul><li><span style="color:blue;">child_process.spawn():适用于返回大量数据，例如图像处理，二进制数据处理。</span></li> <li><span style="color:blue;">child_process.exec():适用于小量数据，maxBuffer默认值为200*1024超出这个默认值将会导致程序崩溃，数据量大可采用spawn</span></li> <li><span style="color:blue;">child_process.execFile():类似child_process.exec()，区别是不能通过shell来执行，不支持I/O重定向和文件查找这样的行为</span></li> <li><span style="color:blue;">child_process.fork():衍生新的进程，进程之间是相互独立的，每个进程都有自己的V8实例、内存、系统资源是有限的，不建议衍生太多的子进程出来，通常根据cpu核心数设置。</span></li></ul> <div class="custom-block danger"><p class="custom-block-title">WARNING</p> <p>CPU核心数这里说明下，fork确实可以开启多个进程，但是并不建议衍生出来太多的进程，cpu核心数的获取方式const cpus = require('os').cpus();这里cpus返回一个对象数组，包含所安装的每个CPU/内核的信息，二者总和的数组。假设主机装有两个cpu，每个cpu有4个核，那么总核数就是8</p></div> <h4 id="fork开启子进程demo"><a href="#fork开启子进程demo" class="header-anchor">#</a> fork开启子进程demo</h4> <p>fork开启子进程解决文章起初的计算耗时时造成线程阻塞。在进程compute计算时创建子进程，子进程计算通过send方法将结果发送给主进程，主进程通过message监听到信息后处理并推出</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// fork_app.js</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fork <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'child_process'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fork<span class="token punctuation">;</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>url <span class="token operator">===</span> <span class="token string">'/compute'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> compute <span class="token operator">=</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token string">'./fork_compute.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        compute<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'开启一个新的子进程'</span><span class="token punctuation">)</span>；
        <span class="token comment">// 当一个子进程使用process.send()发送消息时会触发message事件</span>
        compute<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token parameter">sum</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Sum is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sum<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            compute<span class="token punctuation">.</span><span class="token function">kill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token comment">// 子进程监听到一些错误消息退出</span>
        compute<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">code<span class="token punctuation">,</span> signal</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">收到close事件，子进程收到信号</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>signal<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">而终止，退出码</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>code<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            compute<span class="token punctuation">.</span><span class="token function">kill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">server started at http://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token number">3000</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>针对需要进行计算的例子我们创建子进程拆分出来单独进行运算。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">computation</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">'计算开始'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'计算耗时'</span><span class="token punctuation">)</span>；
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1e10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        sum <span class="token operator">+=</span> i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'计算结束'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'计算耗时'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
process<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token parameter">msg</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> <span class="token string">'process.pid'</span><span class="token punctuation">,</span> process<span class="token punctuation">.</span>pid<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 子进程id</span>
    <span class="token keyword">const</span> sum <span class="token operator">=</span> <span class="token function">computation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 如果Node.js进程是通过进程间通信产生的，那么，process.send()方法可以用来给父进程发送消息</span>
    process<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="cluster模块"><a href="#cluster模块" class="header-anchor">#</a> cluster模块</h3> <p>cluster开启子进程Demo</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> numCPUS <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">cpus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token keyword">const</span> cluster <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cluster'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>cluster<span class="token punctuation">.</span>isMaster<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Master proces id is'</span><span class="token punctuation">,</span> process<span class="token punctuation">.</span>pid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// fork workers</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numsCPUS<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cluster<span class="token punctuation">.</span><span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cluster<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'exit'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">worker<span class="token punctuation">,</span> code<span class="token punctuation">,</span> signal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'worker process died,id'</span><span class="token punctuation">,</span> worker<span class="token punctuation">.</span>process<span class="token punctuation">.</span>pid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// Worker可以共享同一个TOP连接  这里是一个http服务器</span>
    http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'hello wrod'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="cluster原理分析"><a href="#cluster原理分析" class="header-anchor">#</a> cluster原理分析</h4> <p><img src="data:image/jpeg;base64,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" alt="cluster原理分析"></p> <p><span style="color:red;">cluster模块调用fork方法来创建子进程，该方法与child_process中的fork是同一个方法。<strong>cluster模块采用的是经典的主从模型，Cluster会创建一个master，然后根据你指定的数量复制出多个子进程，可以使用cluster.isMaster属性判断当前进程是master还是worker(工作进程)。由master来管理所有的子进程，主进程不负责具体的任务处理，主要工作是负责调度和管理。</strong></span></p> <p><span style="color:blue;">cluster模块使用内置的负载均衡来更好的处理线程之间的压力</span>，该负载均衡使用了Round-robin算法(也被称为循环算法)。当使用Round-robin调度策略时，master accepts()所有传入的连接请求，然后将相应的TCP请求处理发送给选中的工作进程(该方式仍然通过IPC来进行通信)。</p> <p>开启多进程时候端口疑问讲解:如果多个Node进程监听同一个端口时出现Error：listen EADDRIUNS的错误，而cluster为什么可以让多个子进程监听同一个端口呢？<strong><span style="color:blue;">原因是master进程内部启动了一个TCP服务器，而真正监听端口的只有这个服务器，当来自前端的请求触发服务器的connection事件后，master会将对应的socket句柄发送给子进程</span></strong></p> <h3 id="child-process模块与cluster模块总结"><a href="#child-process模块与cluster模块总结" class="header-anchor">#</a> child_process模块与cluster模块总结</h3> <p><mark>无论是child_process模块还是cluster模块，为了解决Node.js实例单线程运行，无法利用多核CPU的问题而出现的</mark>。<strong><span style="color:blue;">核心就是父进程(即master进程)负责监听端口，接收到新的请求后将其分发给下面的worker进程</span></strong></p> <p>cluster模块的弊端</p> <p><img src="data:image/jpeg;base64,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" alt="child_process"> <img src="data:image/png;base64,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" alt="cluster"></p> <p><span style="color:blue;">cluster内部隐式的构建TCP服务器的方式对使用者确实简单和透明了很多，但是这种方式无法像使用child_process那样灵活，因为一直主进程只能管理一组相同的工作进程；而自行通过child_process来创建的工作进程，一个主进程可以控制多组进程。<mark>原因是child_process操作子进程时，可以隐式的创建多个TCP服务器，对比上面的两幅图应该能理解</mark></span></p> <h2 id="node-js进程通信原理"><a href="#node-js进程通信原理" class="header-anchor">#</a> Node.js进程通信原理</h2> <p>前面讲解的无论是child_process模块，还是cluster模块，都需要主进程和工作进程之间的通信。<span style="color:blue;">通过fork()或者其他API,创建了子进程之后,为了实现父子进程之间的通信,父子继承之间才能通过message和send()传递消息。</span></p> <p>IPC这个词我想大家并不陌生，不管哪一种开发语言只要提到进程通信，都会提到它。<span style="color:red;">IPC的全程是Inter-Process Communication，即进程间通信。</span>它的目的是为了让不同的进程能够相互访问资源并进行协调工作。<span style="color:blue;">实现进程间通信的技术有很多，<strong>如命名管道，匿名管道，socket，信号量，共享内存，消息队列等</strong>。Node中实现IPC通道依赖于libuv。windows下由命名管道(name pipe)实现，unix系统则采用Unix Domain Socket实现。表现在应用层上的进程间通信只有简单的message事件和send()方法，接口十分简介和消息化</span></p> <p>IPC创建和实现示意图</p> <p><img src="data:image/jpeg;base64,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" alt="IPC创建和实现示意图"></p> <p>IPC通信管道是如何创建的</p> <p><img src="/assets/img/621.dec98bc5.jpg" alt="IPC通信管道是如何创建的"></p> <p><span style="color:blue;">父进程在实际创建子进程之前，会创建IPC通道并监听它，然后才真正的创建出子进程，这个过程中也会通过环境变量(NODECHANNELFD)告诉子进程这个IPC通道的这个文件描述符。子进程启动的过程中，根据文件描述符去连接这个已存在的IPC通道，从而完成父子进程之间的连接。</span></p> <h2 id="node-js句柄传递"><a href="#node-js句柄传递" class="header-anchor">#</a> Node.js句柄传递</h2> <p>讲句柄之前，先想一个问题，send句柄发送的时候，真的是将服务器对象发送给了子进程？</p> <h3 id="子进程对象send-方法可以发送的句柄类型"><a href="#子进程对象send-方法可以发送的句柄类型" class="header-anchor">#</a> 子进程对象send()方法可以发送的句柄类型</h3> <ul><li>net.Socket TCP套接字</li> <li>net.Server TCP服务器，任意建立在TCP服务上的应用层服务都可以享受它带来的好处</li> <li>net.Native C++层面的TCP套接字或IPC管道</li> <li>dgram.Socket UDP套接字</li> <li>dgram.Native c++层面的UDP套接字</li></ul> <h3 id="send句柄发送原理分析"><a href="#send句柄发送原理分析" class="header-anchor">#</a> send句柄发送原理分析</h3> <p>结合句柄的发送和还原示意图更容易理解</p> <p><img src="/assets/img/622.5756fd73.jpg" alt="send句柄发送原理分析"></p> <p><span style="color:blue;">send()方法在将消息发送到IPC通道前，实际将消息组装成了两个对象，一个参数是hadler，另一个是message。message参数如下</span></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    cmd<span class="token operator">:</span> <span class="token string">'NODE_HANDLE'</span><span class="token punctuation">,</span>
    <span class="token constant">TYPE</span><span class="token operator">:</span> <span class="token string">'net.Server'</span><span class="token punctuation">,</span>
    msg<span class="token operator">:</span> message
<span class="token punctuation">}</span>
</code></pre></div><p>发送到IPC管道中的实际上是我们要发送的句柄文件描述符。这个message对象在写入到IPC管道时，也会通过JSON.stringfy()进行序列化。所以最终发送到IPC通道中的信息都是字符串，send()方法能发送消息和句柄并不意味着它能发送任何对象。</p> <p>连接了IPC通道的子线程可以读取父进程发来的消息，将字符串通过JSON.parse()解析还原为对象后，才触发message事件将消息传递给应用层使用。在这个过程中，消息对象还要被进行过滤处理，message.cmd的值如果以NODE为前缀，它将相应一个内部事件internalMessage，如果message.cmd值为NODEHANDLE,它将取出message.type的值和得到的文件描述符一起还原出一个对应的对象。</p> <p>以发送的TCP服务器句柄为例，子进程收到消息后的还原过程代码如下</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> handle<span class="token punctuation">,</span> emit</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">net<span class="token punctuation">.</span>Server</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>handler<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">emit</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这段还原代码，子进程根据message.type创建对应的TCP服务器对象，然后监听到文件描述符上。由于底层细节不被应用层感知，所以子进程中，开发者会有一种服务器对象就是从父进程中直接传递过来的错觉。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Node进程之间只有消息传递，不会真正的传递对象，这种错觉是抽象封装的结果。目前Node只支持我前面提到的几种句柄，并非任意类型的句柄都能在进程之间传递，除非它有完成的发送和还原的过程</p></div> <h2 id="node-js多进程架构模型"><a href="#node-js多进程架构模型" class="header-anchor">#</a> Node.js多进程架构模型</h2> <p>我们自己实现一个多进程架构守护Demo</p> <p><img src="/assets/img/623.d2d03822.jpg" alt="多进程架构守护"></p> <p><strong>编写主进程</strong></p> <p>master.js主要处理一下逻辑</p> <ul><li><span style="color:blue;">创建一个server并监听3000端口</span></li> <li><span style="color:blue;">根据系统cpus开启多个进程</span></li> <li><span style="color:blue;">通过进程对象的send方法发送消息到子进程进行通信</span></li> <li><span style="color:blue;">在主进程中监听了子进程的变化，如果是自杀信号重新启动一个工作进程</span></li> <li><span style="color:blue;">主进程监听到退出消息的时候，先退出子进程在退出主进程</span></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// master.js</span>
<span class="token keyword">const</span> fork <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'child_process'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fork<span class="token punctuation">;</span>
<span class="token keyword">const</span> cpus <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">cpus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'net'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
process<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">'node-master'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> workers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">createWorker</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> worker <span class="token operator">=</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token string">'worker.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    worker<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>message<span class="token punctuation">.</span>act <span class="token operator">===</span> <span class="token string">'suicide'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">createWorker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    worker<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'exit'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">code<span class="token punctuation">,</span> signal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'worker process exited, code: %s signal: %s'</span><span class="token punctuation">,</span> code<span class="token punctuation">,</span> signal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">delete</span> workers<span class="token punctuation">[</span>worker<span class="token punctuation">.</span>pid<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    worker<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'server'</span><span class="token punctuation">,</span> server<span class="token punctuation">)</span><span class="token punctuation">;</span>
    workers<span class="token punctuation">[</span>worker<span class="token punctuation">.</span>pid<span class="token punctuation">]</span> <span class="token operator">=</span> server<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'worker process created, pid: %s ppid:%s'</span><span class="token punctuation">,</span> worker<span class="token punctuation">.</span>pid<span class="token punctuation">,</span> process<span class="token punctuation">.</span>pid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cups<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">createWorker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

process<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">'SIGINT'</span><span class="token punctuation">,</span> <span class="token function">close</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'SIGINT'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// KILL(2) Ctrl -c;</span>
process<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">'SIGQUIT'</span><span class="token punctuation">,</span> <span class="token function">close</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'SIGQUIT'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// kill(3) Ctrl - \</span>
process<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">'SIGTERM'</span><span class="token punctuation">,</span> <span class="token function">close</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'SIGTERM'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// kill(15) default</span>
process<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">'exit'</span><span class="token punctuation">,</span> <span class="token function">close</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'进程退出!'</span><span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>code <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> pid <span class="token keyword">in</span> workers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'master process exited, kill worker pid:'</span><span class="token punctuation">,</span> pid<span class="token punctuation">)</span><span class="token punctuation">;</span>
            workers<span class="token punctuation">[</span>pid<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">kill</span><span class="token punctuation">(</span><span class="token string">'SIGINT'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>工作进程</strong></p> <p>worker.js子进程处理逻辑如下</p> <ul><li><span style="color:blue;">创建一个server对象，注意这里最开始并没有监听3000端口</span></li> <li><span style="color:blue;">通过message对象接收主进程send方法发送的消息</span></li> <li><span style="color:blue;">监听uncaughtException事件，捕获未处理的异常，发送自杀消息由主进程重建进程，子进程在连接关闭之后推出</span></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// worker.js</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token string">'Content-Type'</span><span class="token operator">:</span><span class="token string">'text/plan'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'I am worker, pid:'</span> <span class="token operator">+</span> process<span class="token punctuation">.</span>pid <span class="token operator">+</span> <span class="token string">', ppid:'</span> <span class="token operator">+</span> process<span class="token punctuation">.</span>ppid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'worker process exception!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 测试异常进程退出重启</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> worker<span class="token punctuation">;</span>
process<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">'node-worker'</span><span class="token punctuation">;</span>
process<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> sendHandle</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>message <span class="token operator">===</span> <span class="token string">'server'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        worker <span class="token operator">=</span> sendHandle<span class="token punctuation">;</span>
        worker<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connection'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            server<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'connection'</span><span class="token punctuation">,</span> socket<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
process<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'uncaughtException'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    process<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>act<span class="token operator">:</span> <span class="token string">'suicide'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    worker<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="node-js进程守护"><a href="#node-js进程守护" class="header-anchor">#</a> Node.js进程守护</h2> <h3 id="什么是进程守护"><a href="#什么是进程守护" class="header-anchor">#</a> 什么是进程守护</h3> <p>每次启动Node.js程序都需要在命令窗口输入命令 node app.js才能启动，但如果把命令窗口关闭则Node.js程序就会立即断掉。除此之外，当我们这个Node.js服务以外崩溃了就不能自动重启进程了。这些线程都不是我们想要看到的，所以需要通过某些方式来守护这个进程，执行node app.js开启一个服务进程后，我还可以在这个终端上做些别的事情，且不会相互影响。</p> <h3 id="如何实现进程守护"><a href="#如何实现进程守护" class="header-anchor">#</a> 如何实现进程守护</h3> <p><span style="color:blue;">这里我只说一些第三方进程守护框架，pm2和forever，它们都是可以实现进程守护，底层也都是通过上面讲的child_process模块和cluster模块实现的，这里就不在提他们的额原理。</span></p> <p>pm2指定生成环境启动一个名为test的node服务</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>pm2 start app<span class="token punctuation">.</span>js <span class="token operator">-</span>env production <span class="token operator">--</span>name test
</code></pre></div><p><strong>Pm2常用api</strong></p> <ul><li>pm2 stop Name/processId停止某个服务，通过服务名称或者服务进程ID</li> <li>pm2 delete Name/processId 删除某个服务，通过服务名称或者服务进程ID</li> <li>pm2 log [name] 查看日志，如果添加服务名称，则指定查看某个服务的日志，不加则查看所有日志</li> <li>pm2 start app.js -i 4 集群， -i参数用来告诉pm2以clustermode的形式运行你的app(对应的叫forkmode)，后面的数字表示要启动的工作线程的数量。如果给定的数字为0，PM2则会更加CPU核心的数量来生成对应的工作线程。注意一般在生成环境使用cluster_mode模式，测试或者本地环境使用fork模式，方便测试到错误</li> <li>pm2 reload Name, pm2 restart Name 应用程序代码有更新，可以用重载来加载新代码，也可以用重启来完成 reload可以做到0秒宕机加载心代码，restart则是重新启动，生成环境中多用reload来完成代码更新</li> <li>pm2 show Name 查看服务详情</li> <li>pm2 list 查看pm2中所有项目</li> <li>pm2 monit 用monit可以打开实时监控器去查看资源占用情况</li></ul> <p><strong>pm2官网个地址</strong></p> <p><a href="http://pm2.keymetrics.io/docs/usage/quick-start/" target="_blank" rel="noopener noreferrer">pm2官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[forever]https://github.com/foreverjs/forever</p> <p>注意：二者更推荐pm2，看一下二者对比就知道我为什么更推荐使用pm2了。</p> <p>https://www.jianshu.com/p/fdc12d82b661</p> <h2 id="linux关闭一个进程"><a href="#linux关闭一个进程" class="header-anchor">#</a> linux关闭一个进程</h2> <ul><li>查找与进程相关的PID号<div class="language-javascript extra-class"><pre class="language-javascript"><code>ps aux <span class="token operator">|</span> grep server

<span class="token comment">// demo</span>
px aux <span class="token operator">|</span> grep <span class="token number">41184</span>
</code></pre></div></li> <li>杀死进程
<ul><li><p>以优雅的方式结束进程</p> <p>kill -I PID</p> <p>-I选项告诉kill命令用好像启动进程的用户以注销的方式结束进程。当使用该选项时，kill命令也视图杀死所留下的子进程。但这个命令也不是总能成功--或许仍然需要先手工杀死子进程，然后在傻子父进程</p></li> <li><p>kill 命令用于终止进程</p> <p>例如：kill-9[PID]-9 表示强迫进程立即停止</p> <p>这个强大和危险的命令迫使进程在运行时突然终止，进程在结束后不能自我清理。危害是导致系统资源无法正常释放，一般不推荐使用，除非其他办法都无效。当使用此命令时，一定要通过ps -ef确认没有剩下任何僵尸进程。只能通过终止父进程来消除僵尸进程。如果僵尸进程被init收养，问题就比较严重了。杀死init进程意味着关闭系统。如果系统中有僵尸进程，并且其父进程是init，
而且僵尸进程占用了大量的系统资源，那么就需要在某个时候重启机器以清除进程表了。</p></li> <li><p>killall 命令</p> <p>杀死同一进程组内的所有进程。其允许指定要终止的进程的名称，而非PID</p> <div class="language- extra-class"><pre class="language-text"><code>killall httppd
</code></pre></div></li></ul></li></ul> <h2 id="node-js线程"><a href="#node-js线程" class="header-anchor">#</a> Node.js线程</h2> <h3 id="node-js关于单线程的误区"><a href="#node-js关于单线程的误区" class="header-anchor">#</a> Node.js关于单线程的误区</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    process<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">'程序员成长测试进程'</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'进程id'</span><span class="token punctuation">,</span> process<span class="token punctuation">.</span>pid<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>仍然看本文第一段代码，创建了http服务，开启了一个进程，都说了Node.js是单线程，所以Node启动了线程数应该是1，但是为什么会开启7个线程呢？难道Javascript不是单线程不知道小伙伴有没有这个疑问？</p> <p>解释下原因：</p> <p>Node中最核心的是V8引擎，在Node启动后，会创建V8的实例，这个实例是多线程的。</p> <ul><li><span style="color:blue;">主线程:编译、执行代码</span></li> <li><span style="color:blue;">编译/优化线程：在主线程执行的时候，可以优化代码</span></li> <li><span style="color:blue;">分析器线程：记录分析代码运行时间，为Crankshaft优化代码执行提供依据</span></li> <li><span style="color:blue;">垃圾回收的几个线程</span></li></ul> <p>所以大家常说的Node是单线程指的是Javascript的执行是单线程(开发者编码的代码运行在单线程环境中)，但Javascript的宿主环境，无论是Node还是浏览器是多线程的因为libuv中有线程池的概念存在的，libuv会通过类似线程池的实现来模拟不同操作系统的异步调用，这对开发者来说是不可见的</p> <h3 id="某些异步io会占用额外的线程"><a href="#某些异步io会占用额外的线程" class="header-anchor">#</a> 某些异步IO会占用额外的线程</h3> <p>还是上面的例子，我们在定时器执行的同事，去读一个文件</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./index.html'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>线程数量变成11个，这是因为在Node中有一些IO操作(DNS,FS)和一些CPU秘密计算(zlib, Crypto)会启用Node的线程池，而线程池默认大小是4,因为线程数变成了11，我们可以手动更改线程池默认大小</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">UV_THREADPPOOL_SIZE</span> <span class="token operator">=</span> <span class="token number">64</span>
</code></pre></div><p>一行代码轻松把线程变成71</p> <h3 id="libuv"><a href="#libuv" class="header-anchor">#</a> Libuv</h3> <p><span style="color:blue;">Libuv是一个跨平台的异步IO库，它结合了Unix下的libev和window下的IOCP的特性，最早由Node的作者开发，专门为Node提供多屏下的异步IO支持。Libuv本身是由C++语言实现的，Node中的非阻塞IO以及事件循环机制都是由Libuv实现的</span></p> <p><img src="data:image/jpeg;base64,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" alt="libuv架构"></p> <p>在Window环境下，libuv直接使用windows的IOCP来实现异步IO。在非window下，libuv使用多线程来模拟异步IO</p> <p>注意下面的话，Node的异步调用是由libuv来支持的，以上面的读取文件的例子，读取文件实质的系统调用是由libuv来完成的，Node只是负责调用libuv的接口，等数据返回后在执行对应的回调方法</p> <h3 id="node-js线程创建"><a href="#node-js线程创建" class="header-anchor">#</a> Node.js线程创建</h3> <p>直到 Node 10.5.0 的发布，官方才给出了一个实验性质的模块 <strong><span style="color:blue;">worker_threads 给 Node 提供真正的多线程能力</span></strong>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>
    isMainThread<span class="token punctuation">,</span>
    parentPort<span class="token punctuation">,</span>
    workerData<span class="token punctuation">,</span>
    threadId<span class="token punctuation">,</span>
    MessageChannel<span class="token punctuation">,</span>
    MessagePort<span class="token punctuation">,</span>
    Worker
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'worker_threads'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">mainThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> worker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span>__filename<span class="token punctuation">,</span> <span class="token punctuation">{</span>workerData<span class="token operator">:</span> i<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        worker<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'exit'</span><span class="token punctuation">,</span> <span class="token parameter">code</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">main: worker stopped with exit code </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>code<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        worker<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token parameter">msg</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">main: receive </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>msg<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            worker<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>msg <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">workerThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">worker: workerDate </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>workerData<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    parentPort<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token parameter">msg</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">worker: receive </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>msg<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    parentPort<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>workerData<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>isMainThread<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">mainThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">workerThead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上述代码在主线程中开启五个子线程，并且主线程向子线程发送简单的消息。</p> <p>由于 worker_thread 目前仍然处于实验阶段，所以启动时需要增加 --experimental-worker flag，运行后观察活动监视器，开启了5个子线程</p> <h3 id="worker-thread-模块"><a href="#worker-thread-模块" class="header-anchor">#</a> worker_thread 模块</h3> <p>workerthread 核心代码（地址https://github.com/nodejs/node/blob/master/lib/workerthreads.js）
worker_thread 模块中有 4 个对象和 2 个类，可以自己去看上面的源码。</p> <ul><li><p>isMainThread: 是否是主线程，源码中是通过 threadId === 0 进行判断的。</p></li> <li><ul><li>MessagePort: 用于线程之间的通信，继承自 EventEmitter。</li></ul></li> <li><p>MessageChannel: 用于创建异步、双向通信的通道实例。</p></li> <li><p>threadId: 线程 ID。</p></li> <li><p>Worker: 用于在主线程中创建子线程。第一个参数为 filename，表示子线程执行的入口。</p></li> <li><p>parentPort: 在 worker 线程里是表示父进程的 MessagePort 类型的对象，在主线程里为 null</p></li> <li><p>workerData: 用于在主进程中向子进程传递数据（data 副本）</p></li></ul> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>多进程 vs 多线程</p> <table><thead><tr><th>属性</th> <th>多进程</th> <th>多线程</th> <th>比较</th></tr></thead> <tbody><tr><td>数据</td> <td>数据共享复杂，需要IPC;数据是分开的，同步简单</td> <td>因为共享进程数据，数据共享简单，同步复杂</td> <td>各有千秋</td></tr> <tr><td>CPU、内存</td> <td>占用内存多，切换复杂，CPU利用率低</td> <td>占用内存少，切换简单，CPU利用率高</td> <td>多线程更好</td></tr> <tr><td>销毁、切换</td> <td>创建销毁、切换复杂，速度慢</td> <td>创建销毁、切换简单速度很快</td> <td>多线程更好</td></tr> <tr><td>coding</td> <td>编码简单、调试方便</td> <td>编码、调试复杂</td> <td>编码、调试复杂</td></tr> <tr><td>可靠性</td> <td>进程独立运行，不会相互影响</td> <td>线程同呼吸共命运</td> <td>多进程更好</td></tr> <tr><td>分布式</td> <td>可用于多机多核分布式，易于扩展</td> <td>只能用于多核分布式</td> <td>多进程更好</td></tr></tbody></table> <h2 id="资料"><a href="#资料" class="header-anchor">#</a> 资料</h2> <p><a href="https://mp.weixin.qq.com/s/RiuRbKFUOvB-0Y99AyACOw" target="_blank" rel="noopener noreferrer">深入理解Node.js 进程与线程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://juejin.im/entry/5d4b7694f265da03cd0a6a4b" target="_blank" rel="noopener noreferrer">原文<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/back-end/Node/base-01.html" class="prev">
        Node.js底层原理
      </a></span> <span class="next"><a href="/back-end/Node/base-03.html">
        深入理解NodeJS事件循环机制
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ff5704b6.js" defer></script><script src="/assets/js/3.32bc1a55.js" defer></script><script src="/assets/js/45.914fb166.js" defer></script>
  </body>
</html>
