---
autoGroup-0: Vue3
title: Vue3.2单文件组件setup的语法总结
---
- 组合式API(composition api) 选项式API(Options API)

## setup 语法糖
setup是Vue3.0推出的语法糖，并且在Vue3.2版本进行了大更新，像写普通JS一样写Vue组件，对于开发者更加友好了;

按需引入computed、watch、directive等选项，一个业务逻辑可以集中编写在一起，让代码更加简洁便于浏览

## 一、基本用法
只需在&lt;script&gt;里添加一个setup属性，编译时会把&lt;script setup&gt;&lt;/script&gt;里的代码编译成一个setup函数
```html
<script setup>
    console.log('hello script setup');
</script>
```
**普通&lt;script&gt;只会在组件被首次引入的时候执行一次，&lt;script setup&gt;里的代码会在每次组件实例被创建的时候执行。**

## 二、data和methods
&lt;script setup&gt;里生命的变量和函数，不需要return暴露出去，就可以直接在template使用

```html
<script setup>
    import {ref, reactive} from 'vue';
    // 普通变量
    const msg = 'Hello';

    // 响应式变量
    let num = ref(111); // ref声明基本类型变量
    const obj = reactive({ // reactive声明对象类型变量，如Object、Array、Date...
        key: 'this is a object'
    })

    // 函数
    function log() {
        console.log(msg); // hello
        console.log(num.value); // 111(可根据inpu输入值而改变)
        console.log(obj.key); // this is a object
    }
</script>

<template>
    <h1>{{ msg }}</h1>
    <p>{{ obj.key }}</p>
    <input v-model="num" type="text"/>
    <button @click="log">打印日志</button>
</template>
```

## 三、计算属性computed
```html
<script setup>
    import { ref, computed } from 'vue';

    let count = ref(0);
    const countPlus = computed(() => {
        return count.value + 1;
    })
</script>

<template>
    <h1>计数: {{ countPlus }}</h2>
</template>
```
## 四、监听器watch、watchEffect
1. watch监听器除了使用方式有区别之外，其他的与vue2.0没啥变化


    ```html
    <script setup>
        import { ref, reactive, watch } from 'vue';

        // 监听ref
        let count = ref(0);
        watch(count, (newVal, oldVal) => {
            console.log('修改后', newVal);
            console.log('修改前', oldVal);
        })

        // 监听reactive属性
        const obj = reactive({
            count: 0
        })
        watch(
            () => obj.count, // 一个函数，返回监听属性
            (newVal, oldVal) => {
                console.log('修改后', newVal);
                console.log('修改前', oldVal);
            }, {
                immediate: true, // 立即执行，默认为false
                deep: true // 深度监听，默认为false
            }
        )

        const onChange = function() {
            count.value++;
            obj.count++;
        }
    </script>

    <template>
        <button @click="onChange">改变count</button>
    </template>
    ```
2. watchEffect

    watchEffect是Vue3.0新增的一个监听属性的方法，它与watch的区别在于watchEffect不需要指定监听对象，回调函数里可以直接



## 资料
[原文](https://juejin.cn/post/7095392368064462879)