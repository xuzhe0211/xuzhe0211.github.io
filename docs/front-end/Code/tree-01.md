---
title: æ ‘ç»“æ„
---

![jsæ ‘ç»“æ„](./images/46ce25b9a36a45d0b920a49bf013abf0.jpg)

## éå†æ ‘ç»“æ„

### æ ‘ç»“æ„ä»‹ç»
```js
let tree = [
    {
        id: '1',
        title: 'èŠ‚ç‚¹1'ï¼Œ
        children: [
            {
                id: '1-1',
                title: 'èŠ‚ç‚¹1-1'
            },
            {
                id: '1-2',
                title: 'èŠ‚ç‚¹1-2'
            }
        ]
    },
    {
        id: '2',
        title: 'èŠ‚ç‚¹2',
        children: [
            {
                id: '2-1',
                title: 'èŠ‚ç‚¹2-1'
            }
        ]
    }
]
```
ä¸ºäº†æ›´é€šç”¨ï¼Œå¯ä»¥ç”¨å­˜å‚¨äº†æ ‘æ ¹èŠ‚ç‚¹çš„åˆ—è¡¨è¡¨ç¤ºä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„childrenå±æ€§(å¦‚æœæœ‰)æ˜¯ä¸€é¢—å­æ ‘ï¼Œå¦‚æœæ²¡æœ‰childrenæˆ–è€…childrené•¿åº¦ä¸º0ï¼Œåˆ™è¡¨ç¤ºè¯¥æ¥å¾…ä¸ºå¶å­èŠ‚ç‚¹

### æ ‘ç»“æ„éå†æ–¹æ³•ä»‹ç»
æ ‘ç»“æ„çš„å¸¸ç”¨åœºæ™¯ä¹‹ä¸€å°±æ˜¯éå†ï¼Œè€Œéå†åˆåˆ†ä¸ºå¹¿åº¦ä¼˜å…ˆéå†ã€æ·±åº¦ä¼˜å…ˆéå†ã€‚å…¶ä¸­æ·±åº¦ä¼˜å…ˆéå†æ˜¯å¯é€’å½’çš„ï¼Œè€Œå¹¿åº¦ä¼˜å…ˆéå†æ˜¯éé€’å½’çš„ï¼Œé€šå¸¸ç”¨å¾ªç¯æ¥å®ç°ã€‚æ·±åº¦ä¼˜å…ˆéå†åˆåˆ†ä¸ºå…ˆåºéå†ã€ååºéå†ï¼ŒäºŒå‰æ ‘è¿˜æœ‰ä¸­åºéå†ï¼Œå®ç°æ–¹æ³•å¯ä»¥æ˜¯é€’å½’ï¼Œä¹Ÿå¯ä»¥æ˜¯å¾ªç¯

![æ ‘ç»“æ„éå†](./images/6030327db6d84c6cb88fd96b462bd9f6.jpg)

å¹¿åº¦ä¼˜å…ˆå’Œæ·±åº¦ä¼˜å…ˆçš„æ¦‚å¿µå¾ˆç®€å•ï¼ŒåŒºåˆ«å¦‚ä¸‹
- æ·±åº¦ä¼˜å…ˆï¼Œè®¿é—®å®Œä¸€ä¸ªå­æ ‘åœ¨è®¿é—®åé¢çš„å­æ ‘ï¼Œè€Œè®¿é—®å­æ ‘çš„æ—¶å€™ï¼Œå…ˆè®¿é—®æ ¹åœ¨è®¿é—®æ ¹çš„å­æ ‘ï¼Œæˆä¸ºå…ˆåºéå†ï¼›å…ˆè®¿é—®å­æ ‘åœ¨è®¿é—®æ ¹ï¼Œæˆä¸ºååºéå†
- å¹¿åº¦ä¼˜å…ˆï¼Œå³è®¿é—®æ ‘ç»“æ„çš„ç¬¬N+1å±‚å‰å¿…é¡»å…ˆè®¿é—®å®Œnå±‚

### å¹¿åº¦ä¼˜å…ˆéå†çš„å®ç°
å¹¿åº¦ä¼˜å…ˆçš„æ€è·¯æ˜¯ï¼Œç»´æŠ¤ä¸€ä¸ªé˜Ÿåˆ—ï¼Œé˜Ÿåˆ—çš„åˆå§‹å€¼ä¸ºæ ‘ç»“æ„æ ¹èŠ‚ç‚¹ç»„æˆçš„åˆ—è¡¨ï¼Œé‡å¤æ‰§è¡Œä»¥ä¸‹æ­¥éª¤çŸ¥é“é˜Ÿåˆ—ä¸ºç©º
- å–å‡ºé˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œè¿›è¡Œè®¿é—®ç›¸å…³æ“ä½œï¼Œç„¶åå†å°†å…¶åä»£å…ƒç´ (å¦‚æœæœ‰)å…¨éƒ¨è¿½åŠ åˆ°é˜Ÿåˆ—æœ€å
ä¸‹é¢æ˜¯ä»£ç å®ç°ï¼Œç±»ä¼¼äºæ•°ç»„çš„forEachéå†ï¼Œæˆ‘ä»¬å°†æ•°ç»„çš„è®¿é—®æ“ä½œäº¤ç»™è°ƒç”¨è€…è‡ªå®šä¹‰ï¼Œå³ä¸€ä¸ªå›è°ƒå‡½æ•°
```js
// å¹¿åº¦ä¼˜å…ˆ
function treeForeach(tree, func) {
    let node, list = [...tree];
    while(node = list.shift()) {
        func(node);
        node.children && list.push(...node.children);
    }
}
```
å¾ˆç®€å•å§ ğŸ˜

ç”¨ä¸Šè¿°æ•°æ®æµ‹è¯•ä¸€ä¸‹çœ‹çœ‹
```js
treeForeach(tree, node => console.log(node.title))

èŠ‚ç‚¹1
èŠ‚ç‚¹2
èŠ‚ç‚¹1-1
èŠ‚ç‚¹1-2
èŠ‚ç‚¹2-1
```
### æ·±åº¦ä¼˜å…ˆçš„é€’å½’å®ç°
å…ˆåºéå†ï¼Œä¸‰äº”è¡Œä»£ç 
```js
function treeForeach(tree, func) {
    tree.forEach(data => {
        func(data);
        data.children && treeForeach(data.children, func); // éå†å­æ ‘
    })
}
```
ååºéå†ï¼Œä¸å…ˆåºéå†æ€æƒ³ä¸€è‡´ï¼Œä»£ç ä¹Ÿæå…¶ç›¸ä¼¼ï¼Œåªä¸è¿‡è°ƒæ¢ä¸€ä¸‹èŠ‚ç‚¹éå†å’Œå­æ ‘éå†çš„é¡ºåº
```js
function treeForeach(tree, func) {
    tree.forEach(data => {
        data.children && treeForeach(data.children, func); // éå†å­æ ‘
        func(data);
    })
}
```
æµ‹è¯•
```js
treeForeach(tree, node => console.log(node.title))
```
è¾“å‡º
```js
// å…ˆåºéå†
> èŠ‚ç‚¹1
> èŠ‚ç‚¹1-1
> èŠ‚ç‚¹1-2
> èŠ‚ç‚¹2
> èŠ‚ç‚¹2-1

// ååºéå†
> èŠ‚ç‚¹1-1
> èŠ‚ç‚¹1-2
> èŠ‚ç‚¹1
> èŠ‚ç‚¹2-1
> èŠ‚ç‚¹2
```
### æ·±åº¦ä¼˜å…ˆå¾ªç¯å®ç°
å…ˆåºéå†ä¸å¹¿åº¦ä¼˜å…ˆå®ç°ç±»ä¼¼ï¼Œè¦ç»´æŠ¤ä¸€ä¸ªé˜Ÿåˆ—ï¼Œä¸åŒçš„æ˜¯å­èŠ‚ç‚¹ä¸è¿½åŠ åˆ°é˜Ÿåˆ—æœ€åï¼Œè€Œæ˜¯åŠ åˆ°é˜Ÿåˆ—æœ€å‰é¢
```js
function treeForeach(tree, func) {
    let node, list = [...tree];
    while(node = list.shift()) {
        func(node);;
        node.children && list.unshift(...node.children);
    }
}
```
ååºéå†å°±ç•¥å¾®å¤æ‚ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ä¸æ–­å°†å­æ ‘æ‰©å±•åˆ°æ ¹èŠ‚ç‚¹å‰é¢å»ï¼Œ(è‰°éš¾çš„)æ‰§è¡Œåˆ—è¡¨éå†ï¼Œéå†åˆ°æŸä¸ªèŠ‚ç‚¹å¦‚æœå®ƒæ²¡æœ‰å­èŠ‚ç‚¹æˆ–è€…å®ƒçš„å­èŠ‚ç‚¹å·²ç»æ‰©å±•åˆ°å®ƒå‰é¢äº†ï¼Œåˆ™æ‰§è¡Œè®¿é—®æ“ä½œï¼Œå¦åˆ™æ‰©å±•å­èŠ‚ç‚¹åˆ°å½“å‰èŠ‚ç‚¹å‰é¢
```js
function treeForeach(tree, func) {
    let node, list = [...tree], i = 0;
    while (node = list[i]) {
        let childCount = node.children ? node.children.length : 0;
        if (!childCount || node.children[childCount - 1] === list[i - 1]) {
            func(node);
            i++;
        } else {
            list.splice(i, 0, ...node.children);
        }
    }
}
```
## åˆ—è¡¨å’Œæ ‘ç»“æ„ç›¸äº’è½¬æ¢
### åˆ—è¡¨è½¬ä¸ºæ ‘
åˆ—è¡¨ç»“æ„é€šå¸¸æ˜¯åœ¨èŠ‚ç‚¹ä¿¡æ¯ä¸­ç»™å®šäº†çˆ¶çº§å…ƒç´ çš„idï¼Œç„¶åé€šè¿‡è¿™ä¸ªä¾èµ–å…³ç³»å°†åˆ—è¡¨è½¬æ¢ä¸ºæ ‘å½¢ç»“æ„ï¼Œåˆ—è¡¨ç»“æ„ç±»ä¼¼äº
```js
let list = [
  {
    id: '1',
    title: 'èŠ‚ç‚¹1',
    parentId: '',
  },
  {
    id: '1-1',
    title: 'èŠ‚ç‚¹1-1',
    parentId: '1'
  },
  {
    id: '1-2',
    title: 'èŠ‚ç‚¹1-2',
	  parentId: '1'
  },
  {
    id: '2',
    title: 'èŠ‚ç‚¹2',
    parentId: ''
  },
  {
    id: '2-1',
    title: 'èŠ‚ç‚¹2-1',
  	parentId: '2'
  }
]
```
åˆ—è¡¨ç»“æ„è½¬ä¸ºæ ‘ç»“æ„ï¼Œå°±æ˜¯æŠŠæ‰€æœ‰éæ ¹èŠ‚ç‚¹æ”¾åˆ°å¯¹åº”çˆ¶èŠ‚ç‚¹çš„childrenæ•°ç»„ä¸­ï¼Œç„¶åæŠŠæ ¹èŠ‚ç‚¹æå–å‡ºæ¥
```js
function listToTree(list) {
    let info = list.reduce((map, node) => {
        map[node.id] = node;
        node.children = [];
        return map;
    }, {});
    return list.filter(node => {
        info[node.parentId] && info[node.parentId].children.push(node);
        return !node.parentId;
    })
}
```
è¿™é‡Œé¦–å…ˆé€šè¿‡iinfoå»ºç«‹äº†id=>nodeçš„æ˜ å°„ï¼Œå› ä¸ºå¯¹è±¡å–å€¼çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(1),è¿™æ ·åœ¨æ¥ä¸‹æ¥çš„æ‰¾å¯»çˆ¶å…ƒç´ å°±ä¸éœ€è¦å†å»éå†ä¸€æ¬¡listï¼Œå› ä¸ºéå†å¯»æ‰¾çˆ¶å…ƒç´ æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ï¼Œå¹¶ä¸”åœ¨å¾ªç¯ä¸­éå†ï¼Œåˆ™æ€»ä½“æ—¶é—´å¤æ‚åº¦ä¼šå˜æˆO(n^2),è€Œä¸Šè¿°å®ç°çš„æ€»ä½“å¤æ‚åº¦æ˜¯O(n)ï¼›

### æ ‘ç»“æ„è½¬åˆ—è¡¨ç»“æ„
æœ‰äº†éå†æ ‘çš„ç»éªŒï¼Œæ ‘ç»“æ„è½¬ä¸ºåˆ—è¡¨ç»“æ„å°±å¾ˆç®€å•äº†ã€‚ä¸è¿‡æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›è½¬å‡ºæ¥çš„åˆ—è¡¨æŒ‰ç…§ç›®å½•å±•ç¤ºä¸€æ ·çš„é¡ºåˆ©æ”¾åˆ°ä¸€ä¸ªåˆ—è¡¨é‡Œï¼Œå¹¶ä¸”åŒ…å«å±‚çº§ä¿¡æ¯ã€‚ä½¿ç”¨å…ˆåºéå†å°†æ ‘ç»“æ„è½¬ä¸ºåˆ—è¡¨ç»“æ„æ˜¯åˆé€‚çš„
```js
// é€’å½’å®ç°
function treeToList(tree, result = [], level = 0) {
    tree.forEach(node => {
        result.push(node);
        node.level = level + 1;
        node.children && treeToList(node.children, result, level + 1);
    })
    return result;
}
// å¾ªç¯å®ç°
function treeToList(tree) {
    let node, result = tree.map(node => (node.level = 1, node));
    for (let i = 0; i < result.length; i++) {
        if (!result[i].children) continue;
        let list = result[i].children.map(node => (node.level = result[i].level + 1; node));
        result.splice(i + 1, i, ...list)
    }
    return result
}
```
## æ ‘ç»“æ„ç­›é€‰
æ ‘ç»“æ„è¿‡æ»¤å³ä¿ç•™æŸäº›ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹ï¼Œå‰ªè£æ‰å…¶ä»–èŠ‚ç‚¹ã€‚ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦ä¿ç•™åœ¨è¿‡æ»¤åçš„æ ‘ç»“æ„ä¸­ï¼Œå–å†³äºå®ƒä»¥åŠåä»£èŠ‚ç‚¹ä¸­æ˜¯å¦æœ‰ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹ã€‚å¯ä»¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°æè¿°ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹
```js
function treeFilter(tree, func) {
    // ä½¿ç”¨mapå¤åˆ¶ä¸€ä¸‹èŠ‚ç‚¹ï¼Œé¿å…ä¿®æ”¹åˆ°åŸæ ‘
    return tree.map(node => ({...node})).filter(node => {
        node.children = node.children && treeFilter(node.children, func);
        return func(node) || (node.children && node.children.length)
    })
}
```
## æ ‘ç»“æ„æŸ¥æ‰¾
### æŸ¥æ‰¾èŠ‚ç‚¹
æŸ¥æ‰¾èŠ‚ç‚¹å…¶å®å°±æ˜¯ä¸€ä¸ªéå†è¿‡ç¨‹ï¼Œéå†åˆ°æ»¡è¶³æ¡ä»¶çš„èŠ‚ç‚¹åˆ™è¿”å›ï¼Œéå†å®Œæˆæœªæ‰¾åˆ°åˆ™è¿”å›nullã€‚ç±»ä¼¼æ•°ç»„çš„findæ–¹æ³•ï¼Œä¼ å…¥ä¸€ä¸ªå‡½æ•°ç”¨äºåˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦ç¬¦åˆæ¡ä»¶ï¼Œä»£ç å¦‚ä¸‹
```js
function treeFind(tree, func) {
    for (const data of tree) {
        if (func(data)) return data;
        if (data.children) {
            const res = treeFind(data.children, func);
            if (res) return res;
        }
    } 
    return null;
}
```
### æŸ¥æ‰¾èŠ‚ç‚¹è·¯å¾„
ç•¥å¾®å¤æ‚ä¸€ç‚¹ï¼Œå› ä¸ºä¸çŸ¥é“ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹åœ¨å“ªä¸ªå­æ ‘ï¼Œéœ€è¦ç”¨åˆ°å›æº¯æ³•çš„æ€æƒ³ã€‚æŸ¥æ‰¾é¢†è¦ä½¿ç”¨å…ˆåºéå†ï¼Œç»´æŠ¤ä¸€ä¸ªé˜Ÿåˆ—å­˜å‚¨è·¯å¾„ä¸Šæ¯ä¸ªèŠ‚ç‚¹çš„idï¼Œå‡è®¾èŠ‚ç‚¹å°±åœ¨å½“å‰åˆ†æ”¯ï¼Œå¦‚æœå½“å‰åˆ†æ”¯å·®ä¸å¤šï¼Œå›æº¯
```js
function treeFindPath(tree, func, path = []) {
    if (!tree) return [];
    for (const data of tree) {
        path.push(data.id);
        if (func(data)) return path;
        if (data.children) {
            const findChildren = treeFindPath(data.children, func, path);
            if (findChildren.length) return findChildren;
        }
        path.pop();
    }
    return [];
}
```
ç”¨ä¸Šé¢çš„æ ‘ç»“æ„æµ‹è¯•
```js
let result = treeFindPath(tree, node => node.id === '2-1');
console.log(result);
// è¾“å‡º
['2', '2-1']
```
### æŸ¥æ‰¾å¤šæ¡èŠ‚ç‚¹è·¯å¾„
æ€è·¯å’ŒæŸ¥æ‰¾è·¯å¾„ç±»ä¼¼ï¼Œä¸è¿‡ä»£ç å´æ›´åŠ ç®€å•
```js
function treeFindPath(tree, func, path = [], result = []) {
    for (const data of tree) {
        path.push(data.id);
        func(data) && result.push([...path]);
        data.children && treeFindPath(data.children, func, path, result);
        path.pop()
    }
    return result;
}
```

## ç»“è®º
å¯¹äºæ ‘ç»“æ„çš„æ“ä½œï¼Œå…¶å®é€’å½’æ˜¯æœ€åŸºç¡€çš„ï¼Œä¹Ÿæ˜¯æœ€å®¹æ˜“ç†è§£çš„ã€‚é€’å½’æœ¬èº«å°±æ˜¯å¾ªç¯æ€æƒ³ï¼Œæ‰€ä»¥å¯ä»¥ç”¨å¾ªç¯æ¥æ”¹å†™é€’å½’ã€‚ç†Ÿç»ƒæŒæ¡æ ‘ç»“æ„çš„æŸ¥æ‰¾ã€éå†ï¼Œå¯¹åº”æ—¥å¸¸éœ€æ±‚åº”è¯¥ç»°ç»°æœ‰ä½™

## å‚è€ƒ
[JSæ ‘ç»“æ„æ“ä½œ:æŸ¥æ‰¾ã€éå†ã€ç­›é€‰ã€æ ‘ç»“æ„å’Œåˆ—è¡¨ç»“æ„ç›¸äº’è½¬æ¢](https://www.cnblogs.com/ming1025/p/13677512.html)