(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{1277:function(t,s,a){t.exports=a.p+"assets/img/4394d7e6c30c420092df6c2624c1e4d4_tplv-k3u1fbpfcp-zoom-in-crop-mark_4536_0_0_0.a5defc11.png"},1278:function(t,s,a){t.exports=a.p+"assets/img/bdd7aab8ea584f198c9c1368cad22ef3_tplv-k3u1fbpfcp-zoom-in-crop-mark_4536_0_0_0.3e0afe97.png"},1279:function(t,s,a){t.exports=a.p+"assets/img/dbcfc3397dd74f39a356198910f468de_tplv-k3u1fbpfcp-zoom-in-crop-mark_4536_0_0_0.fb6c303f.png"},1280:function(t,s,a){t.exports=a.p+"assets/img/043287a6029f4aee8207374266a908f9_tplv-k3u1fbpfcp-zoom-in-crop-mark_4536_0_0_0.568d6171.png"},1281:function(t,s,a){t.exports=a.p+"assets/img/0481bec9fd0241e4aff32213f46e529b_tplv-k3u1fbpfcp-zoom-in-crop-mark_4536_0_0_0.373cac3e.png"},1282:function(t,s,a){t.exports=a.p+"assets/img/a475d6387daf4741a27a58808f0e2ba1_tplv-k3u1fbpfcp-zoom-in-crop-mark_4536_0_0_0.06c84e93.png"},2560:function(t,s,a){"use strict";a.r(s);var n=a(46),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("p",[n("img",{attrs:{src:a(1277),alt:"ts"}})]),t._v(" "),n("h2",{attrs:{id:"前置知识"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前置知识"}},[t._v("#")]),t._v(" 前置知识")]),t._v(" "),n("h3",{attrs:{id:"_1-1typescript是什么"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1typescript是什么"}},[t._v("#")]),t._v(" 1.1TypeScript是什么？")]),t._v(" "),n("p",[n("a",{attrs:{href:"www.typescriptlang.org"}},[t._v("TypeScript 官网")])]),t._v(" "),n("p",[n("strong",[t._v("TypeScript是一种基于JavaScript的强类型编程语言，它使得在前端项目开发过程中更加严谨且流畅，一定程度上保证了大型前端项目程序的健壮性")]),t._v("。")]),t._v(" "),n("ul",[n("li",[t._v("TypeScript是由微软开发的一款开源的编程语言")]),t._v(" "),n("li",[t._v("TypeScript是Javascript的超集，遵循最新的ESM规范，TypeScript扩展了Javascript的语法")]),t._v(" "),n("li",[t._v("TypeScript更像后端Java、C#这样面向对象语言，可以让JS开发大型企业级项目")])]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[t._v('但是TypeScript并不可以直接运行，而是需要转换成Javascript代码才可以在Node.js或浏览器环境下执行，因此我们需要通过"编译器"将TS代码转换为JS代码')])]),t._v(" "),n("h3",{attrs:{id:"_1-2什么是tsc"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2什么是tsc"}},[t._v("#")]),t._v(" 1.2什么是tsc")]),t._v(" "),n("p",[t._v("tsc的全称是Typescript Compiler,也就是将TypeScript转码为Javascript代码的编译器")]),t._v(" "),n("p",[t._v("tsc的全局安装方式")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("npm install typescript "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("g\n")])])]),n("p",[t._v("当我们编译一份index.ts文件时，会使用下面的命令")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("tsc "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("index"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ts\n")])])]),n("p",[t._v("这样就可以得到一份编译成为Javascript代码的 ./index.js文件")]),t._v(" "),n("p",[n("span",{staticStyle:{color:"blue"}},[t._v("tsc实际上就是将TS转为JS的编译(器)脚手架工具，如果是一个TS的前端工程项目，那么就可以通过项目中的tsconfig.json文件来自定义配置TS编译的相关规则")])]),t._v(" "),n("p",[t._v("项目中的tsconfig.json文件，我们一般会通过如下快捷命令生成")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("tsc "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("init\n")])])]),n("p",[t._v("执行完后，会在项目根目录生成一个简单的初始化tsconfig.json配置描述文件，如果没有特别的要求，该初始化配置就足以支持你愉快的使用TS开发了")]),t._v(" "),n("p",[t._v("更多的相关TS编译配置和使用说明可以通过tsc -h查看")]),t._v(" "),n("h3",{attrs:{id:"_1-3tsconfig-json文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3tsconfig-json文件"}},[t._v("#")]),t._v(" 1.3tsconfig.json文件")]),t._v(" "),n("p",[t._v("tsconfig.json 文件是用于描述将 TypeScript 转为 JavaScript 代码的配置文件。")]),t._v(" "),n("p",[t._v("IDE（代码编辑器）将会根据 tsconfig.json 文件来对当前项目中支持不同程度的类型约束，同时也是对 TSC 编译 TypeScript 代码过程做一些预定义、约束入口和编译输出目录等配置。")]),t._v(" "),n("p",[t._v("因此对于一个支持 TypeScript 编程语言的工程来说，tsconfig.json 文件就是编码的基础。")]),t._v(" "),n("h2",{attrs:{id:"tsconfig-json-配置详解"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tsconfig-json-配置详解"}},[t._v("#")]),t._v(" tsconfig.json 配置详解")]),t._v(" "),n("h2",{attrs:{id:"tsconfig-json-全解析"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tsconfig-json-全解析"}},[t._v("#")]),t._v(" tsconfig.json 全解析")]),t._v(" "),n("p",[t._v("上面针对 tsconfig.json 中一些常见配置做了详细解释，将一些不常用的配置字段组合在一起，做一个 Checklist 如下：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"compilerOptions"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 基本选项 */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"target"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"es6"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定 ECMAScript 目标版本: 'ES3' (default), 'ES5', 'ES2015', 'ES2016', 'ES2017', or 'ESNEXT'")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"module"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"commonjs"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定使用模块: 'commonjs', 'amd', 'system', 'umd' or 'es2015'")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lib"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定要包含在编译中的库文件")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"allowJs"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 允许编译 javascript 文件")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"checkJs"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 报告 javascript 文件中的错误")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jsx"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"preserve"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定 jsx 代码的生成: 'preserve', 'react-native', or 'react'")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"declaration"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 生成相应的 '.d.ts' 文件")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"declarationDir"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./dist/types"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 生成的 '.d.ts' 文件保存文件夹")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sourceMap"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 生成相应的 '.map' 文件")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"outFile"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将输出文件合并为一个文件")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"outDir"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./dist"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定输出目录")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rootDir"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用来控制输出目录结构 --outDir.")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"removeComments"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 删除编译后的所有的注释")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"noEmit"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不生成输出文件")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"importHelpers"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 从 tslib 导入辅助工具函数")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"isolatedModules"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将每个文件做为单独的模块 （与 'ts.transpileModule' 类似）.")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 严格的类型检查选项 */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"strict"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 启用所有严格类型检查选项")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"noImplicitAny"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在表达式和声明上有隐含的 any类型时报错")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"strictNullChecks"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 启用严格的 null 检查")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"noImplicitThis"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当 this 表达式值为 any 类型的时候，生成一个错误")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"alwaysStrict"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 以严格模式检查每个模块，并在每个文件里加入 'use strict'")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 额外的检查 */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"noUnusedLocals"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 有未使用的变量时，抛出错误")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"noUnusedParameters"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 有未使用的参数时，抛出错误")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"noImplicitReturns"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 并不是所有函数里的代码都有返回值时，抛出错误")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"noFallthroughCasesInSwitch"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 报告switch语句的fallthrough错误。（即，不允许switch的case语句贯穿）")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 模块解析选项 */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"moduleResolution"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 选择模块解析策略： 'node' (Node.js) or 'classic' (TypeScript pre-1.6)")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"baseUrl"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用于解析非相对模块名称的基础目录")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"paths"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 模块名到基于 baseUrl 的路径映射的列表")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rootDirs"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 根文件夹列表，其组合内容表示项目运行时的结构内容")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"typeRoots"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 包含类型声明的文件列表")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"types"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 需要包含的类型声明文件名列表")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"allowSyntheticDefaultImports"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 允许从没有设置默认导出的模块中默认导入。")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"esModuleInterop"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 支持合成模块的默认导入")]),t._v("\n  \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Source Map Options */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sourceRoot"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定调试器应该找到 TypeScript 文件而不是源文件的位置")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mapRoot"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定调试器应该找到映射文件而不是生成文件的位置")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"inlineSourceMap"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 生成单个 soucemaps 文件，而不是将 sourcemaps 生成不同的文件")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"inlineSources"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将代码与 sourcemaps 生成到一个文件中，要求同时设置了 --inlineSourceMap 或 --sourceMap 属性")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 其他选项 */")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"experimentalDecorators"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 启用装饰器")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"emitDecoratorMetadata"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 为装饰器提供元数据的支持")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 指定编译文件或排除指定编译文件 */")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"include"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"src/**/*"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"exclude"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node_modules"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"**/*.spec.ts"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"files"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"index.ts"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test.ts"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 从另一个配置文件里继承配置")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"extends"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@tsconfig/recommended"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 让 IDE 在保存文件的时候根据 tsconfig.json 重新生成文件")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"compileOnSave"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 支持这个特性需要Visual Studio 2015， TypeScript 1.8.4 以上并且安装 atom-typescript 插件")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h2",{attrs:{id:"打包工具中的typescript"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#打包工具中的typescript"}},[t._v("#")]),t._v(" 打包工具中的TypeScript")]),t._v(" "),n("p",[t._v("前文讲到了为什么不推荐直接使用TSC作为项目的打包编译工具，那么接下来就简单看看在常见的几款打包工具中针对TypeScript的编译方案是如何设计的？")]),t._v(" "),n("h3",{attrs:{id:"_4-1rollup-typescript"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-1rollup-typescript"}},[t._v("#")]),t._v(" 4.1Rollup + TypeScript")]),t._v(" "),n("p",[t._v("在Rollup打包中，我们一般只需要添加"),n("a",{attrs:{href:"https://github.com/rollup/plugins/tree/master/packages/typescript/#readme",target:"_blank",rel:"noopener noreferrer"}},[t._v("@rollup/plugin-typescript"),n("OutboundLink")],1),t._v("插件即可，该插件会默认读取项目根目录下的tsconfig.json配置文件")]),t._v(" "),n("p",[t._v("Rollup的配置就像这样:")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// file: rollup.config.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" typescript "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@rollup/plugin-typescript'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    input"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'src/index.ts'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    output"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        dir"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'output'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        format"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cjs'")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    plugins"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("typescript")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("结合其源码:\n"),n("img",{attrs:{src:a(1278),alt:"rollup + typesceipt"}})]),t._v(" "),n("p",[t._v("因为typescript声明了是peerDependencies，因此会采用项目中安装的typescript版本，即是使用我们项目中的TS编译器。")]),t._v(" "),n("p",[t._v("通过阅读@rollup/plugin-typescript源码，可以看到该插件会模式使我们自己项目中的tsconfig.json文件作为TSC编译的配置，但是会做一些配置预设覆盖：")]),t._v(" "),n("p",[t._v("会调用ts.parseJsonConfigFileContent()方法，将 FORCED_COMPILER_OPTIONS 值 merge 到用户的自定义配置中。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1279),alt:"merge config"}})]),t._v(" "),n("p",[t._v("通过英语解释看到，因为需要TSC编译获得JS产物，所以会将noEmit设置为false，也就是TSC编译会输出文件，但为什么我们在输出目录中没有看到对应的TSC产物？")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1280),alt:"存储结果到Map对象中(内存中)"}})]),t._v(" "),n("p",[t._v("但是如果开启了declaration,则会将TSC解析得到的*.d.ts文件输出到指定目录")]),t._v(" "),n("h3",{attrs:{id:"_4-2webpack-typescript"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2webpack-typescript"}},[t._v("#")]),t._v(" 4.2Webpack+TypeScript")]),t._v(" "),n("p",[t._v("在"),n("a",{attrs:{href:"https://webpack.docschina.org/guides/typescript/",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack中的TypeScript"),n("OutboundLink")],1),t._v("官方文档中，指明了需要安装:typescript和ts-loader两个模块")]),t._v(" "),n("p",[t._v("配置webpack并支持TypeScript的配置如下")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// file: webpack.config.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    entry"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./src/index.ts'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    module"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        rules"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                test"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.tsx?$")]),n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                use"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ts-loader'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                exclude"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("node_modules")]),n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    resolve"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        extensions"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.tsx'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.ts'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    output"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bundle.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        path"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dist'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("可以看出Webpack主要依赖ts-loader实现对TypeScrpt语法的编译支持，在看看对Ts-loader的介绍")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1281),alt:"ts-loader"}})]),t._v(" "),n("p",[t._v("换句话说，ts-loader实际调用了TSC来编译TS文件，TSC的配置依赖于你项目中的tsconfig.json文件。")]),t._v(" "),n("p",[t._v("如果使用了Babel，则可以使用"),n("a",{attrs:{href:"https://babeljs.io/docs/en/babel-preset-typescript",target:"_blank",rel:"noopener noreferrer"}},[t._v("@babel/preset-typescript"),n("OutboundLink")],1),t._v("来处理，但Bbel不会做TS类型校验，在打包工具Rollup和webpack中都可以引入babel，那么接下来看看Babel如何处理typescript的吧")]),t._v(" "),n("h3",{attrs:{id:"_4-3-babel-typescript"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-babel-typescript"}},[t._v("#")]),t._v(" 4.3 Babel+ TypeScript")]),t._v(" "),n("p",[t._v("Babel处理TS需要安装@babel/preset-typescript模块，然后在babel项目配置文件中声明")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置说明https://babeljs.io/docs/en/babel-preset-typescript")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"presets"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@babel/preset-typescript"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("但Babel中只会对TS代码转为JS代码(通过parse TS文件为AST,并直接移除类型，然后打印目标代码)，不会去做TS类型检查，所以Babel编译TS文件相较于TSC的速度更快！")]),t._v(" "),n("p",[t._v("同时，因为Babel会根据不同的兼容环境，按需引入pollyfill，比TSC直接引入core-js更优雅，因此使用了Babel打包的体积更小")]),t._v(" "),n("p",[t._v("TS类型检查工作可以交给代码编译器承担，当然同事可以新增TS检查的命令")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//package.json")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"script"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tsCheck"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tsc --noEmit"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("可以把类型检查放到待定的npm scripts声明周期之前，另外其实也可以将类型检查放到git commit阶段，用于做必要的TS类型检查，保证项目的正确性")]),t._v(" "),n("h3",{attrs:{id:"_4-4-esbuild-typescript"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-esbuild-typescript"}},[t._v("#")]),t._v(" 4.4 ESbuild + TypeScript")]),t._v(" "),n("p",[t._v("通过Vite体会到了ESbuild带来的开发热更新『极速』体验，针对TS项目，ESbuild和Babel是相同的编译策略，即"),n("span",{staticStyle:{color:"red"}},[t._v("仅编译，不校验类型")])]),t._v(" "),n("blockquote",[n("p",[t._v("Vite使用esbuild将TypeScript转译到Javascript,约是tsc速度的20~30倍，同时HMR更新反映到浏览器的时间小宇50ms---Vite docs")])]),t._v(" "),n("p",[t._v("但在 ESbuild 中需要启用 tsconfig 中的 isolatedModules 功能，然后在类型引入的时候需要替换，规则参考如下：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// old")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" UserType "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./types'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// new")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" type "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" UserType "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./types'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("因为 ESbuild 是单独编译每个文件，无法判断引入的是 Type（类型） 还是 值，所以需要开发者显示地声明是“Type”。")]),t._v(" "),n("p",[t._v("同时还需要启用 esModuleInterop 功能，用于支持 ESM 模块合成默认导入，以兼容 CJS 和 ESM 规范。")]),t._v(" "),n("p",[t._v("另外 ESbuild 不支持：emitDecoratorMetadat、const enum 类型和 *.d.ts 文件")]),t._v(" "),n("p",[t._v("此外，关注到兼容性处理这方面，Bable 和 ESbuild 是类似的，因此会存在兼容性问题")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1282),alt:"兼容性"}})]),t._v(" "),n("p",[t._v("对于装饰器处理不支持，因为 TS 是 JS 的超集，ESnext 的规范提案某些还不是稳定的，因此如果有这方面诉求的项目，可以借助 TSC 做预编译，例如使用 Rollup 的 typescript 插件 或 Webpack 的 ts-loader 方式。")]),t._v(" "),n("h2",{attrs:{id:"总结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),n("p",[t._v("针对 TypeScript 项目的类型检查和编译流程算是完整过了一遍，相信已足以支撑大家在工作中自定义化配置 TS 前端项目！")]),t._v(" "),n("p",[t._v("另外，tsconfig.json 推荐配置策略如下：")]),t._v(" "),n("ol",[n("li",[n("span",{staticStyle:{color:"blue"}},[t._v("借助 extends 字段，并结合项目应用场景，继承官方推荐配置")])]),t._v(" "),n("li",[n("span",{staticStyle:{color:"blue"}},[t._v("针对项目特点，按需修改对应功能配置")])]),t._v(" "),n("li",[n("span",{staticStyle:{color:"blue"}},[t._v("建议启用 importHelpers、esModuleInterop，取消 noEmit 输出")])]),t._v(" "),n("li",[n("span",{staticStyle:{color:"blue"}},[t._v("TS 项目的打包构建，推荐使用 Webpack、Rollup、Bable 等专业工具来保证正确性和构建优化")])])]),t._v(" "),n("h2",{attrs:{id:"资料"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#资料"}},[t._v("#")]),t._v(" 资料")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/7039583726375796749",target:"_blank",rel:"noopener noreferrer"}},[t._v("TypeScript 但你真的会 TS 编译配置"),n("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);