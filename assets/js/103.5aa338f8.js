(window.webpackJsonp=window.webpackJsonp||[]).push([[103],{1884:function(t,s,a){t.exports=a.p+"assets/img/9af6a68af1804b499a5c14273405319b_tplv-k3u1fbpfcp-zoom-in-crop-mark_4536_0_0_0.ffb0c845.png"},1885:function(t,s,a){t.exports=a.p+"assets/img/6009534122ef4cfe99f8db3188d9e5a5_tplv-k3u1fbpfcp-zoom-in-crop-mark_4536_0_0_0.d0eec864.gif"},1886:function(t,s,a){t.exports=a.p+"assets/img/cfeedc6eb44b4dce9c5d1c174f35910e_tplv-k3u1fbpfcp-zoom-in-crop-mark_4536_0_0_0.0b964c1d.gif"},1887:function(t,s){t.exports="data:image/png;base64,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"},1888:function(t,s){t.exports="data:image/png;base64,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"},1889:function(t,s,a){t.exports=a.p+"assets/img/2952cccf0f414e3bae38e939016b04ab_tplv-k3u1fbpfcp-zoom-in-crop-mark_4536_0_0_0.006059ab.png"},2823:function(t,s,a){"use strict";a.r(s);var n=a(46),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"文章导图"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#文章导图"}},[t._v("#")]),t._v(" 文章导图")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1884),alt:"导图"}})]),t._v(" "),n("h2",{attrs:{id:"前端框架"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前端框架"}},[t._v("#")]),t._v(" 前端框架")]),t._v(" "),n("h3",{attrs:{id:"vue"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue"}},[t._v("#")]),t._v(" Vue")]),t._v(" "),n("h4",{attrs:{id:"手写minni版的mvvm框架"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#手写minni版的mvvm框架"}},[t._v("#")]),t._v(" 手写minni版的MVVM框架")]),t._v(" "),n("p",[t._v("实现效果：2s后修改姓名和年龄这两个值，页面响应式更新渲染\n"),n("img",{attrs:{src:a(1885),alt:"效果"}})]),t._v(" "),n("h5",{attrs:{id:"实现流程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实现流程"}},[t._v("#")]),t._v(" 实现流程")]),t._v(" "),n("ol",[n("li",[t._v("实现 observer函数，利用Object.defineProperty把data中的属性变成响应式的，同时给每一个属性添加一个dep对象(用来存储对应的watcher观察者)")]),t._v(" "),n("li",[t._v("定义compile函数，模板编译，遍历DOM，遇到mustache(双大括号{{}})形式的文本，则替换成data.key对应的值，同时将该dom节点添加到对应key值的dep对象中")]),t._v(" "),n("li",[t._v("当data的数据变化时，调用dep对象的update方法，更新所有观察者中的dom节点")])]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token doctype"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<!")]),n("span",{pre:!0,attrs:{class:"token doctype-tag"}},[t._v("doctype")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token name"}},[t._v("html")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("charset")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("UTF-8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("title")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("vue的mvvm简单实现"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("title")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("姓名: "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("span")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("{{name}}"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("span")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("年龄: "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("span")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("{{age}}"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("span")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token script"}},[n("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\nwindow"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onload")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// new一个vue实例")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" vue "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        el"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#app'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        data"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            name"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'加载中'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            age"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'18'")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2s后更新页面信息")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 修改vue中$data的name和age属性")]),t._v("\n        vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'小明'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("options")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("options "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$data "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("compile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelector")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 监听data中属性变化")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("keys")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 给data中的每一个属性添加一个dep对象(改对象用来存储对应的watcher观察者)")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" observer "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Dep")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 利用闭包 获取和设置属性的时候，操作的都是value")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" value "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProperty")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 观察者对象添加对应的dom节点")]),t._v("\n                    Dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" observer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newValue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    value "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newValue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 属性变化时，更新观察者中的所有节点")]),t._v("\n                    observer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newValue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("compile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("dom")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        dom"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("childNodes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("child")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// nodeType为3时是文本节点，并且该节点的内容包含`mustache`(双括号)")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nodeType "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\{\\{(.*)\\}\\}")]),n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// RegExp.$1是正则表达式匹配的第一个字符串，这里对应的就是data的key值")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" key "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" RegExp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("trim")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将该节点添加到对应的观察者对象中，在下面的this.options.data[key]中触发get方法")]),t._v("\n                Dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将{{key}}替换成data中对应的值")]),t._v("\n                child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("{{")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("}}")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                Dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 递归遍历子节点")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("childNodes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("compile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// dep对象存储所有的观察者")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Dep")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("watcherList "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 添加watcher")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("node")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("watcherList"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("node"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 更新watcher")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("watcherList"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("node")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            node"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6844903619808985095",target:"_blank",rel:"noopener noreferrer"}},[t._v("50行代码的MVVM，感受闭包的艺术"),n("OutboundLink")],1)]),t._v(" "),n("h4",{attrs:{id:"手写v-model数据双向绑定"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#手写v-model数据双向绑定"}},[t._v("#")]),t._v(" 手写v-model数据双向绑定")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1886),alt:"v-model双向绑定"}})]),t._v(" "),n("h4",{attrs:{id:"和前文mini版mvvm框架的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#和前文mini版mvvm框架的区别"}},[t._v("#")]),t._v(" 和前文mini版MVVM框架的区别")]),t._v(" "),n("ol",[n("li",[t._v("实现v-model指令，input值改变后,页面对应的数据也会变化，实现数据的双向绑定")]),t._v(" "),n("li",[t._v("给input元素绑定input事件，当输入值变化会触发对应属性的dep.update方法，通过对应的观察者发生变化")]),t._v(" "),n("li",[t._v("增加了数据代理，通过this.info.person.name就可以直接修改$data对应的值，实现了this对this.$data的代理")]),t._v(" "),n("li",[t._v("数据劫持，对data增加了递归和设置新值的劫持，让data中每一层数据都是响应式的，如info.person.name")])]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token doctype"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<!")]),n("span",{pre:!0,attrs:{class:"token doctype-tag"}},[t._v("doctype")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token name"}},[t._v("html")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("lang")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("en"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("charset")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("UTF-8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("viewport"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http-equiv")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("X-UA-Compatible"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("ie=edge"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("title")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("vue双向绑定的简单实现"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("title")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("年龄: "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("span")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("{{info.person.name}}"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("span")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("{{job}}"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("input")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-model")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("job"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("placeholder")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("请输入工作"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("text"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token script"}},[n("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\nwindow"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onload")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// new一个vue对象")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" vm "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// el为需要挂在的dom节点")]),t._v("\n        el"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#app'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        data"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            info"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                person"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    name"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'加载中'")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            job"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'程序猿'")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("info"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("person"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'小明'")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("options")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$data "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$el "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelector")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("proxy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("compile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 模板编译")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("compile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("dom"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vm")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        Array"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dom"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("childNodes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("child")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 元素节点，匹配v-model 如input,textArea元素等")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nodeType "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                Array"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attributes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("attr")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 判断元素是否设置v-model属性")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("attr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("includes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'v-model'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        Dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("attr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        Dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 重点：给input绑定原生input事件")]),t._v("\n                        child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'input'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当input输入内容发生变化时，动态设置vm.$data[attr.value]的值")]),t._v("\n                            vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("attr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nodeType "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\{\\{(.*)\\}\\}")]),n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" key "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" RegExp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("trim")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" keyList "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("split")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" value "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$data\n                Dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" child\n\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 循环遍历，找到info.person.name对应的name值")]),t._v("\n                keyList"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("item")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    value "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                Dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n                child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("{{")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("}}")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("childNodes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 递归模板编译")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("compile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this 代理this.$data;")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vm.info.person.name 相当于 vm.$data.info.person.name")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("proxy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("$data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vm")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("keys")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProperty")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newValue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    $data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newValue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" $data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" data "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'object'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 递归进行数据劫持，使data中的每一层都是响应式")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("keys")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" value "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" dep "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Dep")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 递归")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProperty")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                Dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newValue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                value "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newValue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果新设置的值是一个对象，该对象也要变成响应式的")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newValue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newValue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Dep")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subs "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("target")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("newValue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("node")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("node"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tagName "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'INPUT'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" node"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tagName "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'TEXTAREA'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                node"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newValue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                node"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newValue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("p",[n("a",{attrs:{href:"https://github.com/xy-sea/blog/blob/dev/mini-vue/%E6%89%8B%E5%86%99v-model%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("源码"),n("OutboundLink")],1)]),t._v(" "),n("h4",{attrs:{id:"使用proxy实现数据监听"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用proxy实现数据监听"}},[t._v("#")]),t._v(" 使用proxy实现数据监听")]),t._v(" "),n("p",[t._v("vue3底层通过Proxy实现了数据监听，替代了vue2中的Object.defineProperty")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("target")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Proxy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" receiver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" result "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Reflect"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 递归获取对象多层嵌套的情况，如pro.info.type(递归监听，保证每一层返回都是proxy对象)")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("isObject")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" receiver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'length'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 解决对数组修改，重复更新视图的问题")]),t._v("\n                console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'更新视图'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Reflect"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" receiver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("isObject")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("target")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'object'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" target "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'测试'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" info"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" type"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" pro "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\npro"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("infot"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h4",{attrs:{id:"vue异步更新原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue异步更新原理"}},[t._v("#")]),t._v(" vue异步更新原理")]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[t._v("vue的数据频繁变化，但为什么dom只会更新一次")])]),t._v(" "),n("ol",[n("li",[t._v("Vue数据发生变化之后，不会立即更新dom，而是异步更新的")]),t._v(" "),n("li",[t._v("侦听到数据变化，Vue将开启一个队列，并缓存在同一事件循环中发生的所有数据变更")]),t._v(" "),n("li",[t._v("如果同一个watcher被多次触发，只会被推入队列中一次，可以避免重复修改相同的dom，这种去掉重复数据，对于避免不必要的计算和DOM操作是非常重要的")]),t._v(" "),n("li",[t._v("同步任务执行完毕，开始执行异步watcher队列任务，一次性更新DOM")])]),t._v(" "),n("p",[n("strong",[t._v("异步更新的源码实现")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 定义watcher类")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Watcher")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 放到watcher队列中，异步更新")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("queueWatcher")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 触发更新")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 队列中添加watcher")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("queueWatcher")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("watcher")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" id "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 先判断watcher是否存在，去掉重复的watcher")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("has"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        queue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        has"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("pending"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            pending "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用异步更新watcher")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextTick")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flushSchedulerQueue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" queue "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 定义watcher队列")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" has "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用对象来保存id，进行去重操作")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" pending "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果异步队列正在执行，将不会再次执行")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 执行watcher队列任务")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("flushSchedulerQueue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    queue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("watcher")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("render"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在更新之后执行对应的回调：这里是updated钩子函数")]),t._v("\n            watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("cb")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 执行完成后清空队列 充值pending状态")]),t._v("\n    queue "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    has "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    pending "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h4",{attrs:{id:"nexttick为什么要优先使用微任务实现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nexttick为什么要优先使用微任务实现"}},[t._v("#")]),t._v(" nextTick为什么要优先使用微任务实现")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("vue nextTick的源码实现，异步优先级判断，总结就是Promise > MutationObserver > setImmediate > setTimeout")])]),t._v(" "),n("li",[n("p",[t._v("优先使用Promise，因为根据event loop与浏览器更新渲染时机，宏任务->微任务->渲染更新，使用微任务，本次event loop轮训就可以获取到更新的dom")])]),t._v(" "),n("li",[n("p",[t._v("如果使用宏任务，要到下一次event loop中，才能获取到更新dom")])])]),t._v(" "),n("p",[n("strong",[t._v("nextTick的源码实现")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 定义nextTick的回调队列")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" callbacks "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 批量执行nextTick的回调队列")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("flushCallbacks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    callbacks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("cb")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("cb")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    callbacks "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    pending "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 定义异步方法，优先使用微任务实现")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" timerFunc"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 优先使用promise 微任务")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("promise"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("timerFunc")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Promise"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flushCallbacks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果不支持promise,在使用MutationObserver 微任务")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MutationObserver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" textNode "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createTextNode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" observer "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MutationObserver")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("flushCallbacks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        observer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("disconnect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" observer "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" observer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("textNode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" characterData"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    textNode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 微任务不支持，在使用宏任务实现")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("setImmediate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("timerFunc")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setImmediate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flushCallbacks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("timerFunc")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flushCallbacks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 定义nextTick方法")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextTick")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("cb")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    callbacks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("pending"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        pending "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("timerFunc")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[n("RouterLink",{attrs:{to:"/front-end/Log/performance-word.html#指标"}},[t._v("MutationObserver")])],1),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6844903843197616136",target:"_blank",rel:"noopener noreferrer"}},[t._v("你真的理解$nextTick么"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://segmentfault.com/a/1190000008589736",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue 源码详解之 nextTick：microtask 才是核心！"),n("OutboundLink")],1)]),t._v(" "),n("h4",{attrs:{id:"computed-和-watch的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#computed-和-watch的区别"}},[t._v("#")]),t._v(" computed 和 watch的区别")]),t._v(" "),n("ol",[n("li",[t._v("计算属性本质上是computed watcher,而watch本质是user watcher(用户自己定义的watcher)；")]),t._v(" "),n("li",[t._v("computed有缓存的功能，通过dirty控制")]),t._v(" "),n("li",[t._v("watcher设置deep:true,实现深度监听的功能")]),t._v(" "),n("li",[t._v("computed可以监听多个值的变化")])]),t._v(" "),n("h5",{attrs:{id:"computed原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#computed原理"}},[t._v("#")]),t._v(" computed原理")]),t._v(" "),n("ol",[n("li",[t._v("初始化计算属性时，遍历computed对象,给其中每一个计算属性分别生成唯一computed watcher，并将该watcher中的dirty设置为true\n初始化时，计算出现并不会立即计算(vue做的优化之一)，只有当获取的计算属性值才会进行对应计算")]),t._v(" "),n("li",[t._v("初始化计算属性时候，将Dep.target设置成当前的computed watcher，将computed watcher添加到所依赖data值的dep中(依赖收集过程)，然后计算computed对应的值，后将dirty改成false")]),t._v(" "),n("li",[t._v("当依赖data中的值发生变化时，调用set方法触发dep的notiry方法，将computed watcher中的dirty设置为true")]),t._v(" "),n("li",[t._v("下次获取计算属性值时，若dirty为true，重新计算属性值")]),t._v(" "),n("li",[t._v("dirty是控制缓存的关键，当所依赖的data发生变化，dirty设置为true，再次呗获取时，就会重新计算\n"),n("strong",[t._v("computed源码实现")])])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 空函数")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("noop")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// computed初始化的watcher传入lazy:true，就会触发watcher中的dirty值为true")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" computedWatcherOptions "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" lazy"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Object.defineProperty 默认value参数")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" sharedPropertyDefinition "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    enumberable"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    configurable"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    get"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" noop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    set"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" noop\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化computed")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("initComputed")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" computed")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 新建存储watcher对象，挂载在vm对象执行")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" watchers "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_computedWatchers "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 遍历computed")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" key "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" computed"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" userDef "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" computed"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// getter值为computed重key的监听函数或对象的get值")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" getter "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" userDef "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'function'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" userDef "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" userDef"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 新建computed watcher")]),t._v("\n            watchers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Watcher")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" getter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("noop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" computedWatcherOptions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 定义计算属性")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineComputed")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" userDef"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 重新定义计算属性  对get和set劫持")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 利用Object.defineProperty来对计算属性的get和set进行劫持")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineComputed")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" userDef")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果是一个函数，需要手动赋值到get上")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" userDef "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"function"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      sharedPropertyDefinition"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createComputedGetter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      sharedPropertyDefinition"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" noop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      sharedPropertyDefinition"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" userDef"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get\n        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" userDef"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cache "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createComputedGetter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" userDef"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get\n        "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" noop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果有设置set方法则直接使用，否则赋值空函数")]),t._v("\n      sharedPropertyDefinition"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" userDef"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" userDef"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" noop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProperty")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sharedPropertyDefinition"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 计算属性的getter 获取计算属性的值时会调用")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createComputedGetter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("computedGetter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取对应的计算属性watcher")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" watcher "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_computedWatchers "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_computedWatchers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// dirty为true,计算属性需要重新计算")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dirty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("evaluate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取依赖")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Dep"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("depend")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//返回计算属性的值")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" watcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("h5",{attrs:{id:"watch原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#watch原理"}},[t._v("#")]),t._v(" watch原理")]),t._v(" "),n("ol",[n("li",[t._v("遍历watch对象，给其中每一个watch属性，生成use watcher")]),t._v(" "),n("li",[t._v("调用watcher中的get方法，将Dep.target设置成当前的user watcher，并将user watcher添加到监听data值对应的dep中(依赖收集的过程)")]),t._v(" "),n("li",[t._v("当所监听data中的值发生变化时，会调用set方法触发dep的notify方法，执行watcher中定义的方法")]),t._v(" "),n("li",[t._v("设置成deep：true的情况，递归遍历所监听的对象，将user watcher添加到对象中每一层key值的dep对象中，这样武林当对象的中那一层发生变化，watcher都可以监听到。通过对象的递归遍历，实现了深度监听功能")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6844903667884097543",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue.js的computed和watch是如何工作的？"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6956407362085191717",target:"_blank",rel:"noopener noreferrer"}},[t._v("手写Vue2.0源码（十）-计算属性原理"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.bilibili.com/video/BV1YE411u7m4/?from=search&seid=14891340203736945411",target:"_blank",rel:"noopener noreferrer"}},[t._v("珠峰：史上最全最专业的Vue.js面试题训练营"),n("OutboundLink")],1)]),t._v(" "),n("h4",{attrs:{id:"vue-css-scoped"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue-css-scoped"}},[t._v("#")]),t._v(" vue css scoped")]),t._v(" "),n("h5",{attrs:{id:"css属性选择器示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#css属性选择器示例"}},[t._v("#")]),t._v(" css属性选择器示例")]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('\x3c!-- 页面上"属性选择器"这几个字显示红色 --\x3e')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("data-v-hash")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("test-attr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("属性选择器"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("style")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token style"}},[n("span",{pre:!0,attrs:{class:"token language-css"}},[t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 该标签有个data-v-hash的属性，只不过该属性为空，依然可以使用属性选择器 */")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token selector"}},[t._v(".test-attr[data-v-hash]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v("color")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" red\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("style")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token script"}},[n("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过js判断是否存在data-v-hash属性")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelector")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.test-attr'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAttribute")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data-v-hash'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("h5",{attrs:{id:"vue-css-scoped原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue-css-scoped原理"}},[t._v("#")]),t._v(" vue css scoped原理")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("编译时，会给每个vue文件生成一个唯一的id,会将次id添加到当前文件中所有html标签上")]),t._v(" "),n("p",[t._v('如<div class="demo"></div>会被编译成<div class="demo" data-v-27e4e96e></div>')])]),t._v(" "),n("li",[n("p",[t._v("编译style标签时，会将css选择器改造成属性选择器，如.demo{color: red}会被编译成.demo[data-v-27e4e96e]{color: red}")])])]),t._v(" "),n("h4",{attrs:{id:"虚拟dom"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#虚拟dom"}},[t._v("#")]),t._v(" 虚拟DOM")]),t._v(" "),n("p",[n("span",{attrs:{stle:"color: red"}},[t._v("什么是虚拟dom?")])]),t._v(" "),n("p",[n("span",{staticStyle:{color:"blue"}},[t._v("Virtual DOM是模拟真实DOM节点，这个对象就是更加轻量级的对DOM的描述")])]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[t._v("为什么现在主流的框架都是用虚拟dom?")])]),t._v(" "),n("ol",[n("li",[t._v("前端性能优化的一个秘诀就是尽可能少操作DOM，频繁变动DOM会造成浏览器的回流或者重绘")]),t._v(" "),n("li",[t._v("是用虚拟dom，当数据变化，页面需要更新时，通过diff算法，对比新旧虚拟dom节点进行对比，比较两棵树的差异，生成差异对象，一次性将dom进行批量更新操作，进而有效提高性能")]),t._v(" "),n("li",[t._v("虚拟DOM本质上是JS对象，而DOM与平台强相关，相比之下虚拟DOM可以进行更方便的跨平台操作，例如服务器渲染、weex开发等等")])]),t._v(" "),n("h5",{attrs:{id:"虚拟dom与真实dom的相互转化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#虚拟dom与真实dom的相互转化"}},[t._v("#")]),t._v(" 虚拟dom与真实dom的相互转化")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将真实dom转化为虚拟dom")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("dom2Json")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("dom")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("dom"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tagName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" obj "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    obj"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tag "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" dom"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tagName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    obj"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    dom"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("childNodes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("item")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 去掉空节点")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("dom2Json")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" obj"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("dom2Json")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" obj\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 虚拟dom包含三个参数 type,props, children")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Element")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" props"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" children"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将虚拟dom渲染成真实的dom")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("domObj")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" el "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("domObj"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("keys")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("domObj"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("key")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" value "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" domObj"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("switch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'value'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tagName "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'INPUT'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tagName "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'TEXTAREA'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setAttribute")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'value'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'style'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" \n                el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cssText "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" \n                el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setAttribute")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    domObj"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("child")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// child = child instaceof Element ? render(child) : document.createTextNode(child);")]),t._v("\n        el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("child"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6844903806132568072",target:"_blank",rel:"noopener noreferrer"}},[t._v("让虚拟DOM和DOM-diff不再成为你的绊脚石"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://mp.weixin.qq.com/s/oAlVmZ4Hbt2VhOwFEkNEhw",target:"_blank",rel:"noopener noreferrer"}},[t._v("虚拟 DOM 到底是什么？"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6844903607913938951",target:"_blank",rel:"noopener noreferrer"}},[t._v("详解vue的diff算法"),n("OutboundLink")],1)]),t._v(" "),n("h4",{attrs:{id:"vuex原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vuex原理"}},[t._v("#")]),t._v(" vuex原理")]),t._v(" "),n("ol",[n("li",[t._v("vuex中store本质就是一个没有template模板的隐藏式的vue组件")]),t._v(" "),n("li",[t._v("vuex是利用vue的mixin混入机制，在beforeCreate钩子前混入vuexInit方法")]),t._v(" "),n("li",[t._v("vuexInit方法实现将vuex store注册到当前组件的$store属性上")]),t._v(" "),n("li",[t._v("vuex的state作为一个隐藏的vue组件的data，定义在state上面的变量，相当于这个vue示例的data属性，凡是定义在data上的数据都是响应式的")]),t._v(" "),n("li",[t._v("当页面中使用了vuex state中的数据，就是依赖收集的过程，当vuex中state的数据发生变化，就通过调用对应的dp对象notify方法 去修改视图变化")])]),t._v(" "),n("p",[n("RouterLink",{attrs:{to:"/source-vue/source-vue-vuex.html"}},[t._v("vuex实现原理")])],1),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.jianshu.com/p/d95a7b8afa06",target:"_blank",rel:"noopener noreferrer"}},[t._v("vuex工作原理详解"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://blog.csdn.net/weixin_34285318/article/details/90182481",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vuex数据流动过程"),n("OutboundLink")],1)]),t._v(" "),n("h4",{attrs:{id:"vue-router原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue-router原理"}},[t._v("#")]),t._v(" vue-router原理")]),t._v(" "),n("ol",[n("li",[t._v("创建的页面路由会与该页面形式一个路由表(key value形式，key为该路由，value为对应页面)")]),t._v(" "),n("li",[t._v("vue-router原理是监听URL的变化，然后匹配路由规则，会用新路由的页面替换到老页面，无需刷新")]),t._v(" "),n("li",[t._v("目前单页面使用的路由有两种实现方式：hash模式、history模式")]),t._v(" "),n("li",[t._v("hash模式(路由中带#号)，通过hashChange时间来监听路由变化 window.addEventListener('hashChange', ()=> {})")]),t._v(" "),n("li",[t._v("history模式，利用了pushState()和replaceState()方法，实现往history中添加新的浏览记录、或替换对应的浏览器记录，通过popstate事件来监听路由变化，window.addEventListener('popstate', () => {})")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6844903615283363848",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端路由简介以及vue-router实现原理"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6844904099050160141",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue Router原理"),n("OutboundLink")],1)]),t._v(" "),n("h4",{attrs:{id:"vue3和vue2的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue3和vue2的区别"}},[t._v("#")]),t._v(" vue3和vue2的区别")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("vue3性能比vue2.x快1.2~2倍")])]),t._v(" "),n("li",[n("p",[t._v("使用proxy取代Object.defineProperty,解决了vue中新增属性监听不到的问题，同时proxy也支持数组，不需要像vue2那样对数组的方法做拦截处理")])]),t._v(" "),n("li",[n("p",[t._v("diff方法优化--vue3新增了静态标记(patchflag),虚拟节点对比时，就只会对比这些带有静态标记的节点")])]),t._v(" "),n("li",[n("p",[t._v("静态提升")]),t._v(" "),n("p",[t._v("vue3对于不参与更新的元素，会做静态提升，只会被创建一次，在渲染时直接复用即可。vue2无论元素是否参与更新，每次都会重新创建然后再渲染")])]),t._v(" "),n("li",[n("p",[t._v("事件侦听器缓存\n默认情况下onClick会被视为动态绑定，所以每次都会追踪它的变化，但是因为是同一个函数，所以不用追踪变化，直接缓存起来复用即可")])]),t._v(" "),n("li",[n("p",[t._v("按需引入，通过treeSharking 体积比vue2.x更小")])]),t._v(" "),n("li",[n("p",[t._v("组合API（类似react hooks），可以将data与对应的逻辑写到一起，更容易理解")])]),t._v(" "),n("li",[n("p",[t._v("提供了很灵活的api 比如toRef、shallowRef等等，可以灵活控制数据变化是否需要更新ui渲染")])]),t._v(" "),n("li",[n("p",[t._v("更好的Ts支持")])])]),t._v(" "),n("h3",{attrs:{id:"react"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#react"}},[t._v("#")]),t._v(" React")]),t._v(" "),n("h4",{attrs:{id:"vue和react区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue和react区别"}},[t._v("#")]),t._v(" vue和react区别")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("设计理念不同")]),t._v(" "),n("p",[t._v("react整体上是函数式编程思想，组件使用jsx语法，all in js，将html于css全都融入javascript中，jsx语法相对来说更加灵活")]),t._v(" "),n("p",[t._v("vue整体思想，是拥抱经典的html(结构)+css(表现)+js(行为)的形式，使用template模板，并提供指令供开发者使用,如v-if、v-show、v-for等，开发时有结构、表现、行为分离的感觉")])]),t._v(" "),n("li",[n("p",[t._v("数据是否可变")]),t._v(" "),n("p",[t._v("vue的思想是响应式的，通过Object.defineProperty或proxy代理实现数据监听,每一个属性添加一个dep对象(用来存储对应的watcher)，当属性变化的时候，通知对应的watcher发生改变")]),t._v(" "),n("p",[t._v("react推崇的是数据不可变，react使用的是浅比较，如果对象和数据的引用地址没有变，react认为该对象没有变化，所以react变化时一般都是新创建一个对象")])]),t._v(" "),n("li",[n("p",[t._v("更新渲染方式不同")]),t._v(" "),n("p",[t._v("当组件的状态发生变化时,vue是响应式,通过对应的watcher自动找到对应的组件重新渲染")]),t._v(" "),n("p",[t._v("react需要更新组件时，会重新走渲染流程，通过从根节点开始遍历，dom diff找到需要变更的节点，更新任务还是很大，需要使用到Fiber，将大人物分割为多个小任务，可以中断和回复，不阻塞主进程执行高优先级任务")])]),t._v(" "),n("li",[n("p",[t._v("各自优势不同")]),t._v(" "),n("p",[t._v("vue的优势包括:框架内部封装的多，更容易上手，简单的语法及项目创建，更快的渲染速度和更小的体积")]),t._v(" "),n("p",[t._v("react的优势包括:react更灵活，更接近原生的js、可操作性强，对于能力强的人，更容易早出更个性化的项目")])])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.cnblogs.com/yubin-/p/11537122.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("React与Vue对比"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/lihongxun945/myblog/issues/21",target:"_blank",rel:"noopener noreferrer"}},[t._v("关于Vue和React区别的一些笔记"),n("OutboundLink")],1)]),t._v(" "),n("h4",{attrs:{id:"react-hooks"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#react-hooks"}},[t._v("#")]),t._v(" react Hooks")]),t._v(" "),n("p",[t._v("可以在函数式组件中，获取state、refs、生命周期钩子等特性")]),t._v(" "),n("p",[n("strong",[t._v("使用规则")])]),t._v(" "),n("ol",[n("li",[t._v("只在最顶层使用Hook，Hokks底层使用链表存储数据，按照定义的useState顺序存储对应的数据，不要在循环、条件或嵌套函数中调用hook，否则hooks的顺序会错乱")]),t._v(" "),n("li",[t._v("自定义Hook必须以『use』开头，如useFriendStatus")]),t._v(" "),n("li",[t._v("在两个组件中使用相同的Hook不会共享state，每次使用自定义Hook时，其中的所有state和副作用都是完全隔离的")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/brickspert/blog/issues/26",target:"_blank",rel:"noopener noreferrer"}},[t._v("React hooks原理"),n("OutboundLink")],1)]),t._v(" "),n("h4",{attrs:{id:"为什么vue和react都选择了hooks"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#为什么vue和react都选择了hooks"}},[t._v("#")]),t._v(" 为什么vue和react都选择了Hooks")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("更好的状态复用")]),t._v(" "),n("p",[t._v("对于vue2来说，使用的是mixin进行混入，会造成方法与属性的难以追溯。 随着项目的复杂，文件的增多，经常会出现不知道某个变量在哪里引入的，几个文件间来回翻找， 同时还会出现同名变量，相互覆盖的情况……😥")])]),t._v(" "),n("li",[n("p",[t._v("更好的代码组织")]),t._v(" "),n("p",[t._v("vue2的属性是放到data中，方法定义在methods中，修改某一块的业务逻辑时， 经常会出现代码间来回跳转的情况，增加开发人员的心智负担")]),t._v(" "),n("p",[t._v("使用Hooks后，可以将相同的业务逻辑放到一起，高效而清晰地组织代码")])]),t._v(" "),n("li",[n("p",[t._v("告别this")]),t._v(" "),n("p",[t._v("this有多种绑定方式，存在显示绑定、隐式绑定、默认绑定等多种玩法，里边的坑不是一般的多")]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[t._v("vue3的setup函数中不能使用this，不能用挺好，直接避免使用this可能会造成错误的")])])])]),t._v(" "),n("h4",{attrs:{id:"react-fiber"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#react-fiber"}},[t._v("#")]),t._v(" React Fiber")]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[n("strong",[t._v("解决react旧版本，页面卡段时候出现丢帧卡顿问题")])])]),t._v(" "),n("h4",{attrs:{id:"react旧版本问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#react旧版本问题"}},[t._v("#")]),t._v(" React旧版本问题")]),t._v(" "),n("p",[t._v("当我们调用setState更新页面的时候，React会遍历应用的所有节点，计算出差异，然后在更新UI")]),t._v(" "),n("p",[t._v("整个过程一气呵成，不能被打断。如果页面元素很多，这个过程执行的时间可能超过50毫秒，就容易出现掉帧的现象")]),t._v(" "),n("h4",{attrs:{id:"新版本解决方案"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#新版本解决方案"}},[t._v("#")]),t._v(" 新版本解决方案")]),t._v(" "),n("p",[t._v("React Fiber是把一个大任务拆分为很多个小块的任务，一个小块任务的执行必须是一次完成的，不能出现暂停，但是一个小块任务执行完后可以移交控制权给浏览器响应用户操作")]),t._v(" "),n("p",[t._v("核心是通过requestIdleCallback，会在利用浏览器空闲时间找出所有需要变更的节点")]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[t._v("阶段一，生成Fiber树，得出需要更新的节点信息，这一步是一个渐进的过程，可以被打断")])]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[t._v("阶段二,将需要更新的节点一次性批量更新，这个过程不能被打断")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6943896410987659277",target:"_blank",rel:"noopener noreferrer"}},[t._v("走进Fiber的世界"),n("OutboundLink")],1)]),t._v(" "),n("h4",{attrs:{id:"react中使用了fiber-为什么vue没有使用fiber"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#react中使用了fiber-为什么vue没有使用fiber"}},[t._v("#")]),t._v(" React中使用了Fiber，为什么vue没有使用Fiber？")]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[t._v("原因是二者的更新机制不一样")])]),t._v(" "),n("p",[t._v("Vue是基于template和watcher的组件级更新，把每个更新任务分割的足够小，不需要使用Fiber架构，将任务进行更细粒度的拆分")]),t._v(" "),n("p",[t._v("React是不管在哪里调用setState，都是从根节点开始更新，更新任务还是很大，需要用到Fiber将大任务分割为多个小任务，可以中断和恢复，不阻塞主进程执行高优先级的任务，如果不用Fiber，会出现老版本卡顿问题")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6943896410987659277",target:"_blank",rel:"noopener noreferrer"}},[t._v("走进Fiber的世界"),n("OutboundLink")],1)]),t._v(" "),n("h4",{attrs:{id:"为什么react推行函数式组件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#为什么react推行函数式组件"}},[t._v("#")]),t._v(" 为什么React推行函数式组件")]),t._v(" "),n("ol",[n("li",[t._v("函数组件不需要声明类，可以避免大量的譬如extends或者constructor这样的代码")]),t._v(" "),n("li",[t._v("函数组件不需要处理this指向问题")]),t._v(" "),n("li",[t._v("函数组件更贴近于函数式编程，更加贴近react的原则。使用函数式编程，灵活度更高，更好的代码复用")]),t._v(" "),n("li",[t._v("随着Hooks功能强大，更推动了函数式组件+Hooks这对组合的发展\n"),n("a",{attrs:{href:"https://www.zhihu.com/question/343314784",target:"_blank",rel:"noopener noreferrer"}},[t._v("为什么 React 现在要推行函数式组件，用 class 不好吗？"),n("OutboundLink")],1)])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6844904100891459591",target:"_blank",rel:"noopener noreferrer"}},[t._v("函数式组件 && React Hook"),n("OutboundLink")],1)]),t._v(" "),n("h4",{attrs:{id:"usememo和usecallback的作用与区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#usememo和usecallback的作用与区别"}},[t._v("#")]),t._v(" useMemo和useCallback的作用与区别")]),t._v(" "),n("h5",{attrs:{id:"usecallback"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#usecallback"}},[t._v("#")]),t._v(" useCallback")]),t._v(" "),n("p",[t._v("useCallback返回一个函数，只有在依赖项发生变化的时候才会更新(返回一个新的函数),多用于生成一个防抖函数")]),t._v(" "),n("p",[t._v("注意:组件每次更新时，所有方法都会重新创建，这样之前写的防抖函数就会失效，需要使用useCallback包裹")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("debounce"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'debounce'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 第二个参数为要监听的变量，当为空数组时[],submit只会被创建一次")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当监听有值时，会随着值的变化重新创建生成新的submit")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" submit "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("useCallback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("debounce")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("button onClick"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("submit")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("提交"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("button"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),n("h5",{attrs:{id:"usememo"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#usememo"}},[t._v("#")]),t._v(" useMemo")]),t._v(" "),n("p",[t._v("useMemo只有依赖项发生改变的时候，才会重新调用此函数，返回一个新的值，类似于vue中的Computed计算属性")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" info "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("useMemo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 定义info变量，该变量会随着inputPerson,inputAge的变化而变化，info可以在页面中显示")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        name"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" inputPerson"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        age"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" inputAge\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("inputPerson"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" inputAge"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6844904101445124110",target:"_blank",rel:"noopener noreferrer"}},[t._v("详解React useCallback & useMemo"),n("OutboundLink")],1)]),t._v(" "),n("h4",{attrs:{id:"setstate是同步还是异步"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#setstate是同步还是异步"}},[t._v("#")]),t._v(" setState是同步还是异步？")]),t._v(" "),n("p",[t._v("首先，同步和异步主要取决于它被调用的环境")]),t._v(" "),n("p",[n("strong",[t._v("这里的同步还是异步，指的是调用setState方法后，是否能立刻拿到更新后的值")])]),t._v(" "),n("ol",[n("li",[n("p",[t._v("如果setState在React能够控制的范围被调用，它就是异步的。比如合成事件处理函数、生命周期函数")]),t._v(" "),n("p",[t._v("在合成事件和钩子函数中，多次调用setState修改同一个值，只会取最后一次的执行，前面的会被覆盖")])]),t._v(" "),n("li",[n("p",[t._v("如果setState在原生Javascript控制的范围被调用，它就是同步的。比如原生事件处理函数、setTimeout、promise的回调函数")]),t._v(" "),n("p",[t._v("在原生事件和异步中，可以多次调用setState 修改同一个值，每次修改都会生效")])])]),t._v(" "),n("h5",{attrs:{id:"react中的合成事件和原生事件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#react中的合成事件和原生事件"}},[t._v("#")]),t._v(" react中的合成事件和原生事件")]),t._v(" "),n("p",[t._v("react为了解决跨平台，兼容性问题，自己封装了一套事件机制，代理了原生的事件，像在jsx中常见的onClick、onChange这些都是合成事件")]),t._v(" "),n("p",[t._v("原生事件是指非react合成事件，原生自带的事件监听addEventListener，或者也可以用原生js、jq直接绑定事件的形式都属于原生事件")]),t._v(" "),n("h4",{attrs:{id:"jsx语法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#jsx语法"}},[t._v("#")]),t._v(" JSX语法")]),t._v(" "),n("ol",[n("li",[t._v("jsx是React.createElement(component, props, ...children)函数的语法糖")]),t._v(" "),n("li",[t._v("底层是使用babel-plugin-transform-react-jsx插件将jsx的语法转成js对象，判断是否是jsx对象或者是否是一个组件，转换为对应的js对象(虚拟dom)")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 示例一")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("MyButton color"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"blue"')]),t._v(" shadowSize"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Chick Me"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("MyBotton"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 会编译为")]),t._v("\nReact"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MyBotton"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("color"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'blue'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" shadowSize"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Chick Me'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 示例二:")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 以下两种示例代码完全等效")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" element "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("h1 className"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'greet'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Hello"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("h1"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 等价于")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" element "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" React"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'h1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("className"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"greet"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("h3",{attrs:{id:"服务端渲染"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#服务端渲染"}},[t._v("#")]),t._v(" 服务端渲染")]),t._v(" "),n("h4",{attrs:{id:"服务器渲染的多重模式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#服务器渲染的多重模式"}},[t._v("#")]),t._v(" 服务器渲染的多重模式")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("传统的spa应用，都属于CSR(Client Side Rendering)客户端渲染")]),t._v(" "),n("p",[t._v("主要问题")]),t._v(" "),n("ul",[n("li",[n("span",{staticStyle:{color:"red"}},[n("strong",[t._v("白屏时间过程")]),t._v(":在JS bundle返回之前，加入bundle体积过大或者网络条件不好的情况下，页面一直是空白的，用户体验不好")])]),t._v(" "),n("li",[t._v("SEO不友好:搜索引擎访问页面时，只会看HTML中的内容，默认是不会执行JS，所以赚取不到页面的具体内容")])])]),t._v(" "),n("li",[n("p",[t._v("服务端渲染的多种模式")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("SSR(Server Side Rendering),即服务端渲染")]),t._v(" "),n("p",[t._v("服务端直接实时同构渲染当前用户访问的页面，返回的HMTL包含页面具体内容，提高用户的体验")]),t._v(" "),n("p",[t._v("适用于:页面动态内容，SEO的诉求、要求首屏时间快的场景")]),t._v(" "),n("p",[t._v("缺点: SSR需要较高的服务器运维成本、切换页面时较慢，每次切换页面都需要服务端新生成页面")])]),t._v(" "),n("li",[n("p",[t._v("SSG(Static Site Generation),是指在应用编译构建时预先渲染页面，并生成静态HTML")]),t._v(" "),n("p",[t._v("把生成的HTML静态资源部署到服务器后，浏览器不仅首次能请求到带页面内容的HTML，而且不需要服务端实时渲染，大大节约了服务器运维成本和资源")]),t._v(" "),n("p",[t._v("适用于:页面内容由后端获取，但变化不频繁，满足SEO 的诉求、要求首屏时间快的场景，SSG打包好的是静态页面，和普通页面部署一样")])]),t._v(" "),n("li",[n("p",[t._v("ISR(Incremental Static Regeneration),创建需要增量静态再生的页面")]),t._v(" "),n("p",[t._v("创建具有动态路由的页面(增量静态再生)，允许在应用运行时再重新生成每个页面HTML，而不需要重新构建整个应用，这样即使有海量页面(比如博客、商品介绍也等场景)，也能使用SSG的特性")]),t._v(" "),n("p",[t._v("在Next.js，使用ISR需要getStaticPaths 和getStaticProps同时配合使用")])])])])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.cnblogs.com/lhb25/p/16223782.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("你知道吗？SSR、SSG、ISR、DPR 有什么区别？"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://blog.csdn.net/weixin_41556756/article/details/125486069",target:"_blank",rel:"noopener noreferrer"}},[t._v("什么是SSR/SSG/ISR？如何在AWS上托管它们？"),n("OutboundLink")],1)]),t._v(" "),n("h4",{attrs:{id:"vue-ssr服务端渲染"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue-ssr服务端渲染"}},[t._v("#")]),t._v(" vue SSR服务端渲染")]),t._v(" "),n("h5",{attrs:{id:"ssr原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ssr原理"}},[t._v("#")]),t._v(" ssr原理")]),t._v(" "),n("p",[n("span",{attrs:{styl:"color: red"}},[t._v("通过asyncData获取数据，获取数据成功后，通过vue-server-renderer将数据渲染到页面中，生成完整的html内容，实现服务端渲染")])]),t._v(" "),n("h5",{attrs:{id:"ssr基本交互流程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ssr基本交互流程"}},[t._v("#")]),t._v(" SSR基本交互流程")]),t._v(" "),n("ol",[n("li",[t._v("在浏览器访问首页时，Web服务器根据路由拿到对应数据渲染并输出html，输出的html包含两部分\n"),n("ul",[n("li",[t._v("路由页对应的页面及已渲染好的数据(后端渲染)")]),t._v(" "),n("li",[t._v("完整的SPA程序代码")])])]),t._v(" "),n("li",[t._v("在客户端首屏渲染完成之后，其实已经是一个和之前SPA相差无几的应用程序了，接下来我们进行的任何操作只是客户端的应用进行交互")])]),t._v(" "),n("h5",{attrs:{id:"vue-ssr整体流程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue-ssr整体流程"}},[t._v("#")]),t._v(" vue SSR整体流程")]),t._v(" "),n("ol",[n("li",[t._v("配置两个入口文件，一个是客户端使用，一个是服务端使用，一套代码两套执行环境")]),t._v(" "),n("li",[t._v("服务端渲染需要Vue实例，每一次客户端请求页面，服务端渲染都是用一个新的vue实例，服务端利用工厂函数每次都返回一个新的vue实例")]),t._v(" "),n("li",[t._v("获取请求页面的路由，生成对应的vue实例")]),t._v(" "),n("li",[t._v("如果页面中需要调接口获取数据，通过asyncData获取数据，数据获取成功后，通过异步的方式在继续进行初始化，通过vue-server-renderer将数据渲染到页面中，生成html内容")])]),t._v(" "),n("h5",{attrs:{id:"如何避免客户端重复请求数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#如何避免客户端重复请求数据"}},[t._v("#")]),t._v(" 如何避免客户端重复请求数据")]),t._v(" "),n("p",[t._v("在服务端已经请求的数据，在客户端应该避免重复请求，怎样同步数据到客户端？")]),t._v(" "),n("p",[t._v("通过（window对象作为中间媒介进行传递数据）")]),t._v(" "),n("ol",[n("li",[t._v("服务端获取数据，保存到服务端的store状态，以便渲染时候使用，最终会将store保存到window中")]),t._v(" "),n("li",[t._v("在renderer中会在html代码中添加"),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token script"}},[n("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__INITIAL_STATE__ "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" context"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("，\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 在解析页面的时候会进行设置全局变量 --\x3e")]),t._v("\n")])])])]),t._v(" "),n("li",[t._v("在浏览器进行初始化Store的时候，通过window对象进行获取数据在服务端的状态，并且将其注入到store.state状态中，这样能够实现状态统一")])]),t._v(" "),n("h5",{attrs:{id:"为什么服务端渲染不能调用mounted钩子"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#为什么服务端渲染不能调用mounted钩子"}},[t._v("#")]),t._v(" 为什么服务端渲染不能调用mounted钩子")]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[t._v("服务端渲染不能调用beforeMount和mounted，Node环境没有document对象，初始化的时候，vue底层会判断当前环境中是否有el这个dom对象，如果没有，就不会执行到beforeMount和mounted这两个钩子函数")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6844903569632526344",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue 服务端渲染（SSR）"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6950802238524620837",target:"_blank",rel:"noopener noreferrer"}},[t._v("理解Vue SSR原理，搭建项目框架"),n("OutboundLink")],1)]),t._v(" "),n("h4",{attrs:{id:"react-next预渲染模式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#react-next预渲染模式"}},[t._v("#")]),t._v(" React Next预渲染模式")]),t._v(" "),n("p",[t._v("Next.js支持SSR、SSG、ISR三种模式，默认是SSG")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("SSR模式")]),t._v(" "),n("p",[t._v("需要将Next.js应用程序部署到服务器，开启服务端渲染")]),t._v(" "),n("p",[t._v("整个流程：用户访问页面->如果该页面配置了getServerSideProps函数->调用getServerSideProps函数->用接口的数据渲染出完整的页面返回给用户")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 定义页面")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Page")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Render data...")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果该页面配置了getServerSideProps函数，调用该函数")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getServerSideProps")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 请求接口拿到对应的数据")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://.../data'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将数据渲染到页面中")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" props"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" data "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 导出整个页面")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" Page\n")])])])]),t._v(" "),n("li",[n("p",[t._v("SSG模式")]),t._v(" "),n("p",[t._v("SSG模式:项目在打包时，从接口中请求数据，然后用数据构建出完整的html页面，最后把打包好的静态页面，直接放到服务器上即可。")]),t._v(" "),n("p",[t._v("Next.js允许你从同意文件export(导出)一个名为getStaticProps的async(异步)函数。该函数在构建时候被调用，并允许你在预渲染时将获取的数据作为props参数传递给页面")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 定义Blog页面")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Blog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("posts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Render posts...")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// getStaticProps函数，在构建时候被调用")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getStaticProps")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 调用外部API获取博文列表")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://...//posts'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" posts "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过返回{ props: {posts}} 对象 Blog组件")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在构建时将接收到的posts参数")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        props"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            props"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                posts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" Blog\n")])])])])]),t._v(" "),n("ul",[n("li",[n("p",[t._v("ISR模式")]),t._v(" "),n("p",[t._v("创建具有动态路由的页面，用于海量生成")]),t._v(" "),n("p",[t._v("Next.js允许在应用运行时在重新生成每个页面HTML，而不需要重新构建整个应用。这样即使有海量页面，也能使用上SSG的特性。一般来说，使用ISR需要getStaticPaths和getStaticProps同时配合使用")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 定义博文页面")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Blog")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" post "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Render post...")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 此函数在构建时被调用")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getStaticPaths")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 调用外部 API 获取博文列表")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://.../posts'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" posts "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 据博文列表生成所有需要预渲染的路径")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" paths "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" posts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("post")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        params"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" post"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" paths"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" fallback"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在构建时也会被调用")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getStaticProps")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" params "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// params 包含此片博文的 `id` 信息。")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果路由是 /posts/1，那么 params.id 就是 1")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" res "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("https://.../posts/")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("params"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" post "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过 props 参数向页面传递博文的数据")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" props"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" post "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" Blog\n")])])])])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.nextjs.cn/docs/basic-features/pages#%E9%A2%84%E6%B8%B2%E6%9F%93",target:"_blank",rel:"noopener noreferrer"}},[t._v("next预渲染"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6977783923099041800",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用Next.js进行增量静态再生（ISR）的完整指南"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"node"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node"}},[t._v("#")]),t._v(" Node")]),t._v(" "),n("p",[t._v("Node经常用于前端构建、微服务、中台等场景")]),t._v(" "),n("h3",{attrs:{id:"node-高并发的原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node-高并发的原理"}},[t._v("#")]),t._v(" Node 高并发的原理")]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[t._v("Node的特点:事件驱动、非阻塞I/O、高并发")])]),t._v(" "),n("h4",{attrs:{id:"node高并发的原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node高并发的原理"}},[t._v("#")]),t._v(" node高并发的原理")]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[t._v("Nodejs之所以单线程可以处理高并发的原因，得益于内部的事件循环机制和底层线程池实现")])]),t._v(" "),n("p",[t._v("遇到异步任务,node将所有的阻塞操作都交给了内部的线程池去实现。本质上的异步操作还是由线程池完成的，主线程本身只负责不断的往返调度，从而实现异步非阻塞I/O，这边是Node单线程和事件驱动的精髓之处")]),t._v(" "),n("h4",{attrs:{id:"整体流程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#整体流程"}},[t._v("#")]),t._v(" 整体流程")]),t._v(" "),n("ol",[n("li",[t._v("每个Node进程只有一个主线程在执行程序代码")]),t._v(" "),n("li",[t._v("当用户的网络请求、数据库操作、读取文件等其他的异步操作时候，node会把它放到Event Queue('事件队列')之中，此时并不会立即执行它，代码也不会被阻塞，继续往下走，直到主线程代码执行完毕")]),t._v(" "),n("li",[t._v("主线程代码执行完毕完成后，然后通过事件循环机制，依次取出对应的事件，从线程池中分配一个对应的线程去执行，当有事件执行完毕后，会通知主线程，主线程执行回调拿到对应的结果")])]),t._v(" "),n("h3",{attrs:{id:"node事件循环机制与浏览器的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node事件循环机制与浏览器的区别"}},[t._v("#")]),t._v(" Node事件循环机制与浏览器的区别")]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[t._v("主要区别:"),n("strong",[t._v("浏览器中的微任务是在每个相应的宏任务中执行的，而nodejs的微任务是在不同阶段之间执行的")])])]),t._v(" "),n("p",[t._v("node事件循环机制分为6个阶段，他们会按照顺序反复执行")]),t._v(" "),n("p",[t._v("每当进入某一阶段的时候，都会从对应的回调队列中取出函数去执行。当队列为空或执行的回调函数数量达到系统设置的阀值，会进入下一阶段")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1887),alt:"node事件循环"}})]),t._v(" "),n("p",[t._v("主要介绍timers、poll、check这3个阶段，因为日常开发中的绝大部分异步任务都是在这3个阶段处理的")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("timer")]),t._v(" "),n("p",[t._v("timers阶段会执行setTimeout和setInterval回调，并且是由poll阶段控制的")])]),t._v(" "),n("li",[n("p",[t._v("poll")]),t._v(" "),n("p",[t._v("poll是一个至关重要的阶段，这一阶段中，系统会做两件事情:回到timer阶段执行回调，执行I/O回调")])]),t._v(" "),n("li",[n("p",[t._v("check阶段")]),t._v(" "),n("p",[t._v("setImmediate()回调会被加入check队列中，从event loop的阶段图可以知道，check阶段的执行顺序在poll阶段之后")])])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://blog.csdn.net/LuckyWinty/article/details/104765786",target:"_blank",rel:"noopener noreferrer"}},[t._v("面试题：说说事件循环机制(满分答案来了)"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/54882306",target:"_blank",rel:"noopener noreferrer"}},[t._v("浏览器与Node的事件循环(Event Loop)有何区别?"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"中间件原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#中间件原理"}},[t._v("#")]),t._v(" 中间件原理")]),t._v(" "),n("p",[t._v("比较流行的Node.js框架有Express、Koa和Egg.js，都是基于中间件来实现的。中间件主要用于请求拦截和修改请求或响应结果")]),t._v(" "),n("p",[t._v("node中间件本质就是在进入具体的业务处理之前，先让特定过滤器进行处理。")]),t._v(" "),n("p",[n("strong",[t._v("一次HTTP请求通常包含很多工作，如果请求体解析、Cookie处理、权限验证、参数验证、记录日志、ip过滤、异常处理，这些环节通过中间件处理，让开发人员把核心放在对应的业务开发上")])]),t._v(" "),n("p",[t._v('这种模式也被称为"洋葱圈模型"')]),t._v(" "),n("p",[n("img",{attrs:{src:a(1888),alt:"洋葱圈模式"}})]),t._v(" "),n("p",[n("strong",[t._v("模拟一个中间件流程")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("m1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("next")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'m1 run'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'result1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("m2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("next")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'m2 run'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'result2'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("m3")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("next")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'m3 run'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'result3'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" middlewares "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("m1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" m2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" m3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("useApp")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("next")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" middleware "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" middleware"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("shift")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("middleware"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Promise"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("middleware")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("next"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Promise"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'end'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 启动中间件")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("useApp")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 依次打印 ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// m1 run")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// m2 run")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// m3 run")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// result3")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// result2")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// result1")]),t._v("\n")])])]),n("p",[n("RouterLink",{attrs:{to:"/back-end/Node/frame-compose.html"}},[t._v("koa中间件")])],1),t._v(" "),n("p",[n("RouterLink",{attrs:{to:"/back-end/Node/study-02koa.html#中间件"}},[t._v("koa中间件实现")])],1),t._v(" "),n("p",[n("strong",[t._v("express中间件的执行过程")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" express "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("express")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'3000'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'启动服务'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'first'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'end1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'second'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'end2'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'third'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'end3'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 请求http://localhost:3000/#/")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 依次打印：")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// first")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// second")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// third")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// end3")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// end2")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// end1")]),t._v("\n")])])]),n("ul",[n("li",[n("p",[t._v("express常用的中间件")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("中间件名称")]),t._v(" "),n("th",[t._v("作用")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("express.static()")]),t._v(" "),n("td",[t._v("用来返回静态文件")])]),t._v(" "),n("tr",[n("td",[t._v("body-parser")]),t._v(" "),n("td",[t._v("用来解析post数据")])]),t._v(" "),n("tr",[n("td",[t._v("multer")]),t._v(" "),n("td",[t._v("处理文件上传")])]),t._v(" "),n("tr",[n("td",[t._v("cookie-parser")]),t._v(" "),n("td",[t._v("用来操作cookie")])]),t._v(" "),n("tr",[n("td",[t._v("cookie-session")]),t._v(" "),n("td",[t._v("处理session")])])])])])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://blog.csdn.net/KlausLily/article/details/109506490",target:"_blank",rel:"noopener noreferrer"}},[t._v("深入浅出node中间件原理"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.cnblogs.com/xiaosongJiang/p/10854467.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("nodejs 中间件理解"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"实现一个大文件上传和断点续传"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实现一个大文件上传和断点续传"}},[t._v("#")]),t._v(" 实现一个大文件上传和断点续传")]),t._v(" "),n("p",[t._v("该案例会使用node对文件进行操作，这也是node最常用的场景之一")]),t._v(" "),n("p",[t._v("其中一个关键的知识点：pipe管道流")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("管道:一个程序的输出直接成为下一个程序的输入，就像水流过管道一样方便")]),t._v(" "),n("p",[t._v("readStream.pipe(writeStream)就是在可读流与可写流中间加入一个管道，实现一遍读取，一边写入，读一点写一点")])]),t._v(" "),n("li",[n("p",[t._v("管道流的好处:节约内存")]),t._v(" "),n("p",[t._v("读出的数据，不做保存，直接流出。写入写出会极大的占用内存，stream可以边读边写，不占用太多内存，并且完成所需任务")])])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6844904046436843527",target:"_blank",rel:"noopener noreferrer"}},[t._v("字节跳动面试官：请你实现一个大文件上传和断点续传"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"如何做到接口防刷"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#如何做到接口防刷"}},[t._v("#")]),t._v(" 如何做到接口防刷")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("第一步:负载均衡层的限流,防止用户重复抽象")]),t._v(" "),n("p",[t._v("在负载均衡设备中做一些配置，判断如果同一个用户在1分钟之内多次发送请求来进行抽奖，就认为是恶意重复抽奖，或者是他们自己写的脚本在刷")]),t._v(" "),n("p",[t._v("这种流量一律认为是无效流量，在负载均衡那个层就给直接屏蔽掉。所以这里就可以把无效流量给拦截掉")])]),t._v(" "),n("li",[n("p",[t._v("第二步:暴力拦截浏览")]),t._v(" "),n("p",[t._v("其实秒杀、抢红包、抽奖，这类系统有一个共同的特点，那就是假设有50万请求涌入进来，可能前5万请求就直接把事儿干完了，甚至是前500请求就把事儿干完了")]),t._v(" "),n("p",[t._v("后续的几十万流量是无效的，不需要让他们进入后台系统执行业务逻辑了")]),t._v(" "),n("p",[t._v("这样的话，其实在负载均衡这一层（可以考虑用Nginx之类的来实现）就可以拦截掉99%的无效流量")])]),t._v(" "),n("li",[n("p",[t._v("第三步: ip或用户抽象次数校验")]),t._v(" "),n("p",[t._v("建立一个抽奖表，该表记录所有参与抽奖的ip和用户信息，比如判断5s内，该用户连续抽奖了2次以上，就拒绝该请求，认为是在刷接口，就把该用户和ip加入黑名单")])])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6844903847031226382",target:"_blank",rel:"noopener noreferrer"}},[t._v("如何设计一个百万级用户的抽奖系统？"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"mongodb和mysql的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mongodb和mysql的区别"}},[t._v("#")]),t._v(" mongoDb和mySQL的区别")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("mongoDb是非关系型数据库，mySQL是关系型数据库")]),t._v(" "),n("p",[t._v("mongoDb里存储的是json格式的数据,键值对形式，该数据结构非常符合前端的需求。")]),t._v(" "),n("p",[t._v('关系型数据天然就是表格式的，就是后端常说的"表",数据存储在数据表的行和列中。数据表可以彼此关联协作存储，也很容易提取数据')])]),t._v(" "),n("li",[n("p",[t._v("对事务性的支持不同")]),t._v(" "),n("p",[t._v("mongoDb不支持事务，mySQL支持事务")]),t._v(" "),n("p",[t._v("事务的好处便于回滚，如第一个账户划出款项必须保证正确的存入第二个账户，如果第二个环节没有完成，整个的过程都应该取消，否则就会发生丢失款的问题。这时就需要回滚，恢复到初始的状态")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.cnblogs.com/1488boss/p/10754290.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("mongodb与mysql区别(超详细)"),n("OutboundLink")],1)])])]),t._v(" "),n("h3",{attrs:{id:"高并发的如何正确修改库存"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#高并发的如何正确修改库存"}},[t._v("#")]),t._v(" 高并发的如何正确修改库存")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("场景")]),t._v(" "),n("p",[t._v("抽象或秒杀活动，同时一千个请求过来，但奖品库存只有一个，期望的结果是只有一个人中奖，剩下999个人没有中奖。")]),t._v(" "),n("p",[t._v("但是压测时，遇到的情况却是1000个都中奖了，并且库存还是一个")]),t._v(" "),n("p",[t._v("原因就是高并发时，一千个请求同时读到库存都是一个，都中奖后，库存同时减一，最后导致库存没有减对")]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[t._v("解决此类问题，就是要给"),n("strong",[t._v("数据库加锁")]),t._v("的概念，保证库存一个一个减、串行的减，解决方式就是使用mongoDB中的update方法减库存")])])]),t._v(" "),n("li",[n("p",[t._v("mongoDb中,有三种方法可以实现更新数据")]),t._v(" "),n("ol",[n("li",[t._v("save方法，如db.collection.save(obj),save是在客户端代码中生成的对象，需要从客户端回写到服务端")]),t._v(" "),n("li",[t._v("findOneAndUpdate方法，如db.findOneAndUpdaet(<filter>,{obj}),和save类似也需要从客户端回写到服务端")]),t._v(" "),n("li",[t._v("update方法,如db.update(<filter>{obj}),update是服务端处理的，速度最快；实测当并发超过1000次每秒时，update的速度是其他的2倍")])])])]),t._v(" "),n("h3",{attrs:{id:"redis"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#redis"}},[t._v("#")]),t._v(" Redis")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("Redis特点")]),t._v(" "),n("ol",[n("li",[t._v("Redis也是一种数据库，Redis中的数据是"),n("span",{staticStyle:{color:"red"}},[t._v("放到内存中的，Redis查询速度极快")]),t._v("。一些常用的数据，可以存到Redis中，缩短从数据库查询数据的时间。")]),t._v(" "),n("li",[t._v("Redis可以设置过期时间，可以将一些需要定期过期的信息放到Redis中，有点类似cookie")])])]),t._v(" "),n("li",[n("p",[t._v("运用场景")]),t._v(" "),n("ol",[n("li",[t._v("将经常查询的信息存储到redis中，如抽奖活动的配置信息，这些信息查询的频率最高，放到Redis中可以提高查询速度，还可以存储用户的个人信息(权限、基础信息等)")]),t._v(" "),n("li",[t._v("需要设置过期时长的信息，如微信授权，每2个小时过期一次，将对应的授权code存进去，到时删除")])])]),t._v(" "),n("li",[n("p",[t._v("优点")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("支持多重数据类型")])]),t._v(" "),n("li",[n("p",[t._v("持久化存储")]),t._v(" "),n("p",[t._v("作为一个内存数据库，最担心的，就是万一机器死机宕机，数据就会消失掉。redis使用RDB和AOF做数据的持久化存储。主从数据同时，生成rdb文件，并利用缓冲区添加新的数据更新操作做对应的同步。")])]),t._v(" "),n("li",[n("p",[t._v("性能很好")])])])]),t._v(" "),n("li",[n("p",[t._v("缺点")]),t._v(" "),n("ol",[n("li",[t._v("由于是内存数据库，所以单台机器存储的数据量跟机器本身的内存有关")]),t._v(" "),n("li",[t._v("如果进行完成重同步，需要生成rdb文件，并进行传输，会占用主机的CPU，并会小号现网的带宽。")]),t._v(" "),n("li",[t._v("修改配置文件，进行重启，将硬盘中的数据加载进内存，时间比较久，在这个过程中，redis不能提供服务")])])])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://blog.csdn.net/wgw_dream/article/details/83780503",target:"_blank",rel:"noopener noreferrer"}},[t._v("Redis的优缺点"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"node创建子进程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node创建子进程"}},[t._v("#")]),t._v(" node创建子进程")]),t._v(" "),n("p",[t._v("当项目中需要大量计算的操作的时候，就要考虑开启多进程来完成了，类似于"),n("a",{attrs:{href:"https://juejin.cn/post/7137728629986820126",target:"_blank",rel:"noopener noreferrer"}},[t._v("web worker"),n("OutboundLink")],1),t._v(",否则会阻塞主线程的执行")]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[t._v("Node提供了 child_process 模块来创建子进程")])]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[t._v("进程间通信:使用fork方法创建的子进程，可通过send、on(message)方法来发送和接收进程间的数据")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// parent.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" cp "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'child_process'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过child_process中的fork方法来生成子进程")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" child "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("fork")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'child.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nchild"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" message"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'from_parent'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// send方法发送数据")]),t._v("\nchild"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'message'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// on 方法接收数据")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// child.js")]),t._v("\nprocess"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'message'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nprocess"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" message"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'from_child'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[n("a",{attrs:{href:"https://www.cnblogs.com/chyingp/p/node-learning-guide-child_process.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nodejs进阶:如何玩转子进程(child_process)"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"pm2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#pm2"}},[t._v("#")]),t._v(" PM2")]),t._v(" "),n("p",[t._v("PM2可以根据cpu核数,开启多个进程，充分利用cpu的多核性能")]),t._v(" "),n("p",[t._v("如pm2 start app.js -i 8 该命令可以开启8个进程")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("主要作用")]),t._v(" "),n("ol",[n("li",[t._v("内建负载均衡(使用 Node Cluster 集群模块)")]),t._v(" "),n("li",[t._v("线程守护，keep alive")]),t._v(" "),n("li",[t._v("0秒停机重载，维护升级的时候不需要停机")]),t._v(" "),n("li",[t._v("停止不稳定的进程(避免无限循环)")])])]),t._v(" "),n("li",[n("p",[t._v("负载均衡cluster的原理")]),t._v(" "),n("ol",[n("li",[t._v("Node.js给我们提供了 cluster模块，它可以生成多个工作线程来共享同一个TCP连接")]),t._v(" "),n("li",[t._v("首先,Cluster会创建一个master,然后根据你指定的数量复制出多个 server app(也被称为工作线程)")]),t._v(" "),n("li",[t._v("它通过IPC通道与工作线程之间进行通信，并使用内置的负载均衡来更好的处理线程之间的压力，该负载均衡使用了Round-robin算法(也被称为循环算法)")])])])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.cnblogs.com/jaxu/p/5193643.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用PM2将Node.js的集群变得更加容易"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.cnblogs.com/jaxu/p/5193643.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("PM2入门指南"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"计算机网络与安全"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#计算机网络与安全"}},[t._v("#")]),t._v(" 计算机网络与安全")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1889),alt:"计算机网络与安全"}})]),t._v(" "),n("h3",{attrs:{id:"从输入url到页面加载发生了什么"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#从输入url到页面加载发生了什么"}},[t._v("#")]),t._v(" 从输入URL到页面加载发生了什么？")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("浏览器查找当前URL是否存在缓存，并比较缓存是否过期.(先判断HTTP请求浏览器是否已缓存)")]),t._v(" "),n("p",[t._v("有缓存")]),t._v(" "),n("ul",[n("li",[t._v("如为强制缓存，通过Expires或Cache-Control:max-age判断该缓存是否过期，未过期，直接使用该资源；Expires和max-age，如果两者同事存在，则被Cache-Control的max-age覆盖")]),t._v(" "),n("li",[t._v("如为协商缓存，请求头上带上相关信息 If-none-match(Etag)与If-modified-since(last-modified)，验证缓存是否有效，若有效则返回状态码304,若无效则重新返回资源，状态码为200")])])]),t._v(" "),n("li",[n("p",[t._v("DNS解析URL对应的IP(DNS解析流程见下文)")])]),t._v(" "),n("li",[n("p",[t._v("根据IP简历TCP连接(三次握手)（握手过程见下文）")])]),t._v(" "),n("li",[n("p",[t._v("HTTP发起请求")])]),t._v(" "),n("li",[n("p",[t._v("服务器处理请求，浏览器接收HTTP响应")])]),t._v(" "),n("li",[n("p",[t._v("渲染页面，构建DOM树")]),t._v(" "),n("ul",[n("li",[t._v("HTML解析，生成DOM树")]),t._v(" "),n("li",[t._v("根据CSS解析生成CSS树")]),t._v(" "),n("li",[t._v("结合CSS树和DOM树，生成渲染树")]),t._v(" "),n("li",[t._v("根据渲染树计算每一个节点的信息(layout布局)")]),t._v(" "),n("li",[t._v("根据计算好的信息绘制页面")])]),t._v(" "),n("p",[t._v("如果遇到script标签，则判断是否含有defer或者async属性，如果有，异步去下载该资源；如果没有设置，暂停dom的解析，去加载script资源，然后执行该js代码("),n("span",{staticStyle:{color:"red"}},[n("strong",[t._v("script标签加载和执行会阻塞页面的渲染")])]),t._v(")")])]),t._v(" "),n("li",[n("p",[t._v("关系TCP连接(四次挥手)（挥手过程见下文）")])])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.cnblogs.com/liutianzeng/p/10456865.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("从输入url到页面加载完成发生了什么详解"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6844903922084085773",target:"_blank",rel:"noopener noreferrer"}},[t._v("在浏览器输入 URL 回车之后发生了什么（超详细版）"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"彻底弄懂cors跨域请求"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#彻底弄懂cors跨域请求"}},[t._v("#")]),t._v(" 彻底弄懂cors跨域请求")]),t._v(" "),n("p",[t._v("cors是解决跨域问题的常见解决方法,关键是服务器要设置Access-Control-Allow-Origin,控制那些域名可以共享资源")]),t._v(" "),n("p",[t._v("origin是cors的重要标识,只要是非同源或者POST请求都会带上Origin字段，接口返回后服务器也可以将Access-Control-Allow-Origin设置为请求的Origin，解决cors如何指定多个域名的问题")]),t._v(" "),n("p",[n("strong",[t._v("cors将请求分为简单请求和非简单请求")])]),t._v(" "),n("ul",[n("li",[n("p",[t._v("简单请求")]),t._v(" "),n("ol",[n("li",[t._v("支持持HEAD、get、post请求方式")]),t._v(" "),n("li",[t._v("没有自定义的请求头")]),t._v(" "),n("li",[t._v("Content-Type;只限于三个值 application/x-www-form-urlencoded、multipart/form-data、text/plain")])]),t._v(" "),n("p",[t._v("对于简单请求，浏览器直接发出cors请求。具体来说，就是在头信息之中，增加一个Origin字段。如果浏览器发现这个接口回应的头信息没有包含Access-Control-Allow-Origin字段的话就会报跨域错误")])]),t._v(" "),n("li",[n("p",[t._v("非简单请求的跨域处理")]),t._v(" "),n("p",[t._v('非简单请求,会在正式通信之前，增加一个HTTP查询请求，成为"预检"请求(options)，用来判断当前网页所在的域名是否在服务器的许可名单之中。')]),t._v(" "),n("p",[t._v("如果在许可名单中，就会发正式请求;如果不在，就会报跨域错误。")])])]),t._v(" "),n("blockquote",[n("p",[t._v("注:新版chrome浏览器看不到OPTIONS预检请求，可以网上查找对应的查看方法")])]),t._v(" "),n("p",[n("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2016/04/cors.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("跨域资源共享CORS详解"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"tcp的三次握手和四次挥手"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tcp的三次握手和四次挥手"}},[t._v("#")]),t._v(" TCP的三次握手和四次挥手")]),t._v(" "),n("h3",{attrs:{id:"websocket"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#websocket"}},[t._v("#")]),t._v(" WebSocket")]),t._v(" "),n("p",[t._v("WebSocket是HTML5提供的一种浏览器与服务进行全双工通讯的网络协议，属于应用层协议，WebSocket没有跨域限制。")]),t._v(" "),n("p",[t._v("相比于接口轮训，需要不断的建立http连接，严重浪费了服务器端和客户端的资源")]),t._v(" "),n("p",[t._v("WebSocket基于TCP传输协议，并复用HTTP的握手通道。浏览器和服务器只需要建立一次http连接，两者之间可以创建持久性的连接，并进行双向数据传输")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("缺点")]),t._v(" "),n("p",[t._v("websocket不稳定，要建立心跳检测机制，如果断开自动连接")])])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/6844903698498322439",target:"_blank",rel:"noopener noreferrer"}},[t._v("手摸手教你使用WebSocket[其实WebSocket也不难]"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://blog.csdn.net/yournevermore/article/details/103067079",target:"_blank",rel:"noopener noreferrer"}},[t._v("socket 及 websocket的握手过程"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"tcp和udp的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tcp和udp的区别"}},[t._v("#")]),t._v(" TCP和UDP的区别")]),t._v(" "),n("p",[t._v("相同点:UDP协议和TCP协议都是传输层协议")]),t._v(" "),n("p",[t._v("不同点：")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("TCP面向有连接；UDP：面向无连接")])]),t._v(" "),n("li",[n("p",[t._v("TCP是要提供可靠、面向连接的传输服务。TCP在建立通信钱，必须建立一个TCP连接,之后才能传输数据。TCP建立一个连接需要3次握手，断开连接需要4次挥手，并且提供超时重发，丢弃重复数据，校验数据，流量控制等功能，保证数据从一端传到另一端")])]),t._v(" "),n("li",[n("p",[t._v("UDP不可靠性，只是把应用程序传给IP层的数据报发送出去，但是不能保证他们能达到目的地")])]),t._v(" "),n("li",[n("p",[t._v("应用场景")]),t._v(" "),n("p",[t._v("TCP效率要求相对低，但是对准确性要求相对高的场景。如常见的接口调用、文件传输、远程登录等")]),t._v(" "),n("p",[t._v("UDP效率要求相对高，对准确性要求相对低的场景，如在线视频、网络语音电话等")])])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://blog.csdn.net/sifanchao/article/details/82285018",target:"_blank",rel:"noopener noreferrer"}},[t._v("面试题：UDP&TCP的区别"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.cnblogs.com/liangyc/p/11628208.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("TCP和UDP的区别及应用场景"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"keep-alive-持久连接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#keep-alive-持久连接"}},[t._v("#")]),t._v(" keep-alive 持久连接")]),t._v(" "),n("p",[t._v("keep-alive又叫持久连接，它通过重用一个TCP连接来发送/接收多个HTTP请求，来减少创建/关闭多个TCP连接的开销，启动Keep-Alive模式性能更高")]),t._v(" "),n("p",[t._v("在HTTP1.1协议中默认开启，可以在请求头上看到Connection:keep-alive开启的标识")]),t._v(" "),n("p",[t._v("在HTTP1.0中非KeepAlive模式时，每次请求都要新建一个TCP请求，请求结束后，要关闭TCP连接。效率很低。")]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[t._v("注意：持久连接采用阻塞模式，下次请求必须等到上次响应返回后才能发起，如果上次的请求还没返回响应内容，下次请求就只能等着("),n("strong",[t._v("就是常说的线头阻塞")]),t._v(")")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://lotabout.me/2019/Things-about-keepalive/",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTTP keep-alive二三事"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"http1、2、3的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#http1、2、3的区别"}},[t._v("#")]),t._v(" HTTP1、2、3的区别")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("http1、2的区别")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("二进制传输，HTTP/2采用二进制格式传输数据，而非HTTP/1.X纯文本形式的报文，二进制协议解析起来更高效")])]),t._v(" "),n("li",[n("p",[t._v('Hearder压缩--HTTP/1.X的请求和响应头部带有大量信息，而且每次请求都要重复发送。HTTP2在客户端和服务器端使用"首部表"来跟踪和存储之前发送的键-值对，对于相同的数据，不在每次请求和响应发送')])]),t._v(" "),n("li",[n("p",[t._v("多路复用")]),t._v(" "),n("p",[t._v("就是在一个TCP连接中可以发送多个请求，可以避免HTTP旧版本中的线头阻塞问题(下次请求必须等到上次相应返回后才能发起)")]),t._v(" "),n("p",[t._v("这样某个请求任务耗时严重，不会影响到其他连接的正常执行，极大的提高传输性能")]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red","font-weight":"bold"}},[t._v("在HTTP/2中，有两个非常重要的概念，分别是帧(frame)和流(steam)。帧代表最小的数据单位，每个帧回表示出该帧属于哪个流(即请求),通过重新排序还原请求")])])]),t._v(" "),n("li",[n("p",[t._v("服务端推送：这里的服务端推送，是指把客户端所需要的CSS/JS/IMG资源伴随着index.html，一起发送到客户端，省去了客户端重复请求的步骤")])])])]),t._v(" "),n("li",[n("p",[t._v("HTTP3.0的区别")]),t._v(" "),n("p",[t._v("http协议是应用层协议，都是建立在传输层之上的。2.0和1.0都是基于TCP的，而Http3.0则是建立在UDP的基础上")])]),t._v(" "),n("li",[n("p",[t._v("HTTP3.0新特性")]),t._v(" "),n("ul",[n("li",[t._v("多路复用，彻底解决TCP中队头阻塞的问题")]),t._v(" "),n("li",[t._v("集成了TLS加密功能")]),t._v(" "),n("li",[t._v("向前纠错机制")])])]),t._v(" "),n("li",[n("p",[t._v("HTTP1、2、3总结")]),t._v(" "),n("ul",[n("li",[t._v("HTTP1.1有两个主要缺点:安全不足和性能不高")]),t._v(" "),n("li",[t._v('http2完全兼容http1，是更安全的HTTP、更快的HTTPS"，头部压缩、多路复用等技术可以充分利用带宽，降低延迟，从而大幅度提高上网体验')]),t._v(" "),n("li",[t._v("QUIC 基于 UDP 实现，是 HTTP/3 中的底层支撑协议，该协议基于 UDP，又取了 TCP 中的精华，实现了即快又可靠的协议")])])])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://segmentfault.com/a/1190000020714686",target:"_blank",rel:"noopener noreferrer"}},[t._v("解密HTTP/2与HTTP/3 的新特性"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://limeii.github.io/2019/06/http2-http3/",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTTP/3 新特性"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"https握手过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#https握手过程"}},[t._v("#")]),t._v(" HTTPS握手过程")]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[t._v("https采用非对称加密 + 对称加密，非对称加密来传递秘钥;对称加密来加密内容")])]),t._v(" "),n("ol",[n("li",[t._v("客户端使用https的url访问web服务器,要求与服务器建立ssl连接")]),t._v(" "),n("li",[t._v("服务器收到客户端请求后,会将网站的证书(包含公钥)传送一份给客户端")]),t._v(" "),n("li",[t._v("客户端收到网站证书后会检查证书的颁发机构以及过期时间，如果没有问题就随机产生一个秘钥")]),t._v(" "),n("li",[t._v("客户端利用公钥将会话秘钥加密，并传送给服务端")]),t._v(" "),n("li",[t._v("服务端利用自己的私钥解密出会话秘钥，之后服务器会客户端使用秘钥加密传输")])]),t._v(" "),n("ul",[n("li",[n("p",[t._v("加密速度对比")]),t._v(" "),n("p",[t._v("对称急吗解密的速度比较快，适合数据比较长时的使用")]),t._v(" "),n("p",[t._v("非对称加密和解密话费的时间长、速度相对较慢，只适合对少量数据的使用")]),t._v(" "),n("p",[t._v("非对称加密: 有公钥私钥，公钥加密，私钥加密；对称加密：同一个秘钥进行加密和解密")])])]),t._v(" "),n("h3",{attrs:{id:"http-与-https-默认端口号"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#http-与-https-默认端口号"}},[t._v("#")]),t._v(" http 与 https 默认端口号")]),t._v(" "),n("ul",[n("li",[t._v("HTTP 默认端口号： 80")]),t._v(" "),n("li",[t._v("HTTPS 默认端口号： 443")])]),t._v(" "),n("p",[t._v("当客户端与服务器进行HTTP通信时,默认情况下会使用端口号80进行通信。例如，如果你在浏览器中输入http://example.com，则浏览器会默认使用80端口发送http请求给服务器。")]),t._v(" "),n("p",[t._v("当客户端与服务器进行HTTPS通信时，默认情况下会使用端口号443进行加密通信。HTTPS通过使用SSL（Secure Sockets Layer）或TLS（Transport Layer Security）协议对通信进行加密和认证，以确保数据传输的安全性。例如，如果您在浏览器中输入 https://example.com,  则浏览器会默认使用443端口发送HTTPS请求给服务器")]),t._v(" "),n("p",[n("strong",[t._v("请注意，虽然这些是默认端口号，但是在实际应用中，可以通过显式指定不同的端口号来进行自定义配置。例如，有时会在非标准端口上部署HTTP或HTTPS服务，以满足特定的需求。")])]),t._v(" "),n("h3",{attrs:{id:"介绍下中间人攻击"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#介绍下中间人攻击"}},[t._v("#")]),t._v(" 介绍下中间人攻击")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("过程")]),t._v(" "),n("ul",[n("li",[t._v("客户端向服务器发送建立连接的请求")]),t._v(" "),n("li",[t._v("服务器向客户端发送公钥")]),t._v(" "),n("li",[t._v("攻击者劫获公钥，保留在自己手上")]),t._v(" "),n("li",[t._v("然后攻击者生产一个【伪造的】公钥，发送客户端")]),t._v(" "),n("li",[t._v("客户端收到伪造的公钥后，生成加密的秘钥值发送给服务器")]),t._v(" "),n("li",[t._v("攻击者获得机密密钥，用自己的私钥及诶获得密钥")]),t._v(" "),n("li",[t._v("同时生成假的加密秘钥，发送服务器")]),t._v(" "),n("li",[t._v("服务器使用四月解密获得假秘钥")]),t._v(" "),n("li",[t._v("服务器用假秘钥加密传输信息")])])]),t._v(" "),n("li",[n("p",[t._v("防范方法")]),t._v(" "),n("p",[t._v("服务器在发送浏览器的公钥中加入CA证书，浏览器可以验证CA证书的有效性")])])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.muyiy.cn/question/network/91.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("介绍下HTTPS中间人攻击"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"dns解析过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dns解析过程"}},[t._v("#")]),t._v(" DNS解析过程")]),t._v(" "),n("p",[t._v("DNS叫做域名系统，是域名和对应ip地址的分布式数据库。有了它，就可以用域名来访问对应的服务器。")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("过程")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("在浏览器中输入url后，会优先在浏览器dns缓存中查找，如果有缓存，则直接响应用户的请求")])]),t._v(" "),n("li",[n("p",[t._v("如果没有要访问的域名，就继续在操作系统的dns缓存中查找，如果也没有，最后通过本地的dns服务器查到对应的ip地址。")])]),t._v(" "),n("li",[n("p",[t._v("DNS 服务器完整的查询过程")]),t._v(" "),n("p",[t._v("本地DNS服务器向根域名服务器发送请求，根域名服务器会返回一个所查询域的顶级域名服务器地址")]),t._v(" "),n("p",[t._v("本地DNS服务器向顶级域名服务器发送请求,接受请求的服务器查询自己的缓存，如果有记录，就返回查询结果，如果没有就返回相关的下一级权威域名服务器的地址。")]),t._v(" "),n("p",[t._v("本地DNS服务器向权威域名服务器发送请求，权威域名服务器返回对应的结果")]),t._v(" "),n("p",[t._v("本地DNS服务器将返回结果保存在缓存中，便于下次使用")]),t._v(" "),n("p",[t._v("本地DNS服务器将返回结果返回给浏览器")])])])]),t._v(" "),n("li",[n("p",[t._v("DNS解析")]),t._v(" "),n("p",[t._v("DNS Prefetch 是一种DNS预解析技术,当你浏览网页时，浏览器会在对网页中的域名进行解析缓存，这样当页面中需要加载该域名的资源时候就无需解析，减少用户等待时间，提高用户体验")]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ref")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("dns-prefetch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("//hhh.images.test.com.cn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),n("p",[n("a",{attrs:{href:"https://www.yuque.com/cuggz/interview/cdpgm0#egcXy",target:"_blank",rel:"noopener noreferrer"}},[t._v("DNS完整的查询过程"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.sojson.com/blog/218.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("dns-prefetch对网站速度能提升有多少？"),n("OutboundLink")],1)])])]),t._v(" "),n("h3",{attrs:{id:"xss-跨站脚本攻击"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#xss-跨站脚本攻击"}},[t._v("#")]),t._v(" XSS(跨站脚本攻击)")]),t._v(" "),n("h2",{attrs:{id:"浏览器原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#浏览器原理"}},[t._v("#")]),t._v(" 浏览器原理")]),t._v(" "),n("h2",{attrs:{id:"总结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),n("h2",{attrs:{id:"原文"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#原文"}},[t._v("#")]),t._v(" 原文")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/7146996646394462239",target:"_blank",rel:"noopener noreferrer"}},[t._v("10万字前端知识体系总结（前端框架+浏览器原理篇）"),n("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);