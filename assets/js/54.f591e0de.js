(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{1014:function(t,s,a){t.exports=a.p+"assets/img/31616879-896dbbe0-b253-11e7-9f72-8f259c412a44.390a2643.png"},1015:function(t,s,a){t.exports=a.p+"assets/img/31616627-d051b918-b252-11e7-848e-0aa60c24ea61.21d86740.png"},1016:function(t,s,a){t.exports=a.p+"assets/img/31617239-558931f0-b254-11e7-844e-309936c48ffa.56253259.png"},1017:function(t,s,a){t.exports=a.p+"assets/img/31617555-1feaed6c-b255-11e7-8cea-447e99d4e1b3.08de1488.png"},1018:function(t,s,a){t.exports=a.p+"assets/img/31619989-a874ae42-b25b-11e7-9a80-e0f644f27849.e7039e19.png"},1019:function(t,s,a){t.exports=a.p+"assets/img/31621391-39849b1a-b25f-11e7-9301-641b1bc07155.2dd49b9b.png"},1020:function(t,s,a){t.exports=a.p+"assets/img/31621324-046d4a44-b25f-11e7-9d15-fe4d6a5726ae.96e451a0.png"},1021:function(t,s,a){t.exports=a.p+"assets/img/31621170-b4cc0ef8-b25e-11e7-9980-99feeb9f5042.85943b89.png"},1022:function(t,s,a){t.exports=a.p+"assets/img/31622216-6c37db9c-b261-11e7-8bd3-79e5d4ddd4d0.c1033591.png"},2401:function(t,s,a){"use strict";a.r(s);var e=a(46),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("script标签用于加载脚本与执行脚本，在前端开发中可以说是非常重要的标签了\n"),e("strong",[t._v("直接使用script脚本的话，html会按照顺序来加载并执行脚本，在脚本加载&执行的过程中，会阻塞后续的DOM渲染")])])]),t._v(" "),e("p",[t._v("现在大家习惯于在页面中引用各种的第三方脚本，如果第三方服务商出现一些小问题，比如延迟之类的，就会使得页面白屏。")]),t._v(" "),e("p",[t._v("好在script提供了两种方式来解决上述问题，"),e("span",{staticStyle:{color:"orange"}},[e("strong",[t._v("async和defer,这两个属性使得script都不会阻塞DOM的渲染")]),t._v("。")])]),t._v(" "),e("p",[t._v("但既然会存在两个属性，那么就说明，这两个属性肯定有差异的")]),t._v(" "),e("h2",{attrs:{id:"defer"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#defer"}},[t._v("#")]),t._v(" defer")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("如果script标签设置了该属性，则浏览器会异步的下载该文件并不会影响到后续DOM渲染；\n如果有多个设置了defer的script标签存在，则会按照顺序执行所有的script；\n"),e("strong",[t._v("defer脚本会在文档渲染完毕后，DOMContentLoaded事件调用前执行。")])])]),t._v(" "),e("p",[t._v("我们做了一个测试页面，页面中包含了两个script标签的加载，给他们都加上defer标识。\nP.S. 为了更直观，我们给script1.js添加了1s的延迟，给script2.js添加了2s的延迟。")]),t._v(" "),e("p",[e("img",{attrs:{src:a(1014),alt:"demo"}})]),t._v(" "),e("p",[t._v("下图是页面加载的过程&script脚本的输出顺序")]),t._v(" "),e("p",[t._v("不难看出，虽然script1加载用时虽然比script2短，但因为defer的限制，所以Ta只能等签名的脚本执行完后才能执行")]),t._v(" "),e("p",[e("img",{attrs:{src:a(1015),alt:"network"}})]),t._v(" "),e("p",[e("img",{attrs:{src:a(1016),alt:"执行顺序"}})]),t._v(" "),e("h2",{attrs:{id:"async"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#async"}},[t._v("#")]),t._v(" async")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("async的设置,会使得script脚本异步的加载并在允许的情况下执行\n"),e("strong",[t._v("async的执行，并不会按script在页面中的顺序来执行，而是谁先加载谁执行")])])]),t._v(" "),e("p",[t._v("修改测试页面")]),t._v(" "),e("p",[e("img",{attrs:{src:a(1017),alt:"demo2"}})]),t._v(" "),e("p",[t._v("遂得到了如下的结果，页面加载时长上，并没有什么变化，毕竟都是异步加载的脚本。\n但是我们可以看到一个小细节，"),e("span",{staticStyle:{color:"red"}},[e("strong",[t._v("DOMContentLoaded事件的触发并不受async脚本加载的影响，在脚本加载完之前，就已经触发了DOMContentLoaded。")])])]),t._v(" "),e("h2",{attrs:{id:"画图简要说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#画图简要说明"}},[t._v("#")]),t._v(" 画图简要说明")]),t._v(" "),e("p",[t._v("拿四个不同的样色来说明各自代码的含义")]),t._v(" "),e("p",[e("span",{staticStyle:{color:"red"}},[e("strong",[t._v("更正:文档渲染应该为 文档解析")])]),t._v(" "),e("img",{attrs:{src:a(1018),alt:"list"}})]),t._v(" "),e("h3",{attrs:{id:"普通script"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#普通script"}},[t._v("#")]),t._v(" 普通script")]),t._v(" "),e("p",[t._v("文档解析的过程中，如果遇到script脚本，就会停止页面的解析进行下载(但是Chrome会做一个优化，如果遇到script脚本，会快速的查看后面有没有需要下载其他资源的，如果有的话，会先下载那些资源，然后在进行下载script所对应的资源，这样能够节省一部分下载时间)")]),t._v(" "),e("p",[e("span",{staticStyle:{color:"red"}},[t._v("资源的下载是在解析过程中进行的，虽说script1脚本会很快的加载完毕，但是他前边的script2并没有加载&执行，所以他只能处于一个挂起的状态，等待script2执行完毕后在执行。")])]),t._v(" "),e("p",[e("span",{staticStyle:{color:"red"}},[t._v("当这两个脚本都执行完毕后，才会继续解析页面。")])]),t._v(" "),e("p",[e("img",{attrs:{src:a(1019),alt:"普通script"}})]),t._v(" "),e("h3",{attrs:{id:"defer-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#defer-2"}},[t._v("#")]),t._v(" defer")]),t._v(" "),e("p",[t._v("文档解析时，遇到设置了defer脚本，就会在后台进行下载，但是并不会阻塞文档的解析，当页面解析&渲染完毕后，会等到所有的defer脚本加载执行完毕后并按顺序执行，执行完毕后触发DOMContentLoaded事件。")]),t._v(" "),e("p",[e("img",{attrs:{src:a(1020),alt:"defer"}})]),t._v(" "),e("h3",{attrs:{id:"async-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#async-2"}},[t._v("#")]),t._v(" async")]),t._v(" "),e("p",[t._v("async 脚本会在加载完毕后执行。")]),t._v(" "),e("p",[t._v("async脚本的加载不计入DOMContentLoaded事件统计，也就是说下面两种情况都有可能发生\n"),e("img",{attrs:{src:a(1021),alt:"async1"}}),t._v(" "),e("img",{attrs:{src:a(1022),alt:"async2"}})]),t._v(" "),e("h2",{attrs:{id:"推荐场景"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#推荐场景"}},[t._v("#")]),t._v(" 推荐场景")]),t._v(" "),e("h3",{attrs:{id:"defer-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#defer-3"}},[t._v("#")]),t._v(" defer")]),t._v(" "),e("p",[t._v("如果你的脚本代码依赖于页面中的DOM元素(文档是否解析完毕)，或被其他脚本文件依赖")]),t._v(" "),e("ol",[e("li",[t._v("评论框")]),t._v(" "),e("li",[t._v("代码语法高亮")]),t._v(" "),e("li",[t._v("polyfill.js")])]),t._v(" "),e("h3",{attrs:{id:"async-3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#async-3"}},[t._v("#")]),t._v(" async")]),t._v(" "),e("p",[t._v("如果你的脚本并不关心页面中的DOM元素(文档是否解析完毕)，并且也不会产生其他脚本需要的数据")]),t._v(" "),e("ol",[e("li",[t._v("百度统计")])]),t._v(" "),e("h2",{attrs:{id:"资料"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#资料"}},[t._v("#")]),t._v(" 资料")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://www.cnblogs.com/jiasm/p/7683930.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("原文"),e("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=r.exports}}]);