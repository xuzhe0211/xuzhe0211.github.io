(window.webpackJsonp=window.webpackJsonp||[]).push([[671],{2688:function(t,n,e){"use strict";e.r(n);var a=e(46),s=Object(a.a)({},(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[e("a",{attrs:{href:"https://blog.csdn.net/qq_33396780/article/details/110694871",target:"_blank",rel:"noopener noreferrer"}},[t._v("来源地址"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"什么是微前端"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#什么是微前端"}},[t._v("#")]),t._v(" 什么是微前端")]),t._v(" "),e("p",[t._v("微前端就是将不同的功能按照不同的纬度拆分成多个子应用.通过主应用来加载这些子应用。微前端的核心在于拆，拆完之后在和！")]),t._v(" "),e("h2",{attrs:{id:"为什么使用微前端"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为什么使用微前端"}},[t._v("#")]),t._v(" 为什么使用微前端")]),t._v(" "),e("ol",[e("li",[t._v("不同团队间开发同一个应用技术栈不通")]),t._v(" "),e("li",[t._v("希望每个团队都可以独立开发,独立部署")]),t._v(" "),e("li",[t._v("项目中还需要老的应用代码")])]),t._v(" "),e("p",[t._v("我们可以将一个应用划分成若干个子应用，将子应用打包成一个个的lib。当路径切换时候加载不同的子应用。这样每个子应用都是独立的，技术栈也不用做限制了！从而解决前端系统开发的问题。")]),t._v(" "),e("h2",{attrs:{id:"如何实现微前端"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#如何实现微前端"}},[t._v("#")]),t._v(" 如何实现微前端")]),t._v(" "),e("p",[t._v("我们是不是可以将一个应用划分成若干个子应用，将子应用打包成一个个模块。当路径切换时加载不同的子应用。这样每个子应用都是独立的，技术栈也不用做限制了！，从而解决前端协同开发问题(子应用需要\n暴露固定的钩子bootstrop、mount、unmount)")]),t._v(" "),e("ul",[e("li",[t._v("iframe、webComponent")]),t._v(" "),e("li",[t._v("2018年Single-spa诞生了，single-Spa是一个用于前端微服务化的javascript前端解决方案(本身没有处理样式隔离，js执行隔离)实现了路由劫持和应用加载")]),t._v(" "),e("li",[t._v("2019年qiankun基于Single-SPA,提供了更加开箱即用的API(single-spa+sandbox+import-html-entry)做到了,技术栈无关，并且接入简单(像iframe一样简单)")]),t._v(" "),e("li",[t._v("2020年EMP基于modle Federation，接入成本低，解决第三方依赖包问题")])]),t._v(" "),e("h2",{attrs:{id:"system-js"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#system-js"}},[t._v("#")]),t._v(" System.js")]),t._v(" "),e("p",[t._v("Systemjs是一个通用的模块加载器，它能在浏览器上动态加载模块，微前端的核心就是加载微应用，我们将应用打包成模块，在浏览器中通过systemjs来加载模块")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("npm install webpack webpack"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cli webpack"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("dev"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("server babel"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("loader @babel"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("core @babel"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("preset"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("env @babel"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("preset"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("react html"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("webpack"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("plugin "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("D")]),t._v("\n\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// index.js")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" React "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" ReactDOM "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react-dom'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//.babelrc es6-es5")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"preset"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'preset-env'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'preset-react'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// webpack.config.js")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" HtmlWebpackPlugin "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("reuqire")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hlml-webpack-plugin'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nmodule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("env")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        mode"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'development'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        output"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            filename"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'index.js'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dist'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 什么模块规范 打包格式 system模块")]),t._v("\n            libaryTarget"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" env"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("production "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'system'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        module"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            rules"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    test"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token regex"}},[e("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\.js$")]),e("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    use"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" loader"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'babel-load'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    exclude"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token regex"}},[e("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("node_modules")]),e("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),t._v("\n                "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        plugins"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("env"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("production "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HtmlWebpackPlugin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                template"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./public/index.html'")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("。filter")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Boolean"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        externals"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" env"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("production "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react-dom'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// dist/index.html")]),t._v("\n")])])]),e("h2",{attrs:{id:"qiankun框架"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#qiankun框架"}},[t._v("#")]),t._v(" qiankun框架")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://qiankun.umijs.org/zh",target:"_blank",rel:"noopener noreferrer"}},[t._v("文档地址"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("2018年Single-SPA诞生了，sigle-spa是一个用于前端微服务化的JavaScript前端解决方案(本身没有处理样式隔离，js执行隔离)实现了路由加持和应用加载。")]),t._v(" "),e("p",[t._v("2019年qiankun基于Single-SPA,提供了更加开箱即的API(single-spa+sandbox+import-html-entry)做到了，技术栈无关、并且接入简单(像iframe一样简单)。")]),t._v(" "),e("h2",{attrs:{id:"qiankun框架实例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#qiankun框架实例"}},[t._v("#")]),t._v(" qiankun框架实例")]),t._v(" "),e("p",[e("strong",[t._v("这里我们打算建立三个项目进行实操，一个Vue项目充当主应用，另一个Vue和React应用子应用")])]),t._v(" "),e("h3",{attrs:{id:"创建三个应用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建三个应用"}},[t._v("#")]),t._v(" 创建三个应用")]),t._v(" "),e("ol",[e("li",[t._v("创建基座")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("vue create qiankun-base\n")])])]),e("ol",{attrs:{start:"2"}},[e("li",[t._v("创建子应用1")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("vue create qiankun-vue\n")])])]),e("ol",{attrs:{start:"3"}},[e("li",[t._v("创建子应用2")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("cnpm install -g create-react-app\ncreate-react-app qiankun-react\n")])])]),e("ul",[e("li",[e("p",[t._v("三个项目")]),t._v(" "),e("p",[t._v("基座:qiankun-base子应用:qiankun-vue, qiankun-react")])])]),t._v(" "),e("h3",{attrs:{id:"项目配置-主要"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#项目配置-主要"}},[t._v("#")]),t._v(" 项目配置(主要)")]),t._v(" "),e("h4",{attrs:{id:"基座qiankun-base配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基座qiankun-base配置"}},[t._v("#")]),t._v(" 基座qiankun-base配置")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("项目创建好后我们首先进行主应用qiankun-base的配置，进入man.js文件进行配置，在main.js中加入一下代码，要注意的是，entry这项配置是我们两个子项目的域名和端口，我们必须确保两个子项目运行在这两个端口上面，container就是我们的容器名，就是我们子应用挂载的节点，相当于Vue项目里面的app节点，acitiveRule就是我们的激活路径，根据路径来显示不同的子应用。")])]),t._v(" "),e("ul",[e("li",[t._v("引入qiankun插件")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("yarn add qiankun 或者 npm i qiankun -S\n")])])]),e("ul",[e("li",[t._v("main.js配置")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("// 引入qiankun\nimport {registerMicroApps, start} from 'qiankun';\n\nconst apps = [\n    {\n        name: 'vueApp', // 应用名字\n        entry: '//localhost:8081'， // 默认会加载这个html解析里面的js动态执行(子应用必须支持跨域) fetch\n        container: '#vue', // 容器名(此项目页面中定义的容器id，用于把对应的子应用放到此容器中)\n        activeRule: '/vue', // 激活的路径\n        props: {a: 1} // 传递的值(可选)\n    }, {\n        name: 'reactApp',\n        entry: '//localhost: 20000', //默认会加载这个html,解析里面的js动态执行(子应用必须支持跨域) fetch\n        container: '#react',\n        activeRule: '/react',\n    }\n]\nregisterMicroApps(apps); // 注册应用\nstart({\n    prefetch: false // 取消预加载\n}); // 开启\n")])])]),e("ul",[e("li",[t._v("配置完之后我们去到qiankun-base的app.vue文件进行主应用的页面编写，这里我安装了element-ui来进行页面美化")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("npm i element-ui -S\n")])])]),e("p",[t._v("在main.js中引入element-ui")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("import ElementUI from 'element-ui';\nimport 'element-ui/lib/theme-chalk/index.css';\n\nVue.use(ElementUI);\n")])])]),e("ul",[e("li",[t._v("修改app.vue的组件代码")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('<template>\n<div id="app">\n    <el-menu :router="true" mode="horizontal">\n        \x3c!-- 基座中可以放自己的路由 --\x3e\n        <el-menu-item index="/">Home</el-menu-item>\n        <el-menu-item index="/about">About</el-menu-item>\n        \x3c!-- 引入其他子应用 --\x3e\n        <el-menu-item index="/vue">vue应用</el-menu-item>\n        <el-menu-item index="/react">react应用</el-menu-item>\n    </el-menu>\n    <router-view></router-view>\n    <div id="vue"></div>\n    <div id="react"></div>\n</div>\n</template>\n')])])]),e("ul",[e("li",[t._v("router.js代码")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("import Vue form 'vue';\nimport VueRouter from 'vue-router';\nimport Home from '../views/Home.vue';\n\nVue.use(VueRouter);\n\nconst routes = [\n    {\n        path: '/',\n        name: 'Home',\n        component: Home\n    },\n    {\n        path: '/about',\n        name: 'About',\n        // route level code-splitting\n        // this generates a separate chunk (about.[hash].js) for this route\n        // which is lazy-loaded when the route is visited.\n        component: () => import(/* webpackChunkName: \"about\" */ '../views/About.vue')\n    }\n]\nconst router = new VueRouter({\n    mode: 'histroy',\n    // base: process.env.BASE_URL,\n    base: '',\n    routes\n})\n\nexport default router\n")])])]),e("h4",{attrs:{id:"子应用qiankun-vue配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#子应用qiankun-vue配置"}},[t._v("#")]),t._v(" 子应用qiankun-vue配置")]),t._v(" "),e("ul",[e("li",[t._v("main.js配置")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("import Vue from 'vue';\nimport App from './App.vue';\nimport router from './router';\n\n// Vue.config.productionTip = false;\n\nlet instance = null;\nfunction render(props) {\n    instance = new Vue({\n        router,\n        render: h => h(App)\n    }).$mount('#qkApp'); // 这里挂载到自己的html中， 基座会拿到这个挂载后的html将其插入进去\n}\n\nif(window.__POWERED_BY_QIANKUN__) { // 动态添加publicPath\n    __webpack_public_path__ = window.__INJECTED_PUBLICK_PATH_BY_QIANKUN__;\n}\nif (!window.__POWERED_BY_QIANKUN__) { // 默认独立运行\n    render();\n}\n\n// 父应用加载子应用，子应用必须暴露三个接口：bootstrap, mount, unmout\n// 子组件的协议就ok了\nexport async function bootstrap(props) {\n\n}\n\nexport async function mount(props) {\n    render(props)\n}\n\nexport async function unmount(props) {\n    instance.$destroy();\n}\n")])])]),e("ul",[e("li",[t._v("router配置")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("import Vue from 'vue'\nimport VueRouter from 'vue-router'\nimport Home from '../views/Home.vue'\n\nVue.use(VueRouter)\n\nconst routes = [\n  {\n    path: '/',\n    name: 'Home',\n    component: Home\n  },\n  {\n    path: '/about',\n    name: 'About',\n    component: () => import(/* webpackChunkName: \"about\" */ '../views/About.vue')\n  }\n]\n\nconst router = new VueRouter({\n  mode: 'history',\n  base: '/vue',\n  routes\n})\n\nexport default router\n")])])]),e("ul",[e("li",[t._v("Vue.config.js配置")])]),t._v(" "),e("p",[t._v("在子应用的根目录下面新建一个Vue.config.js文件")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("module.export = {\n    lintOnSave: false, // 关闭eslint检测\n    devServer: {\n        port: 8080, // 这里端口必须和父应用配置的子应用端口一致\n        headers: {\n            // 因为qiankun内部请求都是fetch来请求资源，所以子应用必须允许跨域\n            '\bAccess-Control-Allow-Origin': '*'\n        }\n    },\n    configureWebpack: {\n        output: {\n            // 资源打包路径\n            library: 'vueApp',\n            libraryTarget: 'umd'\n        }\n    }\n}\n")])])]),e("h4",{attrs:{id:"子应用qiankun-react配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#子应用qiankun-react配置"}},[t._v("#")]),t._v(" 子应用qiankun-react配置")]),t._v(" "),e("ul",[e("li",[t._v("src目录下的index.js文件")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nfunction render() {\n    ReactDOM.render(\n        <React.StrictMode>\n            <App />\n        </React.StrictMode>,\n        document.getElementById('root')\n    );\n}\n\nif(!window.__POWERED_BY_QIANKUN__){\n  render();\n}\n\nexport async function bootstrap(){\n \n}\nexport async function mount() {\n  render()\n}\nexport async function unmount(){\n  ReactDOM.unmountComponentAtNode( document.getElementById('root'));  // 卸载节点\n}\n")])])]),e("ul",[e("li",[t._v("config.overrides.js配置")])]),t._v(" "),e("p",[t._v("先引入react-app-rewired, 在修改package.json启动命令")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("npm install react-app-rewired\n")])])]),e("p",[t._v("修改package.json启动命令")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('"scripts": {\n    "start": "react-app-rewired start",\n    "build": "react-app-rewired build",\n    "test": "react-app-rewired test",\n    "eject": "react-app-rewired eject"\n},\n')])])]),e("p",[t._v("在进行dev以及打包配置，根目录下创建config-overrides.js")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("module.exports = {\n    webpack: (config) => {\n        config.output.library = 'reactApp';\n        config.output.libraryTarget = 'umd';\n        config.output.publicPath = 'http://localhost:20000/';\t// 此应用自己的端口号\n        return config;\n    },\n    devServer: (configFunction) => {\n        return function (proxy, allowedHost) {\n            const config = configFunction(proxy, allowedHost);\n            config.headers = {\n                \"Access-Control-Allow-Origin\": '*'\n            }\n            return config\n        }\n    }\n}\n")])])]),e("ol",{attrs:{start:"3"}},[e("li",[t._v("注意点")])]),t._v(" "),e("ul",[e("li",[t._v("如何在主应用某个路由页面加载微应用")])]),t._v(" "),e("p",[t._v("react+react-router 技术栈的主应用:只需要让子应用的activeRule包含主应用的这个路由即可")]),t._v(" "),e("p",[t._v("vue+vue-router技术栈的主应用")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("例如:主应用需要在login页面登录，登录成功后跳转到main后台的管理界面，在main管理界面下显示子应用。")])]),t._v(" "),e("p",[t._v("修改主应用router.js")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("// 如果这个路由有其他子路由，需要另外注册一个路由，任然使用这个组件即可。\n// 本案例就是有子路由，所以需要才后面重新定义main页面的路由\nconst routes = [\n    {\n        path: '/',\n        name: 'Login',\n        component: Login\n    },\n    {\n        path: '/main',\n        name: 'Main',\n        component: Main,\n        children: [\n            {\n                path: '/home',\n                name: 'Home',\n                component: Home\n            },\n            {\n                path: '/about',\n                name: 'About',\n                // route level code-splitting\n                // this generates a separate chunk (about.[hash].js) for this route\n                // which is lazy-loaded when the route is visited.\n                component: () => import(/* webpackChunkName: \"about\" */ '../views/About.vue')\n            }\n        ]\n    },\n    {\n        path: '/main/*',\n        name: 'Main',\n        component: Main,\n    }\n]\n")])])]),e("p",[t._v("修改主应用main.js的文件：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("// 子应用的 activeRule 需要包含主应用的这个路由 path\nconst apps = [\n  {\n    name: 'vueApp', // 应用的名字\n    entry: '//localhost:8081', // 默认会加载这个html 解析里面的js 动态的执行 （子应用必须支持跨域）fetch\n    container: '#vue', // 容器名\n    activeRule: '/main/vue', // 激活的路径\n    props: { a: 1 }\n  },\n  {\n    name: 'reactApp',\n    entry: '//localhost:20000', // 默认会加载这个html 解析里面的js 动态的执行 （子应用必须支持跨域）fetch\n    container: '#react',\n    activeRule: '/main/react',\n  }\n]\nregisterMicroApps(apps); // 注册应用\n")])])]),e("p",[t._v("修改主应用main.vue页面代码")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('// 在 Main.vue 这个组件的 mounted 周期调用 start 函数，注意不要重复调用。\n<template>\n  <div class="main-content">\n    <el-menu :router="true" mode="horizontal">\n      \x3c!--基座中可以放自己的路由--\x3e\n      <el-menu-item index="/home">Home</el-menu-item>\n      <el-menu-item index="/about">About</el-menu-item>\n      \x3c!--引用其他子应用--\x3e\n      <el-menu-item index="/main/vue">vue应用</el-menu-item>\n      <el-menu-item index="/main/react">react应用</el-menu-item>\n    </el-menu>\n    <router-view></router-view>\n    <div id="vue"></div>\n    <div id="react"></div>\n  </div>\n</template>\n\n<script>\nimport { start } from "qiankun";\n\nexport default {\n  name: "Main",\n  mounted() {\n    if (!window.qiankunStarted) {\n      window.qiankunStarted = true;\n      start();\n    }\n  },\n};\n<\/script>\n')])])])])}),[],!1,null,null,null);n.default=s.exports}}]);