(window.webpackJsonp=window.webpackJsonp||[]).push([[316],{1211:function(t,s){t.exports="data:image/jpeg;base64,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"},2494:function(t,s,a){"use strict";a.r(s);var n=a(46),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("p",[t._v("WebSocket协议，实现了客户端与服务端的双向通信的能力。介绍WebSocket之前，还是让我们先了解下轮询实现推送的方式")]),t._v(" "),n("h2",{attrs:{id:"短轮询"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#短轮询"}},[t._v("#")]),t._v(" 短轮询")]),t._v(" "),n("p",[t._v("段轮询的实现思路就是浏览器端每隔几秒钟发送HTTP请求，服务端收到请求后，不论是否有数据更新，都直接进行响应。在服务的响应完成，就会关闭这个TCP连接，代码实现也最简单，就是利用XHR，通过setInterval定时向后端发送请求，以获取最新数据")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("setInterval(function() {\n    fetch(url).then(res => {\n        // success code\n    })\n}, 3000)\n")])])]),n("p",[t._v("优点: 实现简单")]),t._v(" "),n("p",[t._v("缺点:会造成数据在一小段时间内不同步和大小无效的请求,安全性差、浪费资源")]),t._v(" "),n("h2",{attrs:{id:"长轮询"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#长轮询"}},[t._v("#")]),t._v(" 长轮询")]),t._v(" "),n("p",[t._v("客户端发送请求后服务器端不会立即返回数据，服务器端会阻塞请求连接不会立即断开，直到服务器端有数据更新或是连接超时才返回，客户端才再次发出请求新建连接、如此反复从而获取最新数据")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1211),alt:"长轮询"}})]),t._v(" "),n("p",[t._v("客户端代码如下")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("function async() {\n    fetch(url).then(res => {\n        async();\n        // success code\n    }).catch(() => {\n        // 超时\n        asynnc();\n    })\n}\n")])])]),n("h2",{attrs:{id:"websocket"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#websocket"}},[t._v("#")]),t._v(" WebSocket")]),t._v(" "),n("p",[t._v("前面提到的短轮询(Pollinng)和长轮询(Long-Polling),都是先有客户端发起ajax请求，才能进行通信，走的是HTTP协议，服务器端无法主动向客户端推送信息")]),t._v(" "),n("p",[t._v("当出现类似体育赛事、聊天室、实时位置之类的场景时，轮询就显得十分低效和浪费资源，因为要不断发送请求，连接服务器。WebSocket 的出现，让服务器端可以主动向客户端发送信息，使得浏览器具备了实时双向通信的能力。")]),t._v(" "),n("p",[t._v("没用过 WebSocket 的人，可能会以为它是个什么高深的技术。其实不然，WebSocket 常用的 API 不多也很容易掌握，不过在介绍如何使用之前，让我们先看看它的通信原理。")]),t._v(" "),n("h3",{attrs:{id:"通信原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#通信原理"}},[t._v("#")]),t._v(" 通信原理")]),t._v(" "),n("p",[n("span",{staticStyle:{color:"red"}},[t._v("当客户端要和服务端建立WebSocket连接时，在客户端和服务器的握手过程中，客户端首先会向服务端发送一个HTTP请求，包含一个Upgrade请求头来告知服务端客户端想建立一个WebSocket连接。")])]),t._v(" "),n("p",[t._v("在客户端建立一个WebSocket连接非常简单")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("let ws = new WebSocket('ws://localhost:9000');\n")])])]),n("p",[t._v("类似HTTP和HTTPS, ws相对应的也有wss用以建立安全连接，本地以ws为例")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("Accept-Encoding: gzip, deflate, br\nAccept-Language: zh-CN,zh;q=0.9\nCache-Control: no-cache\nConnection: Upgrade\t// 表示该连接要升级协议\nCookie: _hjMinimizedPolls=358479; ts_uid=7852621249; CNZZDATA1259303436=1218855313-1548914234-%7C1564625892; csrfToken=DPb4RhmGQfPCZnYzUCCOOade; JSESSIONID=67376239124B4355F75F1FC87C059F8D; _hjid=3f7157b6-1aa0-4d5c-ab9a-45eab1e6941e; acw_tc=76b20ff415689655672128006e178b964c640d5a7952f7cb3c18ddf0064264\nHost: localhost:9000\nOrigin: http://localhost:9000\nPragma: no-cache\nSec-WebSocket-Extensions: permessage-deflate; client_max_window_bits\nSec-WebSocket-Key: 5fTJ1LTuh3RKjSJxydyifQ==\t\t// 与响应头 Sec-WebSocket-Accept 相对应\nSec-WebSocket-Version: 13\t// 表示 websocket 协议的版本\nUpgrade: websocket\t// 表示要升级到 websocket 协议\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36\n")])])]),n("p",[t._v("响应头如下：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("Connection: Upgrade\nSec-WebSocket-Accept: ZUip34t+bCjhkvxxwhmdEOyx9hE=\nUpgrade: websocket\n")])])]),n("p",[n("span",{staticStyle:{color:"red"}},[t._v("此时响应行(Genneral)中可以看到状态码status code 是101 Switching Protocols，表示该连接已经从HTTP协议转换为WebSocket通信协议。转换成功后，该连接并没有中断，而是建立了一个全双工通信，后续发送和接收消息都会走这个连接通道。")])]),t._v(" "),n("p",[t._v("注意,请求头中有个Sec-WebSocket-Key字段，和响应头中的Sec-WebSocket-Accept是配套应用，它的作用是提供了基本防护，比如恶意的连接或者无效的连接。Sec-WebSocket-Key是客户端随机生成的一个base64编码，服务器会使用这个编码，并更具一个固定的算法")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v('GUID = "258EAFA5-E914-47DA-95CA-C5AB0DC85B11";    //  一个固定的字符串\naccept = base64(sha1(key + GUID));\t// key 就是 Sec-WebSocket-Key 值，accept 就是 Sec-WebSocket-Accept 值\n\n')])])]),n("p",[t._v("其中 GUID 字符串是 RFC6455（https://tools.ietf.org/html/rfc6455#p-5.5.2）官方定义的一个固定字符串，不得修改。")]),t._v(" "),n("p",[t._v("客户端拿到服务端响应的 Sec-WebSocket-Accept 后，会拿自己之前生成的 Sec-WebSocket-Key 用相同算法算一次，如果匹配，则握手成功。然后判断 HTTP Response 状态码是否为 101（切换协议），如果是，则建立连接，大功告成。")]),t._v(" "),n("h3",{attrs:{id:"实现简单聊"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实现简单聊"}},[t._v("#")]),t._v(" 实现简单聊")]),t._v(" "),n("p",[t._v("客户端")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("connectWebsocket")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    ws "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebSocket")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ws://localhost:9000'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 监听连接成功")]),t._v("\n    ws"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onopen")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'连接服务端WebSocket成功'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        ws"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msgData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// send 方法给服务端发送消息")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 监听服务端消息(接收消息)")]),t._v("\n    ws"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onmessage")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("msg")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" message "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'收到的消息：'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" message"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        elUl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('<li class="b">小秋：')]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("message"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("</li>")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 监听连接失败")]),t._v("\n    ws"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onerror")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'连接失败，正在重连...'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("connectWebsocket")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 监听连接关闭")]),t._v("\n    ws"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onclose")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \tconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'连接关闭'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("connectWebsocket")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("从上面可以看到 WebSocket 实例的 API 很容易理解，简单好用，通过 send() 方法可以发送消息，onmessage 事件用来接收消息，然后对消息进行处理显示在页面上。当 onerror 事件（监听连接失败）触发时，最好进行执行重连，以保持连接不中断。")]),t._v(" "),n("p",[t._v("服务端 Node: （这里使用 ws 库）")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" express "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("express")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" server "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Server")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" WebSocket "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ws'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" wss "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebSocket"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Server")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" server"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \nwss"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'connection'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("ws")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n \n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 监听客户端发来的消息")]),t._v("\n  ws"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'message'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("message")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wss"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clients"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" msgData "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msgData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'open'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始连接时标识会话")]),t._v("\n      ws"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sessionId "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("msgData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fromUserId"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("msgData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("toUserId"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" sessionId "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("msgData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("toUserId"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("msgData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fromUserId"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      wss"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clients"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("client")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sessionId "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" sessionId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\t "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 给对应的客户端连接发送消息")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n \n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 连接关闭")]),t._v("\n  ws"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'close'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'连接关闭'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h2",{attrs:{id:"参考"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://blog.csdn.net/weixin_39843414/article/details/105672024",target:"_blank",rel:"noopener noreferrer"}},[t._v("WebSocket 原理浅析与实现简单聊天"),n("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);