(window.webpackJsonp=window.webpackJsonp||[]).push([[122],{1485:function(e,t,s){e.exports=s.p+"assets/img/20190620144806980.f4c5d0fb.png"},1486:function(e,t,s){e.exports=s.p+"assets/img/20190620145031505.9bee6a2a.png"},1487:function(e,t){e.exports="data:image/png;base64,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"},1488:function(e,t,s){e.exports=s.p+"assets/img/20190620151429168.5fb8cade.png"},1489:function(e,t,s){e.exports=s.p+"assets/img/20190620151541945.54d2c459.png"},2628:function(e,t,s){"use strict";s.r(t);var r=s(46),a=Object(r.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h2",{attrs:{id:"起因"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#起因"}},[e._v("#")]),e._v(" 起因")]),e._v(" "),r("p",[e._v("项目采用vue全家桶开发，现在打算嵌入sentry，实现对于线上网站进行错误日志记录。其实上传日志很简单，基本配置就可以了，但是上传配套的sourcemap则颇为费劲，这里记录一下使用心得")]),e._v(" "),r("h2",{attrs:{id:"使用步骤"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#使用步骤"}},[e._v("#")]),e._v(" 使用步骤")]),e._v(" "),r("h3",{attrs:{id:"上传日志"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#上传日志"}},[e._v("#")]),e._v(" 上传日志")]),e._v(" "),r("p",[e._v("sentry使用文档，官方介绍很简单")]),e._v(" "),r("p",[e._v("在main.js中引入如下代码")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("npm install @sentry/integrations\n# or\nyarn add @sentry/integrations\nimport Vue from 'vue'\nimport * as Sentry from '@sentry/browser';\nimport * as Integrations from '@sentry/integrations';\n\nSentry.init({\n  dsn: 'your dsn',\n  integrations: [\n    new Integrations.Vue({\n      Vue,\n      attachProps: true,\n    }),\n  ],\n});\n")])])]),r("p",[e._v("其中DSN在项目的下图位置找到\n"),r("img",{attrs:{src:s(1485),alt:"DSN"}}),e._v("\n这样之后我们重新打包项目，错误就可以自动上传到sentry的项目issues里面了\n"),r("img",{attrs:{src:s(1486),alt:"错误日志"}})]),e._v(" "),r("p",[e._v("如果我们想要看到具体的报错信息，那我们就需要上传sourcemap文件了")]),e._v(" "),r("h3",{attrs:{id:"上传sourcemap文件"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#上传sourcemap文件"}},[e._v("#")]),e._v(" 上传sourcemap文件")]),e._v(" "),r("p",[e._v("sourcemap文件的上传方式有两种")]),e._v(" "),r("ol",[r("li",[e._v("sentry-cli手动上传")]),e._v(" "),r("li",[e._v("第三方包自动上传，这里采用官方推荐的@sentry/webpack-plugin")])]),e._v(" "),r("h4",{attrs:{id:"采用sentry-cli的方式尝试步骤如下"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#采用sentry-cli的方式尝试步骤如下"}},[e._v("#")]),e._v(" 采用sentry-cli的方式尝试步骤如下")]),e._v(" "),r("ol",[r("li",[e._v("全局安装@sentry/cli")])]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("npm i -g @sentry/cli\n")])])]),r("ol",{attrs:{start:"2"}},[r("li",[e._v("登录")])]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("sentry-cli --url 域名地址 login\n")])])]),r("p",[e._v("这里的域名地址，是你的host地址，包括域名+端口。因为这一步采用网页形式登录，所以需要你提前申请auto Token，申请方式如下")]),e._v(" "),r("p",[e._v("点击 账号 -> API keys， 点击 Create New Token")]),e._v(" "),r("p",[e._v("记得 project:releases 和 project:write 要勾选上")]),e._v(" "),r("ol",{attrs:{start:"3"}},[r("li",[e._v("设置版本号")])]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("sentry-cli releases -o 组织名 -p 项目名 new 版本号\n")])])]),r("p",[e._v("其中，进入你的项目下，查看浏览器地址，组织名【sentry】和项目名【your-project-name】。\n"),r("img",{attrs:{src:s(1487),alt:"组织名/项目名"}}),e._v("\n4. 打包你的项目，生成sroucemap\n5. 上传roucemap文件到sentry")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("sentry-cli releases -o 组织名 -p 项目名 files 版本号 upload-sourcemaps 打包后的js目录 --url-prefix 线上js访问地址\n")])])]),r("p",[e._v("其中最需要注意的是线上js访问地址，多半上传sourcemap成功，但是不能解析的都源于此。成功后的sourcemap文件可以在你的项目下的release下对应版本查看，正确的应该如下\n"),r("img",{attrs:{src:s(1488),alt:"release文件"}}),e._v("\n正常解析后的结果是可以定位代码行的错误提示的如下\n"),r("img",{attrs:{src:s(1489),alt:"解析"}})]),e._v(" "),r("p",[e._v("其他：删除sourcemap命令")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("sentry-cli releases files 发布版本号 delete --all\n")])])]),r("h4",{attrs:{id:"利用-sentry-webpack-plugin自动上传sourcemap"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#利用-sentry-webpack-plugin自动上传sourcemap"}},[e._v("#")]),e._v(" 利用@sentry/webpack-plugin自动上传sourcemap")]),e._v(" "),r("p",[e._v("惯例，还是先介绍官网资料")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("const SentryCliPlugin = require('@sentry/webpack-plugin');\n \nconst config = {\n  plugins: [\n    new SentryCliPlugin({\n      include: '.',\n      ignoreFile: '.sentrycliignore',\n      ignore: ['node_modules', 'webpack.config.js'],\n      configFile: 'sentry.properties',\n    }),\n  ],\n};\n")])])]),r("p",[e._v("这里我们还依赖一个配置文件，根目录下的sentry配置文件.sentryclirc,文件内容如下")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("[defaults]\nurl=your url\norg=your organization\nproject=your project\n\n[auth]\ntoken=your auth\n")])])]),r("p",[e._v("通常情况下，我们在plugun的配置中，还需要额外配置两个参数： release 和 urlPrefix, release同前面一样，urlPrefix也一样（很重要）。")]),e._v(" "),r("p",[e._v("其实两种方式都掌握最好，因为我们通常会趋向于利用第三方工具自动上传，但是遇到问题的时候，我们可以选择手动上传的方式进行调试。")]),e._v(" "),r("h2",{attrs:{id:"结果"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#结果"}},[e._v("#")]),e._v(" 结果")]),e._v(" "),r("p",[e._v("完成上述步骤，我们就可以对于线上遇到的问题进行监控了")]),e._v(" "),r("p",[e._v("由于我们项目需要同事监控"),r("strong",[e._v("线上版")]),e._v("和"),r("strong",[e._v("预发布")]),e._v("版本，所以project name和release 以及dsn都需要根据环境变量做适配")]),e._v(" "),r("h2",{attrs:{id:"资料"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#资料"}},[e._v("#")]),e._v(" 资料")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://blog.csdn.net/sinat_36065456/article/details/93045793",target:"_blank",rel:"noopener noreferrer"}},[e._v("sentry + vue实现错误日志监控"),r("OutboundLink")],1)]),e._v(" "),r("p",[r("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/352681247",target:"_blank",rel:"noopener noreferrer"}},[e._v("sentry 前端 使用"),r("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=a.exports}}]);